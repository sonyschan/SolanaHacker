import{r as Pt,B as et,P as Ri}from"./index.browser.esm-B2ksgeyJ.js";import{j as Dr,s as Qs,t as ea,q as ta}from"./index-BMxkC_FV.js";import{j as Ut,p as Pr}from"./index-BxAYBef1.js";import"./index-CAfjtnzH.js";import"./signIn-DskQSngy.js";import"./adapter-DoU5PEos.js";function Qt(r){"@babel/helpers - typeof";return Qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qt(r)}function ra(r,e){if(Qt(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Qt(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function na(r){var e=ra(r,"string");return Qt(e)=="symbol"?e:e+""}function ge(r,e,t){return(e=na(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Ii(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Ke(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ii(Object(t),!0).forEach(function(n){ge(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Ii(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var sn={exports:{}},an={exports:{}},ln,Ti;function Ie(){if(Ti)return ln;Ti=1;class r extends Error{constructor(t){if(!Array.isArray(t))throw new TypeError(`Expected input to be an Array, got ${typeof t}`);let n="";for(let i=0;i<t.length;i++)n+=`    ${t[i].stack}
`;super(n),this.name="AggregateError",this.errors=t}}return ln={AggregateError:r,ArrayIsArray(e){return Array.isArray(e)},ArrayPrototypeIncludes(e,t){return e.includes(t)},ArrayPrototypeIndexOf(e,t){return e.indexOf(t)},ArrayPrototypeJoin(e,t){return e.join(t)},ArrayPrototypeMap(e,t){return e.map(t)},ArrayPrototypePop(e,t){return e.pop(t)},ArrayPrototypePush(e,t){return e.push(t)},ArrayPrototypeSlice(e,t,n){return e.slice(t,n)},Error,FunctionPrototypeCall(e,t,...n){return e.call(t,...n)},FunctionPrototypeSymbolHasInstance(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty(e,t,n){return Object.defineProperty(e,t,n)},ObjectGetOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys(e){return Object.keys(e)},ObjectSetPrototypeOf(e,t){return Object.setPrototypeOf(e,t)},Promise,PromisePrototypeCatch(e,t){return e.catch(t)},PromisePrototypeThen(e,t,n){return e.then(t,n)},PromiseReject(e){return Promise.reject(e)},PromiseResolve(e){return Promise.resolve(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest(e,t){return e.test(t)},SafeSet:Set,String,StringPrototypeSlice(e,t,n){return e.slice(t,n)},StringPrototypeToLowerCase(e){return e.toLowerCase()},StringPrototypeToUpperCase(e){return e.toUpperCase()},StringPrototypeTrim(e){return e.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(e,t,n){return e.set(t,n)},Boolean,Uint8Array},ln}var un={exports:{}},fn,Oi;function zo(){return Oi||(Oi=1,fn={format(r,...e){return r.replace(/%([sdifj])/g,function(...[t,n]){const i=e.shift();return n==="f"?i.toFixed(6):n==="j"?JSON.stringify(i):n==="s"&&typeof i=="object"?`${i.constructor!==Object?i.constructor.name:""} {}`.trim():i.toString()})},inspect(r){switch(typeof r){case"string":if(r.includes("'"))if(r.includes('"')){if(!r.includes("`")&&!r.includes("${"))return`\`${r}\``}else return`"${r}"`;return`'${r}'`;case"number":return isNaN(r)?"NaN":Object.is(r,-0)?String(r):r;case"bigint":return`${String(r)}n`;case"boolean":case"undefined":return String(r);case"object":return"{}"}}}),fn}var cn,xi;function Be(){if(xi)return cn;xi=1;const{format:r,inspect:e}=zo(),{AggregateError:t}=Ie(),n=globalThis.AggregateError||t,i=Symbol("kIsNodeError"),s=["string","function","number","object","Function","Object","boolean","bigint","symbol"],o=/^([A-Z][a-z0-9]*)+$/,l="__node_internal_",d={};function g(y,R){if(!y)throw new d.ERR_INTERNAL_ASSERTION(R)}function N(y){let R="",p=y.length;const T=y[0]==="-"?1:0;for(;p>=T+4;p-=3)R=`_${y.slice(p-3,p)}${R}`;return`${y.slice(0,p)}${R}`}function x(y,R,p){if(typeof R=="function")return g(R.length<=p.length,`Code: ${y}; The provided arguments length (${p.length}) does not match the required ones (${R.length}).`),R(...p);const T=(R.match(/%[dfijoOs]/g)||[]).length;return g(T===p.length,`Code: ${y}; The provided arguments length (${p.length}) does not match the required ones (${T}).`),p.length===0?R:r(R,...p)}function E(y,R,p){p||(p=Error);class T extends p{constructor(...H){super(x(y,R,H))}toString(){return`${this.name} [${y}]: ${this.message}`}}Object.defineProperties(T.prototype,{name:{value:p.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${y}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),T.prototype.code=y,T.prototype[i]=!0,d[y]=T}function k(y){const R=l+y.name;return Object.defineProperty(y,"name",{value:R}),y}function U(y,R){if(y&&R&&y!==R){if(Array.isArray(R.errors))return R.errors.push(y),R;const p=new n([R,y],R.message);return p.code=R.code,p}return y||R}class A extends Error{constructor(R="The operation was aborted",p=void 0){if(p!==void 0&&typeof p!="object")throw new d.ERR_INVALID_ARG_TYPE("options","Object",p);super(R,p),this.code="ABORT_ERR",this.name="AbortError"}}return E("ERR_ASSERTION","%s",Error),E("ERR_INVALID_ARG_TYPE",(y,R,p)=>{g(typeof y=="string","'name' must be a string"),Array.isArray(R)||(R=[R]);let T="The ";y.endsWith(" argument")?T+=`${y} `:T+=`"${y}" ${y.includes(".")?"property":"argument"} `,T+="must be ";const $=[],H=[],Y=[];for(const a of R)g(typeof a=="string","All expected entries have to be of type string"),s.includes(a)?$.push(a.toLowerCase()):o.test(a)?H.push(a):(g(a!=="object",'The value "object" should be written as "Object"'),Y.push(a));if(H.length>0){const a=$.indexOf("object");a!==-1&&($.splice($,a,1),H.push("Object"))}if($.length>0){switch($.length){case 1:T+=`of type ${$[0]}`;break;case 2:T+=`one of type ${$[0]} or ${$[1]}`;break;default:{const a=$.pop();T+=`one of type ${$.join(", ")}, or ${a}`}}(H.length>0||Y.length>0)&&(T+=" or ")}if(H.length>0){switch(H.length){case 1:T+=`an instance of ${H[0]}`;break;case 2:T+=`an instance of ${H[0]} or ${H[1]}`;break;default:{const a=H.pop();T+=`an instance of ${H.join(", ")}, or ${a}`}}Y.length>0&&(T+=" or ")}switch(Y.length){case 0:break;case 1:Y[0].toLowerCase()!==Y[0]&&(T+="an "),T+=`${Y[0]}`;break;case 2:T+=`one of ${Y[0]} or ${Y[1]}`;break;default:{const a=Y.pop();T+=`one of ${Y.join(", ")}, or ${a}`}}if(p==null)T+=`. Received ${p}`;else if(typeof p=="function"&&p.name)T+=`. Received function ${p.name}`;else if(typeof p=="object"){var X;if((X=p.constructor)!==null&&X!==void 0&&X.name)T+=`. Received an instance of ${p.constructor.name}`;else{const a=e(p,{depth:-1});T+=`. Received ${a}`}}else{let a=e(p,{colors:!1});a.length>25&&(a=`${a.slice(0,25)}...`),T+=`. Received type ${typeof p} (${a})`}return T},TypeError),E("ERR_INVALID_ARG_VALUE",(y,R,p="is invalid")=>{let T=e(R);return T.length>128&&(T=T.slice(0,128)+"..."),`The ${y.includes(".")?"property":"argument"} '${y}' ${p}. Received ${T}`},TypeError),E("ERR_INVALID_RETURN_VALUE",(y,R,p)=>{var T;const $=p!=null&&(T=p.constructor)!==null&&T!==void 0&&T.name?`instance of ${p.constructor.name}`:`type ${typeof p}`;return`Expected ${y} to be returned from the "${R}" function but got ${$}.`},TypeError),E("ERR_MISSING_ARGS",(...y)=>{g(y.length>0,"At least one arg needs to be specified");let R;const p=y.length;switch(y=(Array.isArray(y)?y:[y]).map(T=>`"${T}"`).join(" or "),p){case 1:R+=`The ${y[0]} argument`;break;case 2:R+=`The ${y[0]} and ${y[1]} arguments`;break;default:{const T=y.pop();R+=`The ${y.join(", ")}, and ${T} arguments`}break}return`${R} must be specified`},TypeError),E("ERR_OUT_OF_RANGE",(y,R,p)=>{g(R,'Missing "range" argument');let T;if(Number.isInteger(p)&&Math.abs(p)>2**32)T=N(String(p));else if(typeof p=="bigint"){T=String(p);const $=BigInt(2)**BigInt(32);(p>$||p<-$)&&(T=N(T)),T+="n"}else T=e(p);return`The value of "${y}" is out of range. It must be ${R}. Received ${T}`},RangeError),E("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),E("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),E("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),E("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),E("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),E("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),E("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),E("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),E("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),E("ERR_STREAM_WRITE_AFTER_END","write after end",Error),E("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),cn={AbortError:A,aggregateTwoErrors:k(U),hideStackFrames:k,codes:d},cn}var Vt={exports:{}},Ni;function er(){if(Ni)return Vt.exports;Ni=1;const{AbortController:r,AbortSignal:e}=typeof self<"u"?self:typeof window<"u"?window:void 0;return Vt.exports=r,Vt.exports.AbortSignal=e,Vt.exports.default=r,Vt.exports}var Ci;function We(){return Ci||(Ci=1,(function(r){const e=Pt(),{format:t,inspect:n}=zo(),{codes:{ERR_INVALID_ARG_TYPE:i}}=Be(),{kResistStopPropagation:s,AggregateError:o,SymbolDispose:l}=Ie(),d=globalThis.AbortSignal||er().AbortSignal,g=globalThis.AbortController||er().AbortController,N=Object.getPrototypeOf(async function(){}).constructor,x=globalThis.Blob||e.Blob,E=typeof x<"u"?function(y){return y instanceof x}:function(y){return!1},k=(A,y)=>{if(A!==void 0&&(A===null||typeof A!="object"||!("aborted"in A)))throw new i(y,"AbortSignal",A)},U=(A,y)=>{if(typeof A!="function")throw new i(y,"Function",A)};r.exports={AggregateError:o,kEmptyObject:Object.freeze({}),once(A){let y=!1;return function(...R){y||(y=!0,A.apply(this,R))}},createDeferredPromise:function(){let A,y;return{promise:new Promise((p,T)=>{A=p,y=T}),resolve:A,reject:y}},promisify(A){return new Promise((y,R)=>{A((p,...T)=>p?R(p):y(...T))})},debuglog(){return function(){}},format:t,inspect:n,types:{isAsyncFunction(A){return A instanceof N},isArrayBufferView(A){return ArrayBuffer.isView(A)}},isBlob:E,deprecate(A,y){return A},addAbortListener:Dr().addAbortListener||function(y,R){if(y===void 0)throw new i("signal","AbortSignal",y);k(y,"signal"),U(R,"listener");let p;return y.aborted?queueMicrotask(()=>R()):(y.addEventListener("abort",R,{__proto__:null,once:!0,[s]:!0}),p=()=>{y.removeEventListener("abort",R)}),{__proto__:null,[l](){var T;(T=p)===null||T===void 0||T()}}},AbortSignalAny:d.any||function(y){if(y.length===1)return y[0];const R=new g,p=()=>R.abort();return y.forEach(T=>{k(T,"signals"),T.addEventListener("abort",p,{once:!0})}),R.signal.addEventListener("abort",()=>{y.forEach(T=>T.removeEventListener("abort",p))},{once:!0}),R.signal}},r.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(un)),un.exports}var mr={},dn,Pi;function nr(){if(Pi)return dn;Pi=1;const{ArrayIsArray:r,ArrayPrototypeIncludes:e,ArrayPrototypeJoin:t,ArrayPrototypeMap:n,NumberIsInteger:i,NumberIsNaN:s,NumberMAX_SAFE_INTEGER:o,NumberMIN_SAFE_INTEGER:l,NumberParseInt:d,ObjectPrototypeHasOwnProperty:g,RegExpPrototypeExec:N,String:x,StringPrototypeToUpperCase:E,StringPrototypeTrim:k}=Ie(),{hideStackFrames:U,codes:{ERR_SOCKET_BAD_PORT:A,ERR_INVALID_ARG_TYPE:y,ERR_INVALID_ARG_VALUE:R,ERR_OUT_OF_RANGE:p,ERR_UNKNOWN_SIGNAL:T}}=Be(),{normalizeEncoding:$}=We(),{isAsyncFunction:H,isArrayBufferView:Y}=We().types,X={};function a(B){return B===(B|0)}function b(B){return B===B>>>0}const u=/^[0-7]+$/,c="must be a 32-bit unsigned integer or an octal string";function w(B,Z,re){if(typeof B>"u"&&(B=re),typeof B=="string"){if(N(u,B)===null)throw new R(Z,B,c);B=d(B,8)}return h(B,Z),B}const f=U((B,Z,re=l,J=o)=>{if(typeof B!="number")throw new y(Z,"number",B);if(!i(B))throw new p(Z,"an integer",B);if(B<re||B>J)throw new p(Z,`>= ${re} && <= ${J}`,B)}),C=U((B,Z,re=-2147483648,J=2147483647)=>{if(typeof B!="number")throw new y(Z,"number",B);if(!i(B))throw new p(Z,"an integer",B);if(B<re||B>J)throw new p(Z,`>= ${re} && <= ${J}`,B)}),h=U((B,Z,re=!1)=>{if(typeof B!="number")throw new y(Z,"number",B);if(!i(B))throw new p(Z,"an integer",B);const J=re?1:0,we=4294967295;if(B<J||B>we)throw new p(Z,`>= ${J} && <= ${we}`,B)});function v(B,Z){if(typeof B!="string")throw new y(Z,"string",B)}function P(B,Z,re=void 0,J){if(typeof B!="number")throw new y(Z,"number",B);if(re!=null&&B<re||J!=null&&B>J||(re!=null||J!=null)&&s(B))throw new p(Z,`${re!=null?`>= ${re}`:""}${re!=null&&J!=null?" && ":""}${J!=null?`<= ${J}`:""}`,B)}const _=U((B,Z,re)=>{if(!e(re,B)){const we="must be one of: "+t(n(re,Pe=>typeof Pe=="string"?`'${Pe}'`:x(Pe)),", ");throw new R(Z,B,we)}});function M(B,Z){if(typeof B!="boolean")throw new y(Z,"boolean",B)}function m(B,Z,re){return B==null||!g(B,Z)?re:B[Z]}const j=U((B,Z,re=null)=>{const J=m(re,"allowArray",!1),we=m(re,"allowFunction",!1);if(!m(re,"nullable",!1)&&B===null||!J&&r(B)||typeof B!="object"&&(!we||typeof B!="function"))throw new y(Z,"Object",B)}),K=U((B,Z)=>{if(B!=null&&typeof B!="object"&&typeof B!="function")throw new y(Z,"a dictionary",B)}),W=U((B,Z,re=0)=>{if(!r(B))throw new y(Z,"Array",B);if(B.length<re){const J=`must be longer than ${re}`;throw new R(Z,B,J)}});function ee(B,Z){W(B,Z);for(let re=0;re<B.length;re++)v(B[re],`${Z}[${re}]`)}function Q(B,Z){W(B,Z);for(let re=0;re<B.length;re++)M(B[re],`${Z}[${re}]`)}function le(B,Z){W(B,Z);for(let re=0;re<B.length;re++){const J=B[re],we=`${Z}[${re}]`;if(J==null)throw new y(we,"AbortSignal",J);ce(J,we)}}function ue(B,Z="signal"){if(v(B,Z),X[B]===void 0)throw X[E(B)]!==void 0?new T(B+" (signals must use all capital letters)"):new T(B)}const G=U((B,Z="buffer")=>{if(!Y(B))throw new y(Z,["Buffer","TypedArray","DataView"],B)});function V(B,Z){const re=$(Z),J=B.length;if(re==="hex"&&J%2!==0)throw new R("encoding",Z,`is invalid for data of length ${J}`)}function oe(B,Z="Port",re=!0){if(typeof B!="number"&&typeof B!="string"||typeof B=="string"&&k(B).length===0||+B!==+B>>>0||B>65535||B===0&&!re)throw new A(Z,B,re);return B|0}const ce=U((B,Z)=>{if(B!==void 0&&(B===null||typeof B!="object"||!("aborted"in B)))throw new y(Z,"AbortSignal",B)}),fe=U((B,Z)=>{if(typeof B!="function")throw new y(Z,"Function",B)}),L=U((B,Z)=>{if(typeof B!="function"||H(B))throw new y(Z,"Function",B)}),D=U((B,Z)=>{if(B!==void 0)throw new y(Z,"undefined",B)});function F(B,Z,re){if(!e(re,B))throw new y(Z,`('${t(re,"|")}')`,B)}const ne=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function se(B,Z){if(typeof B>"u"||!N(ne,B))throw new R(Z,B,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function ie(B){if(typeof B=="string")return se(B,"hints"),B;if(r(B)){const Z=B.length;let re="";if(Z===0)return re;for(let J=0;J<Z;J++){const we=B[J];se(we,"hints"),re+=we,J!==Z-1&&(re+=", ")}return re}throw new R("hints",B,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return dn={isInt32:a,isUint32:b,parseFileMode:w,validateArray:W,validateStringArray:ee,validateBooleanArray:Q,validateAbortSignalArray:le,validateBoolean:M,validateBuffer:G,validateDictionary:K,validateEncoding:V,validateFunction:fe,validateInt32:C,validateInteger:f,validateNumber:P,validateObject:j,validateOneOf:_,validatePlainFunction:L,validatePort:oe,validateSignalName:ue,validateString:v,validateUint32:h,validateUndefined:D,validateUnion:F,validateAbortSignal:ce,validateLinkHeaderValue:ie},dn}var Er={exports:{}},hn={},Li;function Lt(){return Li||(Li=1,(function(r){Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function e($){return $&&$.__esModule&&Object.prototype.hasOwnProperty.call($,"default")?$.default:$}var t={exports:{}},n=t.exports={},i,s;function o(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?i=setTimeout:i=o}catch{i=o}try{typeof clearTimeout=="function"?s=clearTimeout:s=l}catch{s=l}})();function d($){if(i===setTimeout)return setTimeout($,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout($,0);try{return i($,0)}catch{try{return i.call(null,$,0)}catch{return i.call(this,$,0)}}}function g($){if(s===clearTimeout)return clearTimeout($);if((s===l||!s)&&clearTimeout)return s=clearTimeout,clearTimeout($);try{return s($)}catch{try{return s.call(null,$)}catch{return s.call(this,$)}}}var N=[],x=!1,E,k=-1;function U(){!x||!E||(x=!1,E.length?N=E.concat(N):k=-1,N.length&&A())}function A(){if(!x){var $=d(U);x=!0;for(var H=N.length;H;){for(E=N,N=[];++k<H;)E&&E[k].run();k=-1,H=N.length}E=null,x=!1,g($)}}n.nextTick=function($){var H=new Array(arguments.length-1);if(arguments.length>1)for(var Y=1;Y<arguments.length;Y++)H[Y-1]=arguments[Y];N.push(new y($,H)),N.length===1&&!x&&d(A)};function y($,H){this.fun=$,this.array=H}y.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={};function R(){}n.on=R,n.addListener=R,n.once=R,n.off=R,n.removeListener=R,n.removeAllListeners=R,n.emit=R,n.prependListener=R,n.prependOnceListener=R,n.listeners=function($){return[]},n.binding=function($){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function($){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};var p=t.exports;const T=e(p);r.default=T,r.process=T})(hn)),hn}var gn,Mi;function ht(){if(Mi)return gn;Mi=1;const{SymbolAsyncIterator:r,SymbolIterator:e,SymbolFor:t}=Ie(),n=t("nodejs.stream.destroyed"),i=t("nodejs.stream.errored"),s=t("nodejs.stream.readable"),o=t("nodejs.stream.writable"),l=t("nodejs.stream.disturbed"),d=t("nodejs.webstream.isClosedPromise"),g=t("nodejs.webstream.controllerErrorFunction");function N(m,j=!1){var K;return!!(m&&typeof m.pipe=="function"&&typeof m.on=="function"&&(!j||typeof m.pause=="function"&&typeof m.resume=="function")&&(!m._writableState||((K=m._readableState)===null||K===void 0?void 0:K.readable)!==!1)&&(!m._writableState||m._readableState))}function x(m){var j;return!!(m&&typeof m.write=="function"&&typeof m.on=="function"&&(!m._readableState||((j=m._writableState)===null||j===void 0?void 0:j.writable)!==!1))}function E(m){return!!(m&&typeof m.pipe=="function"&&m._readableState&&typeof m.on=="function"&&typeof m.write=="function")}function k(m){return m&&(m._readableState||m._writableState||typeof m.write=="function"&&typeof m.on=="function"||typeof m.pipe=="function"&&typeof m.on=="function")}function U(m){return!!(m&&!k(m)&&typeof m.pipeThrough=="function"&&typeof m.getReader=="function"&&typeof m.cancel=="function")}function A(m){return!!(m&&!k(m)&&typeof m.getWriter=="function"&&typeof m.abort=="function")}function y(m){return!!(m&&!k(m)&&typeof m.readable=="object"&&typeof m.writable=="object")}function R(m){return U(m)||A(m)||y(m)}function p(m,j){return m==null?!1:j===!0?typeof m[r]=="function":j===!1?typeof m[e]=="function":typeof m[r]=="function"||typeof m[e]=="function"}function T(m){if(!k(m))return null;const j=m._writableState,K=m._readableState,W=j||K;return!!(m.destroyed||m[n]||W!=null&&W.destroyed)}function $(m){if(!x(m))return null;if(m.writableEnded===!0)return!0;const j=m._writableState;return j!=null&&j.errored?!1:typeof j?.ended!="boolean"?null:j.ended}function H(m,j){if(!x(m))return null;if(m.writableFinished===!0)return!0;const K=m._writableState;return K!=null&&K.errored?!1:typeof K?.finished!="boolean"?null:!!(K.finished||j===!1&&K.ended===!0&&K.length===0)}function Y(m){if(!N(m))return null;if(m.readableEnded===!0)return!0;const j=m._readableState;return!j||j.errored?!1:typeof j?.ended!="boolean"?null:j.ended}function X(m,j){if(!N(m))return null;const K=m._readableState;return K!=null&&K.errored?!1:typeof K?.endEmitted!="boolean"?null:!!(K.endEmitted||j===!1&&K.ended===!0&&K.length===0)}function a(m){return m&&m[s]!=null?m[s]:typeof m?.readable!="boolean"?null:T(m)?!1:N(m)&&m.readable&&!X(m)}function b(m){return m&&m[o]!=null?m[o]:typeof m?.writable!="boolean"?null:T(m)?!1:x(m)&&m.writable&&!$(m)}function u(m,j){return k(m)?T(m)?!0:!(j?.readable!==!1&&a(m)||j?.writable!==!1&&b(m)):null}function c(m){var j,K;return k(m)?m.writableErrored?m.writableErrored:(j=(K=m._writableState)===null||K===void 0?void 0:K.errored)!==null&&j!==void 0?j:null:null}function w(m){var j,K;return k(m)?m.readableErrored?m.readableErrored:(j=(K=m._readableState)===null||K===void 0?void 0:K.errored)!==null&&j!==void 0?j:null:null}function f(m){if(!k(m))return null;if(typeof m.closed=="boolean")return m.closed;const j=m._writableState,K=m._readableState;return typeof j?.closed=="boolean"||typeof K?.closed=="boolean"?j?.closed||K?.closed:typeof m._closed=="boolean"&&C(m)?m._closed:null}function C(m){return typeof m._closed=="boolean"&&typeof m._defaultKeepAlive=="boolean"&&typeof m._removedConnection=="boolean"&&typeof m._removedContLen=="boolean"}function h(m){return typeof m._sent100=="boolean"&&C(m)}function v(m){var j;return typeof m._consuming=="boolean"&&typeof m._dumped=="boolean"&&((j=m.req)===null||j===void 0?void 0:j.upgradeOrConnect)===void 0}function P(m){if(!k(m))return null;const j=m._writableState,K=m._readableState,W=j||K;return!W&&h(m)||!!(W&&W.autoDestroy&&W.emitClose&&W.closed===!1)}function _(m){var j;return!!(m&&((j=m[l])!==null&&j!==void 0?j:m.readableDidRead||m.readableAborted))}function M(m){var j,K,W,ee,Q,le,ue,G,V,oe;return!!(m&&((j=(K=(W=(ee=(Q=(le=m[i])!==null&&le!==void 0?le:m.readableErrored)!==null&&Q!==void 0?Q:m.writableErrored)!==null&&ee!==void 0?ee:(ue=m._readableState)===null||ue===void 0?void 0:ue.errorEmitted)!==null&&W!==void 0?W:(G=m._writableState)===null||G===void 0?void 0:G.errorEmitted)!==null&&K!==void 0?K:(V=m._readableState)===null||V===void 0?void 0:V.errored)!==null&&j!==void 0?j:!((oe=m._writableState)===null||oe===void 0)&&oe.errored))}return gn={isDestroyed:T,kIsDestroyed:n,isDisturbed:_,kIsDisturbed:l,isErrored:M,kIsErrored:i,isReadable:a,kIsReadable:s,kIsClosedPromise:d,kControllerErrorFunction:g,kIsWritable:o,isClosed:f,isDuplexNodeStream:E,isFinished:u,isIterable:p,isReadableNodeStream:N,isReadableStream:U,isReadableEnded:Y,isReadableFinished:X,isReadableErrored:w,isNodeStream:k,isWebStream:R,isWritable:b,isWritableNodeStream:x,isWritableStream:A,isWritableEnded:$,isWritableFinished:H,isWritableErrored:c,isServerRequest:v,isServerResponse:h,willEmitClose:P,isTransformStream:y},gn}var Di;function mt(){if(Di)return Er.exports;Di=1;const r=Lt(),{AbortError:e,codes:t}=Be(),{ERR_INVALID_ARG_TYPE:n,ERR_STREAM_PREMATURE_CLOSE:i}=t,{kEmptyObject:s,once:o}=We(),{validateAbortSignal:l,validateFunction:d,validateObject:g,validateBoolean:N}=nr(),{Promise:x,PromisePrototypeThen:E,SymbolDispose:k}=Ie(),{isClosed:U,isReadable:A,isReadableNodeStream:y,isReadableStream:R,isReadableFinished:p,isReadableErrored:T,isWritable:$,isWritableNodeStream:H,isWritableStream:Y,isWritableFinished:X,isWritableErrored:a,isNodeStream:b,willEmitClose:u,kIsClosedPromise:c}=ht();let w;function f(_){return _.setHeader&&typeof _.abort=="function"}const C=()=>{};function h(_,M,m){var j,K;if(arguments.length===2?(m=M,M=s):M==null?M=s:g(M,"options"),d(m,"callback"),l(M.signal,"options.signal"),m=o(m),R(_)||Y(_))return v(_,M,m);if(!b(_))throw new n("stream",["ReadableStream","WritableStream","Stream"],_);const W=(j=M.readable)!==null&&j!==void 0?j:y(_),ee=(K=M.writable)!==null&&K!==void 0?K:H(_),Q=_._writableState,le=_._readableState,ue=()=>{_.writable||oe()};let G=u(_)&&y(_)===W&&H(_)===ee,V=X(_,!1);const oe=()=>{V=!0,_.destroyed&&(G=!1),!(G&&(!_.readable||W))&&(!W||ce)&&m.call(_)};let ce=p(_,!1);const fe=()=>{ce=!0,_.destroyed&&(G=!1),!(G&&(!_.writable||ee))&&(!ee||V)&&m.call(_)},L=B=>{m.call(_,B)};let D=U(_);const F=()=>{D=!0;const B=a(_)||T(_);if(B&&typeof B!="boolean")return m.call(_,B);if(W&&!ce&&y(_,!0)&&!p(_,!1))return m.call(_,new i);if(ee&&!V&&!X(_,!1))return m.call(_,new i);m.call(_)},ne=()=>{D=!0;const B=a(_)||T(_);if(B&&typeof B!="boolean")return m.call(_,B);m.call(_)},se=()=>{_.req.on("finish",oe)};f(_)?(_.on("complete",oe),G||_.on("abort",F),_.req?se():_.on("request",se)):ee&&!Q&&(_.on("end",ue),_.on("close",ue)),!G&&typeof _.aborted=="boolean"&&_.on("aborted",F),_.on("end",fe),_.on("finish",oe),M.error!==!1&&_.on("error",L),_.on("close",F),D?r.nextTick(F):Q!=null&&Q.errorEmitted||le!=null&&le.errorEmitted?G||r.nextTick(ne):(!W&&(!G||A(_))&&(V||$(_)===!1)||!ee&&(!G||$(_))&&(ce||A(_)===!1)||le&&_.req&&_.aborted)&&r.nextTick(ne);const ie=()=>{m=C,_.removeListener("aborted",F),_.removeListener("complete",oe),_.removeListener("abort",F),_.removeListener("request",se),_.req&&_.req.removeListener("finish",oe),_.removeListener("end",ue),_.removeListener("close",ue),_.removeListener("finish",oe),_.removeListener("end",fe),_.removeListener("error",L),_.removeListener("close",F)};if(M.signal&&!D){const B=()=>{const Z=m;ie(),Z.call(_,new e(void 0,{cause:M.signal.reason}))};if(M.signal.aborted)r.nextTick(B);else{w=w||We().addAbortListener;const Z=w(M.signal,B),re=m;m=o((...J)=>{Z[k](),re.apply(_,J)})}}return ie}function v(_,M,m){let j=!1,K=C;if(M.signal)if(K=()=>{j=!0,m.call(_,new e(void 0,{cause:M.signal.reason}))},M.signal.aborted)r.nextTick(K);else{w=w||We().addAbortListener;const ee=w(M.signal,K),Q=m;m=o((...le)=>{ee[k](),Q.apply(_,le)})}const W=(...ee)=>{j||r.nextTick(()=>m.apply(_,ee))};return E(_[c].promise,W,W),C}function P(_,M){var m;let j=!1;return M===null&&(M=s),(m=M)!==null&&m!==void 0&&m.cleanup&&(N(M.cleanup,"cleanup"),j=M.cleanup),new x((K,W)=>{const ee=h(_,M,Q=>{j&&ee(),Q?W(Q):K()})})}return Er.exports=h,Er.exports.finished=P,Er.exports}var pn,Bi;function qt(){if(Bi)return pn;Bi=1;const r=Lt(),{aggregateTwoErrors:e,codes:{ERR_MULTIPLE_CALLBACK:t},AbortError:n}=Be(),{Symbol:i}=Ie(),{kIsDestroyed:s,isDestroyed:o,isFinished:l,isServerRequest:d}=ht(),g=i("kDestroy"),N=i("kConstruct");function x(u,c,w){u&&(u.stack,c&&!c.errored&&(c.errored=u),w&&!w.errored&&(w.errored=u))}function E(u,c){const w=this._readableState,f=this._writableState,C=f||w;return f!=null&&f.destroyed||w!=null&&w.destroyed?(typeof c=="function"&&c(),this):(x(u,f,w),f&&(f.destroyed=!0),w&&(w.destroyed=!0),C.constructed?k(this,u,c):this.once(g,function(h){k(this,e(h,u),c)}),this)}function k(u,c,w){let f=!1;function C(h){if(f)return;f=!0;const v=u._readableState,P=u._writableState;x(h,P,v),P&&(P.closed=!0),v&&(v.closed=!0),typeof w=="function"&&w(h),h?r.nextTick(U,u,h):r.nextTick(A,u)}try{u._destroy(c||null,C)}catch(h){C(h)}}function U(u,c){y(u,c),A(u)}function A(u){const c=u._readableState,w=u._writableState;w&&(w.closeEmitted=!0),c&&(c.closeEmitted=!0),(w!=null&&w.emitClose||c!=null&&c.emitClose)&&u.emit("close")}function y(u,c){const w=u._readableState,f=u._writableState;f!=null&&f.errorEmitted||w!=null&&w.errorEmitted||(f&&(f.errorEmitted=!0),w&&(w.errorEmitted=!0),u.emit("error",c))}function R(){const u=this._readableState,c=this._writableState;u&&(u.constructed=!0,u.closed=!1,u.closeEmitted=!1,u.destroyed=!1,u.errored=null,u.errorEmitted=!1,u.reading=!1,u.ended=u.readable===!1,u.endEmitted=u.readable===!1),c&&(c.constructed=!0,c.destroyed=!1,c.closed=!1,c.closeEmitted=!1,c.errored=null,c.errorEmitted=!1,c.finalCalled=!1,c.prefinished=!1,c.ended=c.writable===!1,c.ending=c.writable===!1,c.finished=c.writable===!1)}function p(u,c,w){const f=u._readableState,C=u._writableState;if(C!=null&&C.destroyed||f!=null&&f.destroyed)return this;f!=null&&f.autoDestroy||C!=null&&C.autoDestroy?u.destroy(c):c&&(c.stack,C&&!C.errored&&(C.errored=c),f&&!f.errored&&(f.errored=c),w?r.nextTick(y,u,c):y(u,c))}function T(u,c){if(typeof u._construct!="function")return;const w=u._readableState,f=u._writableState;w&&(w.constructed=!1),f&&(f.constructed=!1),u.once(N,c),!(u.listenerCount(N)>1)&&r.nextTick($,u)}function $(u){let c=!1;function w(f){if(c){p(u,f??new t);return}c=!0;const C=u._readableState,h=u._writableState,v=h||C;C&&(C.constructed=!0),h&&(h.constructed=!0),v.destroyed?u.emit(g,f):f?p(u,f,!0):r.nextTick(H,u)}try{u._construct(f=>{r.nextTick(w,f)})}catch(f){r.nextTick(w,f)}}function H(u){u.emit(N)}function Y(u){return u?.setHeader&&typeof u.abort=="function"}function X(u){u.emit("close")}function a(u,c){u.emit("error",c),r.nextTick(X,u)}function b(u,c){!u||o(u)||(!c&&!l(u)&&(c=new n),d(u)?(u.socket=null,u.destroy(c)):Y(u)?u.abort():Y(u.req)?u.req.abort():typeof u.destroy=="function"?u.destroy(c):typeof u.close=="function"?u.close():c?r.nextTick(a,u,c):r.nextTick(X,u),u.destroyed||(u[s]=!0))}return pn={construct:T,destroyer:b,destroy:E,undestroy:R,errorOrDestroy:p},pn}var wn,ki;function ri(){if(ki)return wn;ki=1;const{ArrayIsArray:r,ObjectSetPrototypeOf:e}=Ie(),{EventEmitter:t}=Dr();function n(s){t.call(this,s)}e(n.prototype,t.prototype),e(n,t),n.prototype.pipe=function(s,o){const l=this;function d(A){s.writable&&s.write(A)===!1&&l.pause&&l.pause()}l.on("data",d);function g(){l.readable&&l.resume&&l.resume()}s.on("drain",g),!s._isStdio&&(!o||o.end!==!1)&&(l.on("end",x),l.on("close",E));let N=!1;function x(){N||(N=!0,s.end())}function E(){N||(N=!0,typeof s.destroy=="function"&&s.destroy())}function k(A){U(),t.listenerCount(this,"error")===0&&this.emit("error",A)}i(l,"error",k),i(s,"error",k);function U(){l.removeListener("data",d),s.removeListener("drain",g),l.removeListener("end",x),l.removeListener("close",E),l.removeListener("error",k),s.removeListener("error",k),l.removeListener("end",U),l.removeListener("close",U),s.removeListener("close",U)}return l.on("end",U),l.on("close",U),s.on("close",U),s.emit("pipe",l),s};function i(s,o,l){if(typeof s.prependListener=="function")return s.prependListener(o,l);!s._events||!s._events[o]?s.on(o,l):r(s._events[o])?s._events[o].unshift(l):s._events[o]=[l,s._events[o]]}return wn={Stream:n,prependListener:i},wn}var bn={exports:{}},Ui;function Br(){return Ui||(Ui=1,(function(r){const{SymbolDispose:e}=Ie(),{AbortError:t,codes:n}=Be(),{isNodeStream:i,isWebStream:s,kControllerErrorFunction:o}=ht(),l=mt(),{ERR_INVALID_ARG_TYPE:d}=n;let g;const N=(x,E)=>{if(typeof x!="object"||!("aborted"in x))throw new d(E,"AbortSignal",x)};r.exports.addAbortSignal=function(E,k){if(N(E,"signal"),!i(k)&&!s(k))throw new d("stream",["ReadableStream","WritableStream","Stream"],k);return r.exports.addAbortSignalNoValidate(E,k)},r.exports.addAbortSignalNoValidate=function(x,E){if(typeof x!="object"||!("aborted"in x))return E;const k=i(E)?()=>{E.destroy(new t(void 0,{cause:x.reason}))}:()=>{E[o](new t(void 0,{cause:x.reason}))};if(x.aborted)k();else{g=g||We().addAbortListener;const U=g(x,k);l(E,U[e])}return E}})(bn)),bn.exports}var yn,qi;function ia(){if(qi)return yn;qi=1;const{StringPrototypeSlice:r,SymbolIterator:e,TypedArrayPrototypeSet:t,Uint8Array:n}=Ie(),{Buffer:i}=Pt(),{inspect:s}=We();return yn=class{constructor(){this.head=null,this.tail=null,this.length=0}push(l){const d={data:l,next:null};this.length>0?this.tail.next=d:this.head=d,this.tail=d,++this.length}unshift(l){const d={data:l,next:this.head};this.length===0&&(this.tail=d),this.head=d,++this.length}shift(){if(this.length===0)return;const l=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,l}clear(){this.head=this.tail=null,this.length=0}join(l){if(this.length===0)return"";let d=this.head,g=""+d.data;for(;(d=d.next)!==null;)g+=l+d.data;return g}concat(l){if(this.length===0)return i.alloc(0);const d=i.allocUnsafe(l>>>0);let g=this.head,N=0;for(;g;)t(d,g.data,N),N+=g.data.length,g=g.next;return d}consume(l,d){const g=this.head.data;if(l<g.length){const N=g.slice(0,l);return this.head.data=g.slice(l),N}return l===g.length?this.shift():d?this._getString(l):this._getBuffer(l)}first(){return this.head.data}*[e](){for(let l=this.head;l;l=l.next)yield l.data}_getString(l){let d="",g=this.head,N=0;do{const x=g.data;if(l>x.length)d+=x,l-=x.length;else{l===x.length?(d+=x,++N,g.next?this.head=g.next:this.head=this.tail=null):(d+=r(x,0,l),this.head=g,g.data=r(x,l));break}++N}while((g=g.next)!==null);return this.length-=N,d}_getBuffer(l){const d=i.allocUnsafe(l),g=l;let N=this.head,x=0;do{const E=N.data;if(l>E.length)t(d,E,g-l),l-=E.length;else{l===E.length?(t(d,E,g-l),++x,N.next?this.head=N.next:this.head=this.tail=null):(t(d,new n(E.buffer,E.byteOffset,l),g-l),this.head=N,N.data=E.slice(l));break}++x}while((N=N.next)!==null);return this.length-=x,d}[Symbol.for("nodejs.util.inspect.custom")](l,d){return s(this,{...d,depth:0,customInspect:!1})}},yn}var _n,ji;function kr(){if(ji)return _n;ji=1;const{MathFloor:r,NumberIsInteger:e}=Ie(),{validateInteger:t}=nr(),{ERR_INVALID_ARG_VALUE:n}=Be().codes;let i=16*1024,s=16;function o(N,x,E){return N.highWaterMark!=null?N.highWaterMark:x?N[E]:null}function l(N){return N?s:i}function d(N,x){t(x,"value",0),N?s=x:i=x}function g(N,x,E,k){const U=o(x,k,E);if(U!=null){if(!e(U)||U<0){const A=k?`options.${E}`:"options.highWaterMark";throw new n(A,U)}return r(U)}return l(N.objectMode)}return _n={getHighWaterMark:g,getDefaultHighWaterMark:l,setDefaultHighWaterMark:d},_n}var mn,Wi;function Go(){if(Wi)return mn;Wi=1;const r=Lt(),{PromisePrototypeThen:e,SymbolAsyncIterator:t,SymbolIterator:n}=Ie(),{Buffer:i}=Pt(),{ERR_INVALID_ARG_TYPE:s,ERR_STREAM_NULL_VALUES:o}=Be().codes;function l(d,g,N){let x;if(typeof g=="string"||g instanceof i)return new d({objectMode:!0,...N,read(){this.push(g),this.push(null)}});let E;if(g&&g[t])E=!0,x=g[t]();else if(g&&g[n])E=!1,x=g[n]();else throw new s("iterable",["Iterable"],g);const k=new d({objectMode:!0,highWaterMark:1,...N});let U=!1;k._read=function(){U||(U=!0,y())},k._destroy=function(R,p){e(A(R),()=>r.nextTick(p,R),T=>r.nextTick(p,T||R))};async function A(R){const p=R!=null,T=typeof x.throw=="function";if(p&&T){const{value:$,done:H}=await x.throw(R);if(await $,H)return}if(typeof x.return=="function"){const{value:$}=await x.return();await $}}async function y(){for(;;){try{const{value:R,done:p}=E?await x.next():x.next();if(p)k.push(null);else{const T=R&&typeof R.then=="function"?await R:R;if(T===null)throw U=!1,new o;if(k.push(T))continue;U=!1}}catch(R){k.destroy(R)}break}}return k}return mn=l,mn}var En,Fi;function Ur(){if(Fi)return En;Fi=1;const r=Lt(),{ArrayPrototypeIndexOf:e,NumberIsInteger:t,NumberIsNaN:n,NumberParseInt:i,ObjectDefineProperties:s,ObjectKeys:o,ObjectSetPrototypeOf:l,Promise:d,SafeSet:g,SymbolAsyncDispose:N,SymbolAsyncIterator:x,Symbol:E}=Ie();En=J,J.ReadableState=re;const{EventEmitter:k}=Dr(),{Stream:U,prependListener:A}=ri(),{Buffer:y}=Pt(),{addAbortSignal:R}=Br(),p=mt();let T=We().debuglog("stream",S=>{T=S});const $=ia(),H=qt(),{getHighWaterMark:Y,getDefaultHighWaterMark:X}=kr(),{aggregateTwoErrors:a,codes:{ERR_INVALID_ARG_TYPE:b,ERR_METHOD_NOT_IMPLEMENTED:u,ERR_OUT_OF_RANGE:c,ERR_STREAM_PUSH_AFTER_EOF:w,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:f},AbortError:C}=Be(),{validateObject:h}=nr(),v=E("kPaused"),{StringDecoder:P}=Qs(),_=Go();l(J.prototype,U.prototype),l(J,U);const M=()=>{},{errorOrDestroy:m}=H,j=1,K=2,W=4,ee=8,Q=16,le=32,ue=64,G=128,V=256,oe=512,ce=1024,fe=2048,L=4096,D=8192,F=16384,ne=32768,se=65536,ie=1<<17,B=1<<18;function Z(S){return{enumerable:!1,get(){return(this.state&S)!==0},set(O){O?this.state|=S:this.state&=~S}}}s(re.prototype,{objectMode:Z(j),ended:Z(K),endEmitted:Z(W),reading:Z(ee),constructed:Z(Q),sync:Z(le),needReadable:Z(ue),emittedReadable:Z(G),readableListening:Z(V),resumeScheduled:Z(oe),errorEmitted:Z(ce),emitClose:Z(fe),autoDestroy:Z(L),destroyed:Z(D),closed:Z(F),closeEmitted:Z(ne),multiAwaitDrain:Z(se),readingMore:Z(ie),dataEmitted:Z(B)});function re(S,O,te){typeof te!="boolean"&&(te=O instanceof dt()),this.state=fe|L|Q|le,S&&S.objectMode&&(this.state|=j),te&&S&&S.readableObjectMode&&(this.state|=j),this.highWaterMark=S?Y(this,S,"readableHighWaterMark",te):X(!1),this.buffer=new $,this.length=0,this.pipes=[],this.flowing=null,this[v]=null,S&&S.emitClose===!1&&(this.state&=~fe),S&&S.autoDestroy===!1&&(this.state&=~L),this.errored=null,this.defaultEncoding=S&&S.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,S&&S.encoding&&(this.decoder=new P(S.encoding),this.encoding=S.encoding)}function J(S){if(!(this instanceof J))return new J(S);const O=this instanceof dt();this._readableState=new re(S,this,O),S&&(typeof S.read=="function"&&(this._read=S.read),typeof S.destroy=="function"&&(this._destroy=S.destroy),typeof S.construct=="function"&&(this._construct=S.construct),S.signal&&!O&&R(S.signal,this)),U.call(this,S),H.construct(this,()=>{this._readableState.needReadable&&Me(this,this._readableState)})}J.prototype.destroy=H.destroy,J.prototype._undestroy=H.undestroy,J.prototype._destroy=function(S,O){O(S)},J.prototype[k.captureRejectionSymbol]=function(S){this.destroy(S)},J.prototype[N]=function(){let S;return this.destroyed||(S=this.readableEnded?null:new C,this.destroy(S)),new d((O,te)=>p(this,ae=>ae&&ae!==S?te(ae):O(null)))},J.prototype.push=function(S,O){return we(this,S,O,!1)},J.prototype.unshift=function(S,O){return we(this,S,O,!0)};function we(S,O,te,ae){T("readableAddChunk",O);const de=S._readableState;let xe;if((de.state&j)===0&&(typeof O=="string"?(te=te||de.defaultEncoding,de.encoding!==te&&(ae&&de.encoding?O=y.from(O,te).toString(de.encoding):(O=y.from(O,te),te=""))):O instanceof y?te="":U._isUint8Array(O)?(O=U._uint8ArrayToBuffer(O),te=""):O!=null&&(xe=new b("chunk",["string","Buffer","Uint8Array"],O))),xe)m(S,xe);else if(O===null)de.state&=~ee,Le(S,de);else if((de.state&j)!==0||O&&O.length>0)if(ae)if((de.state&W)!==0)m(S,new f);else{if(de.destroyed||de.errored)return!1;Pe(S,de,O,!0)}else if(de.ended)m(S,new w);else{if(de.destroyed||de.errored)return!1;de.state&=~ee,de.decoder&&!te?(O=de.decoder.write(O),de.objectMode||O.length!==0?Pe(S,de,O,!1):Me(S,de)):Pe(S,de,O,!1)}else ae||(de.state&=~ee,Me(S,de));return!de.ended&&(de.length<de.highWaterMark||de.length===0)}function Pe(S,O,te,ae){O.flowing&&O.length===0&&!O.sync&&S.listenerCount("data")>0?((O.state&se)!==0?O.awaitDrainWriters.clear():O.awaitDrainWriters=null,O.dataEmitted=!0,S.emit("data",te)):(O.length+=O.objectMode?1:te.length,ae?O.buffer.unshift(te):O.buffer.push(te),(O.state&ue)!==0&&Ye(S)),Me(S,O)}J.prototype.isPaused=function(){const S=this._readableState;return S[v]===!0||S.flowing===!1},J.prototype.setEncoding=function(S){const O=new P(S);this._readableState.decoder=O,this._readableState.encoding=this._readableState.decoder.encoding;const te=this._readableState.buffer;let ae="";for(const de of te)ae+=O.write(de);return te.clear(),ae!==""&&te.push(ae),this._readableState.length=ae.length,this};const ye=1073741824;function De(S){if(S>ye)throw new c("size","<= 1GiB",S);return S--,S|=S>>>1,S|=S>>>2,S|=S>>>4,S|=S>>>8,S|=S>>>16,S++,S}function Oe(S,O){return S<=0||O.length===0&&O.ended?0:(O.state&j)!==0?1:n(S)?O.flowing&&O.length?O.buffer.first().length:O.length:S<=O.length?S:O.ended?O.length:0}J.prototype.read=function(S){T("read",S),S===void 0?S=NaN:t(S)||(S=i(S,10));const O=this._readableState,te=S;if(S>O.highWaterMark&&(O.highWaterMark=De(S)),S!==0&&(O.state&=~G),S===0&&O.needReadable&&((O.highWaterMark!==0?O.length>=O.highWaterMark:O.length>0)||O.ended))return T("read: emitReadable",O.length,O.ended),O.length===0&&O.ended?Wt(this):Ye(this),null;if(S=Oe(S,O),S===0&&O.ended)return O.length===0&&Wt(this),null;let ae=(O.state&ue)!==0;if(T("need readable",ae),(O.length===0||O.length-S<O.highWaterMark)&&(ae=!0,T("length less than watermark",ae)),O.ended||O.reading||O.destroyed||O.errored||!O.constructed)ae=!1,T("reading, ended or constructing",ae);else if(ae){T("do read"),O.state|=ee|le,O.length===0&&(O.state|=ue);try{this._read(O.highWaterMark)}catch(xe){m(this,xe)}O.state&=~le,O.reading||(S=Oe(te,O))}let de;return S>0?de=gt(S,O):de=null,de===null?(O.needReadable=O.length<=O.highWaterMark,S=0):(O.length-=S,O.multiAwaitDrain?O.awaitDrainWriters.clear():O.awaitDrainWriters=null),O.length===0&&(O.ended||(O.needReadable=!0),te!==S&&O.ended&&Wt(this)),de!==null&&!O.errorEmitted&&!O.closeEmitted&&(O.dataEmitted=!0,this.emit("data",de)),de};function Le(S,O){if(T("onEofChunk"),!O.ended){if(O.decoder){const te=O.decoder.end();te&&te.length&&(O.buffer.push(te),O.length+=O.objectMode?1:te.length)}O.ended=!0,O.sync?Ye(S):(O.needReadable=!1,O.emittedReadable=!0,Et(S))}}function Ye(S){const O=S._readableState;T("emitReadable",O.needReadable,O.emittedReadable),O.needReadable=!1,O.emittedReadable||(T("emitReadable",O.flowing),O.emittedReadable=!0,r.nextTick(Et,S))}function Et(S){const O=S._readableState;T("emitReadable_",O.destroyed,O.length,O.ended),!O.destroyed&&!O.errored&&(O.length||O.ended)&&(S.emit("readable"),O.emittedReadable=!1),O.needReadable=!O.flowing&&!O.ended&&O.length<=O.highWaterMark,jt(S)}function Me(S,O){!O.readingMore&&O.constructed&&(O.readingMore=!0,r.nextTick(ar,S,O))}function ar(S,O){for(;!O.reading&&!O.ended&&(O.length<O.highWaterMark||O.flowing&&O.length===0);){const te=O.length;if(T("maybeReadMore read 0"),S.read(0),te===O.length)break}O.readingMore=!1}J.prototype._read=function(S){throw new u("_read()")},J.prototype.pipe=function(S,O){const te=this,ae=this._readableState;ae.pipes.length===1&&(ae.multiAwaitDrain||(ae.multiAwaitDrain=!0,ae.awaitDrainWriters=new g(ae.awaitDrainWriters?[ae.awaitDrainWriters]:[]))),ae.pipes.push(S),T("pipe count=%d opts=%j",ae.pipes.length,O);const xe=(!O||O.end!==!1)&&S!==r.stdout&&S!==r.stderr?dr:vt;ae.endEmitted?r.nextTick(xe):te.once("end",xe),S.on("unpipe",ke);function ke(st,Je){T("onunpipe"),st===te&&Je&&Je.hasUnpiped===!1&&(Je.hasUnpiped=!0,Kr())}function dr(){T("onend"),S.end()}let Ue,hr=!1;function Kr(){T("cleanup"),S.removeListener("close",tt),S.removeListener("finish",Ht),Ue&&S.removeListener("drain",Ue),S.removeListener("error",$t),S.removeListener("unpipe",ke),te.removeListener("end",dr),te.removeListener("end",vt),te.removeListener("data",pr),hr=!0,Ue&&ae.awaitDrainWriters&&(!S._writableState||S._writableState.needDrain)&&Ue()}function gr(){hr||(ae.pipes.length===1&&ae.pipes[0]===S?(T("false write response, pause",0),ae.awaitDrainWriters=S,ae.multiAwaitDrain=!1):ae.pipes.length>1&&ae.pipes.includes(S)&&(T("false write response, pause",ae.awaitDrainWriters.size),ae.awaitDrainWriters.add(S)),te.pause()),Ue||(Ue=zr(te,S),S.on("drain",Ue))}te.on("data",pr);function pr(st){T("ondata");const Je=S.write(st);T("dest.write",Je),Je===!1&&gr()}function $t(st){if(T("onerror",st),vt(),S.removeListener("error",$t),S.listenerCount("error")===0){const Je=S._writableState||S._readableState;Je&&!Je.errorEmitted?m(S,st):S.emit("error",st)}}A(S,"error",$t);function tt(){S.removeListener("finish",Ht),vt()}S.once("close",tt);function Ht(){T("onfinish"),S.removeListener("close",tt),vt()}S.once("finish",Ht);function vt(){T("unpipe"),te.unpipe(S)}return S.emit("pipe",te),S.writableNeedDrain===!0?gr():ae.flowing||(T("pipe resume"),te.resume()),S};function zr(S,O){return function(){const ae=S._readableState;ae.awaitDrainWriters===O?(T("pipeOnDrain",1),ae.awaitDrainWriters=null):ae.multiAwaitDrain&&(T("pipeOnDrain",ae.awaitDrainWriters.size),ae.awaitDrainWriters.delete(O)),(!ae.awaitDrainWriters||ae.awaitDrainWriters.size===0)&&S.listenerCount("data")&&S.resume()}}J.prototype.unpipe=function(S){const O=this._readableState,te={hasUnpiped:!1};if(O.pipes.length===0)return this;if(!S){const de=O.pipes;O.pipes=[],this.pause();for(let xe=0;xe<de.length;xe++)de[xe].emit("unpipe",this,{hasUnpiped:!1});return this}const ae=e(O.pipes,S);return ae===-1?this:(O.pipes.splice(ae,1),O.pipes.length===0&&this.pause(),S.emit("unpipe",this,te),this)},J.prototype.on=function(S,O){const te=U.prototype.on.call(this,S,O),ae=this._readableState;return S==="data"?(ae.readableListening=this.listenerCount("readable")>0,ae.flowing!==!1&&this.resume()):S==="readable"&&!ae.endEmitted&&!ae.readableListening&&(ae.readableListening=ae.needReadable=!0,ae.flowing=!1,ae.emittedReadable=!1,T("on readable",ae.length,ae.reading),ae.length?Ye(this):ae.reading||r.nextTick(it,this)),te},J.prototype.addListener=J.prototype.on,J.prototype.removeListener=function(S,O){const te=U.prototype.removeListener.call(this,S,O);return S==="readable"&&r.nextTick(lr,this),te},J.prototype.off=J.prototype.removeListener,J.prototype.removeAllListeners=function(S){const O=U.prototype.removeAllListeners.apply(this,arguments);return(S==="readable"||S===void 0)&&r.nextTick(lr,this),O};function lr(S){const O=S._readableState;O.readableListening=S.listenerCount("readable")>0,O.resumeScheduled&&O[v]===!1?O.flowing=!0:S.listenerCount("data")>0?S.resume():O.readableListening||(O.flowing=null)}function it(S){T("readable nexttick read 0"),S.read(0)}J.prototype.resume=function(){const S=this._readableState;return S.flowing||(T("resume"),S.flowing=!S.readableListening,Mt(this,S)),S[v]=!1,this};function Mt(S,O){O.resumeScheduled||(O.resumeScheduled=!0,r.nextTick(Gr,S,O))}function Gr(S,O){T("resume",O.reading),O.reading||S.read(0),O.resumeScheduled=!1,S.emit("resume"),jt(S),O.flowing&&!O.reading&&S.read(0)}J.prototype.pause=function(){return T("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(T("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[v]=!0,this};function jt(S){const O=S._readableState;for(T("flow",O.flowing);O.flowing&&S.read()!==null;);}J.prototype.wrap=function(S){let O=!1;S.on("data",ae=>{!this.push(ae)&&S.pause&&(O=!0,S.pause())}),S.on("end",()=>{this.push(null)}),S.on("error",ae=>{m(this,ae)}),S.on("close",()=>{this.destroy()}),S.on("destroy",()=>{this.destroy()}),this._read=()=>{O&&S.resume&&(O=!1,S.resume())};const te=o(S);for(let ae=1;ae<te.length;ae++){const de=te[ae];this[de]===void 0&&typeof S[de]=="function"&&(this[de]=S[de].bind(S))}return this},J.prototype[x]=function(){return ur(this)},J.prototype.iterator=function(S){return S!==void 0&&h(S,"options"),ur(this,S)};function ur(S,O){typeof S.read!="function"&&(S=J.wrap(S,{objectMode:!0}));const te=fr(S,O);return te.stream=S,te}async function*fr(S,O){let te=M;function ae(ke){this===S?(te(),te=M):te=ke}S.on("readable",ae);let de;const xe=p(S,{writable:!1},ke=>{de=ke?a(de,ke):null,te(),te=M});try{for(;;){const ke=S.destroyed?null:S.read();if(ke!==null)yield ke;else{if(de)throw de;if(de===null)return;await new d(ae)}}}catch(ke){throw de=a(de,ke),de}finally{(de||O?.destroyOnReturn!==!1)&&(de===void 0||S._readableState.autoDestroy)?H.destroyer(S,null):(S.off("readable",ae),xe())}}s(J.prototype,{readable:{__proto__:null,get(){const S=this._readableState;return!!S&&S.readable!==!1&&!S.destroyed&&!S.errorEmitted&&!S.endEmitted},set(S){this._readableState&&(this._readableState.readable=!!S)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(S){this._readableState&&(this._readableState.flowing=S)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(S){this._readableState&&(this._readableState.destroyed=S)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),s(re.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[v]!==!1},set(S){this[v]=!!S}}}),J._fromList=gt;function gt(S,O){if(O.length===0)return null;let te;return O.objectMode?te=O.buffer.shift():!S||S>=O.length?(O.decoder?te=O.buffer.join(""):O.buffer.length===1?te=O.buffer.first():te=O.buffer.concat(O.length),O.buffer.clear()):te=O.buffer.consume(S,O.decoder),te}function Wt(S){const O=S._readableState;T("endReadable",O.endEmitted),O.endEmitted||(O.ended=!0,r.nextTick(ot,O,S))}function ot(S,O){if(T("endReadableNT",S.endEmitted,S.length),!S.errored&&!S.closeEmitted&&!S.endEmitted&&S.length===0){if(S.endEmitted=!0,O.emit("end"),O.writable&&O.allowHalfOpen===!1)r.nextTick(Vr,O);else if(S.autoDestroy){const te=O._writableState;(!te||te.autoDestroy&&(te.finished||te.writable===!1))&&O.destroy()}}}function Vr(S){S.writable&&!S.writableEnded&&!S.destroyed&&S.end()}J.from=function(S,O){return _(J,S,O)};let Ft;function cr(){return Ft===void 0&&(Ft={}),Ft}return J.fromWeb=function(S,O){return cr().newStreamReadableFromReadableStream(S,O)},J.toWeb=function(S,O){return cr().newReadableStreamFromStreamReadable(S,O)},J.wrap=function(S,O){var te,ae;return new J({objectMode:(te=(ae=S.readableObjectMode)!==null&&ae!==void 0?ae:S.objectMode)!==null&&te!==void 0?te:!0,...O,destroy(de,xe){H.destroyer(S,de),xe(de)}}).wrap(S)},En}var vn,$i;function ni(){if($i)return vn;$i=1;const r=Lt(),{ArrayPrototypeSlice:e,Error:t,FunctionPrototypeSymbolHasInstance:n,ObjectDefineProperty:i,ObjectDefineProperties:s,ObjectSetPrototypeOf:o,StringPrototypeToLowerCase:l,Symbol:d,SymbolHasInstance:g}=Ie();vn=h,h.WritableState=f;const{EventEmitter:N}=Dr(),x=ri().Stream,{Buffer:E}=Pt(),k=qt(),{addAbortSignal:U}=Br(),{getHighWaterMark:A,getDefaultHighWaterMark:y}=kr(),{ERR_INVALID_ARG_TYPE:R,ERR_METHOD_NOT_IMPLEMENTED:p,ERR_MULTIPLE_CALLBACK:T,ERR_STREAM_CANNOT_PIPE:$,ERR_STREAM_DESTROYED:H,ERR_STREAM_ALREADY_FINISHED:Y,ERR_STREAM_NULL_VALUES:X,ERR_STREAM_WRITE_AFTER_END:a,ERR_UNKNOWN_ENCODING:b}=Be().codes,{errorOrDestroy:u}=k;o(h.prototype,x.prototype),o(h,x);function c(){}const w=d("kOnFinished");function f(L,D,F){typeof F!="boolean"&&(F=D instanceof dt()),this.objectMode=!!(L&&L.objectMode),F&&(this.objectMode=this.objectMode||!!(L&&L.writableObjectMode)),this.highWaterMark=L?A(this,L,"writableHighWaterMark",F):y(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const ne=!!(L&&L.decodeStrings===!1);this.decodeStrings=!ne,this.defaultEncoding=L&&L.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=m.bind(void 0,D),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,C(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!L||L.emitClose!==!1,this.autoDestroy=!L||L.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[w]=[]}function C(L){L.buffered=[],L.bufferedIndex=0,L.allBuffers=!0,L.allNoop=!0}f.prototype.getBuffer=function(){return e(this.buffered,this.bufferedIndex)},i(f.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function h(L){const D=this instanceof dt();if(!D&&!n(h,this))return new h(L);this._writableState=new f(L,this,D),L&&(typeof L.write=="function"&&(this._write=L.write),typeof L.writev=="function"&&(this._writev=L.writev),typeof L.destroy=="function"&&(this._destroy=L.destroy),typeof L.final=="function"&&(this._final=L.final),typeof L.construct=="function"&&(this._construct=L.construct),L.signal&&U(L.signal,this)),x.call(this,L),k.construct(this,()=>{const F=this._writableState;F.writing||ee(this,F),G(this,F)})}i(h,g,{__proto__:null,value:function(L){return n(this,L)?!0:this!==h?!1:L&&L._writableState instanceof f}}),h.prototype.pipe=function(){u(this,new $)};function v(L,D,F,ne){const se=L._writableState;if(typeof F=="function")ne=F,F=se.defaultEncoding;else{if(!F)F=se.defaultEncoding;else if(F!=="buffer"&&!E.isEncoding(F))throw new b(F);typeof ne!="function"&&(ne=c)}if(D===null)throw new X;if(!se.objectMode)if(typeof D=="string")se.decodeStrings!==!1&&(D=E.from(D,F),F="buffer");else if(D instanceof E)F="buffer";else if(x._isUint8Array(D))D=x._uint8ArrayToBuffer(D),F="buffer";else throw new R("chunk",["string","Buffer","Uint8Array"],D);let ie;return se.ending?ie=new a:se.destroyed&&(ie=new H("write")),ie?(r.nextTick(ne,ie),u(L,ie,!0),ie):(se.pendingcb++,P(L,se,D,F,ne))}h.prototype.write=function(L,D,F){return v(this,L,D,F)===!0},h.prototype.cork=function(){this._writableState.corked++},h.prototype.uncork=function(){const L=this._writableState;L.corked&&(L.corked--,L.writing||ee(this,L))},h.prototype.setDefaultEncoding=function(D){if(typeof D=="string"&&(D=l(D)),!E.isEncoding(D))throw new b(D);return this._writableState.defaultEncoding=D,this};function P(L,D,F,ne,se){const ie=D.objectMode?1:F.length;D.length+=ie;const B=D.length<D.highWaterMark;return B||(D.needDrain=!0),D.writing||D.corked||D.errored||!D.constructed?(D.buffered.push({chunk:F,encoding:ne,callback:se}),D.allBuffers&&ne!=="buffer"&&(D.allBuffers=!1),D.allNoop&&se!==c&&(D.allNoop=!1)):(D.writelen=ie,D.writecb=se,D.writing=!0,D.sync=!0,L._write(F,ne,D.onwrite),D.sync=!1),B&&!D.errored&&!D.destroyed}function _(L,D,F,ne,se,ie,B){D.writelen=ne,D.writecb=B,D.writing=!0,D.sync=!0,D.destroyed?D.onwrite(new H("write")):F?L._writev(se,D.onwrite):L._write(se,ie,D.onwrite),D.sync=!1}function M(L,D,F,ne){--D.pendingcb,ne(F),W(D),u(L,F)}function m(L,D){const F=L._writableState,ne=F.sync,se=F.writecb;if(typeof se!="function"){u(L,new T);return}F.writing=!1,F.writecb=null,F.length-=F.writelen,F.writelen=0,D?(D.stack,F.errored||(F.errored=D),L._readableState&&!L._readableState.errored&&(L._readableState.errored=D),ne?r.nextTick(M,L,F,D,se):M(L,F,D,se)):(F.buffered.length>F.bufferedIndex&&ee(L,F),ne?F.afterWriteTickInfo!==null&&F.afterWriteTickInfo.cb===se?F.afterWriteTickInfo.count++:(F.afterWriteTickInfo={count:1,cb:se,stream:L,state:F},r.nextTick(j,F.afterWriteTickInfo)):K(L,F,1,se))}function j({stream:L,state:D,count:F,cb:ne}){return D.afterWriteTickInfo=null,K(L,D,F,ne)}function K(L,D,F,ne){for(!D.ending&&!L.destroyed&&D.length===0&&D.needDrain&&(D.needDrain=!1,L.emit("drain"));F-- >0;)D.pendingcb--,ne();D.destroyed&&W(D),G(L,D)}function W(L){if(L.writing)return;for(let se=L.bufferedIndex;se<L.buffered.length;++se){var D;const{chunk:ie,callback:B}=L.buffered[se],Z=L.objectMode?1:ie.length;L.length-=Z,B((D=L.errored)!==null&&D!==void 0?D:new H("write"))}const F=L[w].splice(0);for(let se=0;se<F.length;se++){var ne;F[se]((ne=L.errored)!==null&&ne!==void 0?ne:new H("end"))}C(L)}function ee(L,D){if(D.corked||D.bufferProcessing||D.destroyed||!D.constructed)return;const{buffered:F,bufferedIndex:ne,objectMode:se}=D,ie=F.length-ne;if(!ie)return;let B=ne;if(D.bufferProcessing=!0,ie>1&&L._writev){D.pendingcb-=ie-1;const Z=D.allNoop?c:J=>{for(let we=B;we<F.length;++we)F[we].callback(J)},re=D.allNoop&&B===0?F:e(F,B);re.allBuffers=D.allBuffers,_(L,D,!0,D.length,re,"",Z),C(D)}else{do{const{chunk:Z,encoding:re,callback:J}=F[B];F[B++]=null;const we=se?1:Z.length;_(L,D,!1,we,Z,re,J)}while(B<F.length&&!D.writing);B===F.length?C(D):B>256?(F.splice(0,B),D.bufferedIndex=0):D.bufferedIndex=B}D.bufferProcessing=!1}h.prototype._write=function(L,D,F){if(this._writev)this._writev([{chunk:L,encoding:D}],F);else throw new p("_write()")},h.prototype._writev=null,h.prototype.end=function(L,D,F){const ne=this._writableState;typeof L=="function"?(F=L,L=null,D=null):typeof D=="function"&&(F=D,D=null);let se;if(L!=null){const ie=v(this,L,D);ie instanceof t&&(se=ie)}return ne.corked&&(ne.corked=1,this.uncork()),se||(!ne.errored&&!ne.ending?(ne.ending=!0,G(this,ne,!0),ne.ended=!0):ne.finished?se=new Y("end"):ne.destroyed&&(se=new H("end"))),typeof F=="function"&&(se||ne.finished?r.nextTick(F,se):ne[w].push(F)),this};function Q(L){return L.ending&&!L.destroyed&&L.constructed&&L.length===0&&!L.errored&&L.buffered.length===0&&!L.finished&&!L.writing&&!L.errorEmitted&&!L.closeEmitted}function le(L,D){let F=!1;function ne(se){if(F){u(L,se??T());return}if(F=!0,D.pendingcb--,se){const ie=D[w].splice(0);for(let B=0;B<ie.length;B++)ie[B](se);u(L,se,D.sync)}else Q(D)&&(D.prefinished=!0,L.emit("prefinish"),D.pendingcb++,r.nextTick(V,L,D))}D.sync=!0,D.pendingcb++;try{L._final(ne)}catch(se){ne(se)}D.sync=!1}function ue(L,D){!D.prefinished&&!D.finalCalled&&(typeof L._final=="function"&&!D.destroyed?(D.finalCalled=!0,le(L,D)):(D.prefinished=!0,L.emit("prefinish")))}function G(L,D,F){Q(D)&&(ue(L,D),D.pendingcb===0&&(F?(D.pendingcb++,r.nextTick((ne,se)=>{Q(se)?V(ne,se):se.pendingcb--},L,D)):Q(D)&&(D.pendingcb++,V(L,D))))}function V(L,D){D.pendingcb--,D.finished=!0;const F=D[w].splice(0);for(let ne=0;ne<F.length;ne++)F[ne]();if(L.emit("finish"),D.autoDestroy){const ne=L._readableState;(!ne||ne.autoDestroy&&(ne.endEmitted||ne.readable===!1))&&L.destroy()}}s(h.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(L){this._writableState&&(this._writableState.destroyed=L)}},writable:{__proto__:null,get(){const L=this._writableState;return!!L&&L.writable!==!1&&!L.destroyed&&!L.errored&&!L.ending&&!L.ended},set(L){this._writableState&&(this._writableState.writable=!!L)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const L=this._writableState;return L?!L.destroyed&&!L.ending&&L.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const oe=k.destroy;h.prototype.destroy=function(L,D){const F=this._writableState;return!F.destroyed&&(F.bufferedIndex<F.buffered.length||F[w].length)&&r.nextTick(W,F),oe.call(this,L,D),this},h.prototype._undestroy=k.undestroy,h.prototype._destroy=function(L,D){D(L)},h.prototype[N.captureRejectionSymbol]=function(L){this.destroy(L)};let ce;function fe(){return ce===void 0&&(ce={}),ce}return h.fromWeb=function(L,D){return fe().newStreamWritableFromWritableStream(L,D)},h.toWeb=function(L){return fe().newWritableStreamFromStreamWritable(L)},vn}var Sn,Hi;function oa(){if(Hi)return Sn;Hi=1;const r=Lt(),e=Pt(),{isReadable:t,isWritable:n,isIterable:i,isNodeStream:s,isReadableNodeStream:o,isWritableNodeStream:l,isDuplexNodeStream:d,isReadableStream:g,isWritableStream:N}=ht(),x=mt(),{AbortError:E,codes:{ERR_INVALID_ARG_TYPE:k,ERR_INVALID_RETURN_VALUE:U}}=Be(),{destroyer:A}=qt(),y=dt(),R=Ur(),p=ni(),{createDeferredPromise:T}=We(),$=Go(),H=globalThis.Blob||e.Blob,Y=typeof H<"u"?function(f){return f instanceof H}:function(f){return!1},X=globalThis.AbortController||er().AbortController,{FunctionPrototypeCall:a}=Ie();class b extends y{constructor(f){super(f),f?.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),f?.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}Sn=function w(f,C){if(d(f))return f;if(o(f))return c({readable:f});if(l(f))return c({writable:f});if(s(f))return c({writable:!1,readable:!1});if(g(f))return c({readable:R.fromWeb(f)});if(N(f))return c({writable:p.fromWeb(f)});if(typeof f=="function"){const{value:v,write:P,final:_,destroy:M}=u(f);if(i(v))return $(b,v,{objectMode:!0,write:P,final:_,destroy:M});const m=v?.then;if(typeof m=="function"){let j;const K=a(m,v,W=>{if(W!=null)throw new U("nully","body",W)},W=>{A(j,W)});return j=new b({objectMode:!0,readable:!1,write:P,final(W){_(async()=>{try{await K,r.nextTick(W,null)}catch(ee){r.nextTick(W,ee)}})},destroy:M})}throw new U("Iterable, AsyncIterable or AsyncFunction",C,v)}if(Y(f))return w(f.arrayBuffer());if(i(f))return $(b,f,{objectMode:!0,writable:!1});if(g(f?.readable)&&N(f?.writable))return b.fromWeb(f);if(typeof f?.writable=="object"||typeof f?.readable=="object"){const v=f!=null&&f.readable?o(f?.readable)?f?.readable:w(f.readable):void 0,P=f!=null&&f.writable?l(f?.writable)?f?.writable:w(f.writable):void 0;return c({readable:v,writable:P})}const h=f?.then;if(typeof h=="function"){let v;return a(h,f,P=>{P!=null&&v.push(P),v.push(null)},P=>{A(v,P)}),v=new b({objectMode:!0,writable:!1,read(){}})}throw new k(C,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],f)};function u(w){let{promise:f,resolve:C}=T();const h=new X,v=h.signal;return{value:w((async function*(){for(;;){const _=f;f=null;const{chunk:M,done:m,cb:j}=await _;if(r.nextTick(j),m)return;if(v.aborted)throw new E(void 0,{cause:v.reason});({promise:f,resolve:C}=T()),yield M}})(),{signal:v}),write(_,M,m){const j=C;C=null,j({chunk:_,done:!1,cb:m})},final(_){const M=C;C=null,M({done:!0,cb:_})},destroy(_,M){h.abort(),M(_)}}}function c(w){const f=w.readable&&typeof w.readable.read!="function"?R.wrap(w.readable):w.readable,C=w.writable;let h=!!t(f),v=!!n(C),P,_,M,m,j;function K(W){const ee=m;m=null,ee?ee(W):W&&j.destroy(W)}return j=new b({readableObjectMode:!!(f!=null&&f.readableObjectMode),writableObjectMode:!!(C!=null&&C.writableObjectMode),readable:h,writable:v}),v&&(x(C,W=>{v=!1,W&&A(f,W),K(W)}),j._write=function(W,ee,Q){C.write(W,ee)?Q():P=Q},j._final=function(W){C.end(),_=W},C.on("drain",function(){if(P){const W=P;P=null,W()}}),C.on("finish",function(){if(_){const W=_;_=null,W()}})),h&&(x(f,W=>{h=!1,W&&A(f,W),K(W)}),f.on("readable",function(){if(M){const W=M;M=null,W()}}),f.on("end",function(){j.push(null)}),j._read=function(){for(;;){const W=f.read();if(W===null){M=j._read;return}if(!j.push(W))return}}),j._destroy=function(W,ee){!W&&m!==null&&(W=new E),M=null,P=null,_=null,m===null?ee(W):(m=ee,A(C,W),A(f,W))},j}return Sn}var An,zi;function dt(){if(zi)return An;zi=1;const{ObjectDefineProperties:r,ObjectGetOwnPropertyDescriptor:e,ObjectKeys:t,ObjectSetPrototypeOf:n}=Ie();An=o;const i=Ur(),s=ni();n(o.prototype,i.prototype),n(o,i);{const N=t(s.prototype);for(let x=0;x<N.length;x++){const E=N[x];o.prototype[E]||(o.prototype[E]=s.prototype[E])}}function o(N){if(!(this instanceof o))return new o(N);i.call(this,N),s.call(this,N),N?(this.allowHalfOpen=N.allowHalfOpen!==!1,N.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),N.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}r(o.prototype,{writable:{__proto__:null,...e(s.prototype,"writable")},writableHighWaterMark:{__proto__:null,...e(s.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...e(s.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...e(s.prototype,"writableBuffer")},writableLength:{__proto__:null,...e(s.prototype,"writableLength")},writableFinished:{__proto__:null,...e(s.prototype,"writableFinished")},writableCorked:{__proto__:null,...e(s.prototype,"writableCorked")},writableEnded:{__proto__:null,...e(s.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...e(s.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(N){this._readableState&&this._writableState&&(this._readableState.destroyed=N,this._writableState.destroyed=N)}}});let l;function d(){return l===void 0&&(l={}),l}o.fromWeb=function(N,x){return d().newStreamDuplexFromReadableWritablePair(N,x)},o.toWeb=function(N){return d().newReadableWritablePairFromDuplex(N)};let g;return o.from=function(N){return g||(g=oa()),g(N,"body")},An}var Rn,Gi;function Vo(){if(Gi)return Rn;Gi=1;const{ObjectSetPrototypeOf:r,Symbol:e}=Ie();Rn=o;const{ERR_METHOD_NOT_IMPLEMENTED:t}=Be().codes,n=dt(),{getHighWaterMark:i}=kr();r(o.prototype,n.prototype),r(o,n);const s=e("kCallback");function o(g){if(!(this instanceof o))return new o(g);const N=g?i(this,g,"readableHighWaterMark",!0):null;N===0&&(g={...g,highWaterMark:null,readableHighWaterMark:N,writableHighWaterMark:g.writableHighWaterMark||0}),n.call(this,g),this._readableState.sync=!1,this[s]=null,g&&(typeof g.transform=="function"&&(this._transform=g.transform),typeof g.flush=="function"&&(this._flush=g.flush)),this.on("prefinish",d)}function l(g){typeof this._flush=="function"&&!this.destroyed?this._flush((N,x)=>{if(N){g?g(N):this.destroy(N);return}x!=null&&this.push(x),this.push(null),g&&g()}):(this.push(null),g&&g())}function d(){this._final!==l&&l.call(this)}return o.prototype._final=l,o.prototype._transform=function(g,N,x){throw new t("_transform()")},o.prototype._write=function(g,N,x){const E=this._readableState,k=this._writableState,U=E.length;this._transform(g,N,(A,y)=>{if(A){x(A);return}y!=null&&this.push(y),k.ended||U===E.length||E.length<E.highWaterMark?x():this[s]=x})},o.prototype._read=function(){if(this[s]){const g=this[s];this[s]=null,g()}},Rn}var In,Vi;function Ko(){if(Vi)return In;Vi=1;const{ObjectSetPrototypeOf:r}=Ie();In=t;const e=Vo();r(t.prototype,e.prototype),r(t,e);function t(n){if(!(this instanceof t))return new t(n);e.call(this,n)}return t.prototype._transform=function(n,i,s){s(null,n)},In}var Tn,Ki;function ii(){if(Ki)return Tn;Ki=1;const r=Lt(),{ArrayIsArray:e,Promise:t,SymbolAsyncIterator:n,SymbolDispose:i}=Ie(),s=mt(),{once:o}=We(),l=qt(),d=dt(),{aggregateTwoErrors:g,codes:{ERR_INVALID_ARG_TYPE:N,ERR_INVALID_RETURN_VALUE:x,ERR_MISSING_ARGS:E,ERR_STREAM_DESTROYED:k,ERR_STREAM_PREMATURE_CLOSE:U},AbortError:A}=Be(),{validateFunction:y,validateAbortSignal:R}=nr(),{isIterable:p,isReadable:T,isReadableNodeStream:$,isNodeStream:H,isTransformStream:Y,isWebStream:X,isReadableStream:a,isReadableFinished:b}=ht(),u=globalThis.AbortController||er().AbortController;let c,w,f;function C(W,ee,Q){let le=!1;W.on("close",()=>{le=!0});const ue=s(W,{readable:ee,writable:Q},G=>{le=!G});return{destroy:G=>{le||(le=!0,l.destroyer(W,G||new k("pipe")))},cleanup:ue}}function h(W){return y(W[W.length-1],"streams[stream.length - 1]"),W.pop()}function v(W){if(p(W))return W;if($(W))return P(W);throw new N("val",["Readable","Iterable","AsyncIterable"],W)}async function*P(W){w||(w=Ur()),yield*w.prototype[n].call(W)}async function _(W,ee,Q,{end:le}){let ue,G=null;const V=fe=>{if(fe&&(ue=fe),G){const L=G;G=null,L()}},oe=()=>new t((fe,L)=>{ue?L(ue):G=()=>{ue?L(ue):fe()}});ee.on("drain",V);const ce=s(ee,{readable:!1},V);try{ee.writableNeedDrain&&await oe();for await(const fe of W)ee.write(fe)||await oe();le&&(ee.end(),await oe()),Q()}catch(fe){Q(ue!==fe?g(ue,fe):fe)}finally{ce(),ee.off("drain",V)}}async function M(W,ee,Q,{end:le}){Y(ee)&&(ee=ee.writable);const ue=ee.getWriter();try{for await(const G of W)await ue.ready,ue.write(G).catch(()=>{});await ue.ready,le&&await ue.close(),Q()}catch(G){try{await ue.abort(G),Q(G)}catch(V){Q(V)}}}function m(...W){return j(W,o(h(W)))}function j(W,ee,Q){if(W.length===1&&e(W[0])&&(W=W[0]),W.length<2)throw new E("streams");const le=new u,ue=le.signal,G=Q?.signal,V=[];R(G,"options.signal");function oe(){se(new A)}f=f||We().addAbortListener;let ce;G&&(ce=f(G,oe));let fe,L;const D=[];let F=0;function ne(re){se(re,--F===0)}function se(re,J){var we;if(re&&(!fe||fe.code==="ERR_STREAM_PREMATURE_CLOSE")&&(fe=re),!(!fe&&!J)){for(;D.length;)D.shift()(fe);(we=ce)===null||we===void 0||we[i](),le.abort(),J&&(fe||V.forEach(Pe=>Pe()),r.nextTick(ee,fe,L))}}let ie;for(let re=0;re<W.length;re++){const J=W[re],we=re<W.length-1,Pe=re>0,ye=we||Q?.end!==!1,De=re===W.length-1;if(H(J)){let Oe=function(Le){Le&&Le.name!=="AbortError"&&Le.code!=="ERR_STREAM_PREMATURE_CLOSE"&&ne(Le)};if(ye){const{destroy:Le,cleanup:Ye}=C(J,we,Pe);D.push(Le),T(J)&&De&&V.push(Ye)}J.on("error",Oe),T(J)&&De&&V.push(()=>{J.removeListener("error",Oe)})}if(re===0)if(typeof J=="function"){if(ie=J({signal:ue}),!p(ie))throw new x("Iterable, AsyncIterable or Stream","source",ie)}else p(J)||$(J)||Y(J)?ie=J:ie=d.from(J);else if(typeof J=="function"){if(Y(ie)){var B;ie=v((B=ie)===null||B===void 0?void 0:B.readable)}else ie=v(ie);if(ie=J(ie,{signal:ue}),we){if(!p(ie,!0))throw new x("AsyncIterable",`transform[${re-1}]`,ie)}else{var Z;c||(c=Ko());const Oe=new c({objectMode:!0}),Le=(Z=ie)===null||Z===void 0?void 0:Z.then;if(typeof Le=="function")F++,Le.call(ie,Me=>{L=Me,Me!=null&&Oe.write(Me),ye&&Oe.end(),r.nextTick(ne)},Me=>{Oe.destroy(Me),r.nextTick(ne,Me)});else if(p(ie,!0))F++,_(ie,Oe,ne,{end:ye});else if(a(ie)||Y(ie)){const Me=ie.readable||ie;F++,_(Me,Oe,ne,{end:ye})}else throw new x("AsyncIterable or Promise","destination",ie);ie=Oe;const{destroy:Ye,cleanup:Et}=C(ie,!1,!0);D.push(Ye),De&&V.push(Et)}}else if(H(J)){if($(ie)){F+=2;const Oe=K(ie,J,ne,{end:ye});T(J)&&De&&V.push(Oe)}else if(Y(ie)||a(ie)){const Oe=ie.readable||ie;F++,_(Oe,J,ne,{end:ye})}else if(p(ie))F++,_(ie,J,ne,{end:ye});else throw new N("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],ie);ie=J}else if(X(J)){if($(ie))F++,M(v(ie),J,ne,{end:ye});else if(a(ie)||p(ie))F++,M(ie,J,ne,{end:ye});else if(Y(ie))F++,M(ie.readable,J,ne,{end:ye});else throw new N("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],ie);ie=J}else ie=d.from(J)}return(ue!=null&&ue.aborted||G!=null&&G.aborted)&&r.nextTick(oe),ie}function K(W,ee,Q,{end:le}){let ue=!1;if(ee.on("close",()=>{ue||Q(new U)}),W.pipe(ee,{end:!1}),le){let G=function(){ue=!0,ee.end()};b(W)?r.nextTick(G):W.once("end",G)}else Q();return s(W,{readable:!0,writable:!1},G=>{const V=W._readableState;G&&G.code==="ERR_STREAM_PREMATURE_CLOSE"&&V&&V.ended&&!V.errored&&!V.errorEmitted?W.once("end",Q).once("error",Q):Q(G)}),s(ee,{readable:!1,writable:!0},Q)}return Tn={pipelineImpl:j,pipeline:m},Tn}var On,Yi;function Yo(){if(Yi)return On;Yi=1;const{pipeline:r}=ii(),e=dt(),{destroyer:t}=qt(),{isNodeStream:n,isReadable:i,isWritable:s,isWebStream:o,isTransformStream:l,isWritableStream:d,isReadableStream:g}=ht(),{AbortError:N,codes:{ERR_INVALID_ARG_VALUE:x,ERR_MISSING_ARGS:E}}=Be(),k=mt();return On=function(...A){if(A.length===0)throw new E("streams");if(A.length===1)return e.from(A[0]);const y=[...A];if(typeof A[0]=="function"&&(A[0]=e.from(A[0])),typeof A[A.length-1]=="function"){const c=A.length-1;A[c]=e.from(A[c])}for(let c=0;c<A.length;++c)if(!(!n(A[c])&&!o(A[c]))){if(c<A.length-1&&!(i(A[c])||g(A[c])||l(A[c])))throw new x(`streams[${c}]`,y[c],"must be readable");if(c>0&&!(s(A[c])||d(A[c])||l(A[c])))throw new x(`streams[${c}]`,y[c],"must be writable")}let R,p,T,$,H;function Y(c){const w=$;$=null,w?w(c):c?H.destroy(c):!u&&!b&&H.destroy()}const X=A[0],a=r(A,Y),b=!!(s(X)||d(X)||l(X)),u=!!(i(a)||g(a)||l(a));if(H=new e({writableObjectMode:!!(X!=null&&X.writableObjectMode),readableObjectMode:!!(a!=null&&a.readableObjectMode),writable:b,readable:u}),b){if(n(X))H._write=function(w,f,C){X.write(w,f)?C():R=C},H._final=function(w){X.end(),p=w},X.on("drain",function(){if(R){const w=R;R=null,w()}});else if(o(X)){const f=(l(X)?X.writable:X).getWriter();H._write=async function(C,h,v){try{await f.ready,f.write(C).catch(()=>{}),v()}catch(P){v(P)}},H._final=async function(C){try{await f.ready,f.close().catch(()=>{}),p=C}catch(h){C(h)}}}const c=l(a)?a.readable:a;k(c,()=>{if(p){const w=p;p=null,w()}})}if(u){if(n(a))a.on("readable",function(){if(T){const c=T;T=null,c()}}),a.on("end",function(){H.push(null)}),H._read=function(){for(;;){const c=a.read();if(c===null){T=H._read;return}if(!H.push(c))return}};else if(o(a)){const w=(l(a)?a.readable:a).getReader();H._read=async function(){for(;;)try{const{value:f,done:C}=await w.read();if(!H.push(f))return;if(C){H.push(null);return}}catch{return}}}}return H._destroy=function(c,w){!c&&$!==null&&(c=new N),T=null,R=null,p=null,$===null?w(c):($=w,n(a)&&t(a,c))},H},On}var Ji;function sa(){if(Ji)return mr;Ji=1;const r=globalThis.AbortController||er().AbortController,{codes:{ERR_INVALID_ARG_VALUE:e,ERR_INVALID_ARG_TYPE:t,ERR_MISSING_ARGS:n,ERR_OUT_OF_RANGE:i},AbortError:s}=Be(),{validateAbortSignal:o,validateInteger:l,validateObject:d}=nr(),g=Ie().Symbol("kWeak"),N=Ie().Symbol("kResistStopPropagation"),{finished:x}=mt(),E=Yo(),{addAbortSignalNoValidate:k}=Br(),{isWritable:U,isNodeStream:A}=ht(),{deprecate:y}=We(),{ArrayPrototypePush:R,Boolean:p,MathFloor:T,Number:$,NumberIsNaN:H,Promise:Y,PromiseReject:X,PromiseResolve:a,PromisePrototypeThen:b,Symbol:u}=Ie(),c=u("kEmpty"),w=u("kEof");function f(G,V){if(V!=null&&d(V,"options"),V?.signal!=null&&o(V.signal,"options.signal"),A(G)&&!U(G))throw new e("stream",G,"must be writable");const oe=E(this,G);return V!=null&&V.signal&&k(V.signal,oe),oe}function C(G,V){if(typeof G!="function")throw new t("fn",["Function","AsyncFunction"],G);V!=null&&d(V,"options"),V?.signal!=null&&o(V.signal,"options.signal");let oe=1;V?.concurrency!=null&&(oe=T(V.concurrency));let ce=oe-1;return V?.highWaterMark!=null&&(ce=T(V.highWaterMark)),l(oe,"options.concurrency",1),l(ce,"options.highWaterMark",0),ce+=oe,(async function*(){const L=We().AbortSignalAny([V?.signal].filter(p)),D=this,F=[],ne={signal:L};let se,ie,B=!1,Z=0;function re(){B=!0,J()}function J(){Z-=1,we()}function we(){ie&&!B&&Z<oe&&F.length<ce&&(ie(),ie=null)}async function Pe(){try{for await(let ye of D){if(B)return;if(L.aborted)throw new s;try{if(ye=G(ye,ne),ye===c)continue;ye=a(ye)}catch(De){ye=X(De)}Z+=1,b(ye,J,re),F.push(ye),se&&(se(),se=null),!B&&(F.length>=ce||Z>=oe)&&await new Y(De=>{ie=De})}F.push(w)}catch(ye){const De=X(ye);b(De,J,re),F.push(De)}finally{B=!0,se&&(se(),se=null)}}Pe();try{for(;;){for(;F.length>0;){const ye=await F[0];if(ye===w)return;if(L.aborted)throw new s;ye!==c&&(yield ye),F.shift(),we()}await new Y(ye=>{se=ye})}}finally{B=!0,ie&&(ie(),ie=null)}}).call(this)}function h(G=void 0){return G!=null&&d(G,"options"),G?.signal!=null&&o(G.signal,"options.signal"),(async function*(){let oe=0;for await(const fe of this){var ce;if(G!=null&&(ce=G.signal)!==null&&ce!==void 0&&ce.aborted)throw new s({cause:G.signal.reason});yield[oe++,fe]}}).call(this)}async function v(G,V=void 0){for await(const oe of m.call(this,G,V))return!0;return!1}async function P(G,V=void 0){if(typeof G!="function")throw new t("fn",["Function","AsyncFunction"],G);return!await v.call(this,async(...oe)=>!await G(...oe),V)}async function _(G,V){for await(const oe of m.call(this,G,V))return oe}async function M(G,V){if(typeof G!="function")throw new t("fn",["Function","AsyncFunction"],G);async function oe(ce,fe){return await G(ce,fe),c}for await(const ce of C.call(this,oe,V));}function m(G,V){if(typeof G!="function")throw new t("fn",["Function","AsyncFunction"],G);async function oe(ce,fe){return await G(ce,fe)?ce:c}return C.call(this,oe,V)}class j extends n{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function K(G,V,oe){var ce;if(typeof G!="function")throw new t("reducer",["Function","AsyncFunction"],G);oe!=null&&d(oe,"options"),oe?.signal!=null&&o(oe.signal,"options.signal");let fe=arguments.length>1;if(oe!=null&&(ce=oe.signal)!==null&&ce!==void 0&&ce.aborted){const se=new s(void 0,{cause:oe.signal.reason});throw this.once("error",()=>{}),await x(this.destroy(se)),se}const L=new r,D=L.signal;if(oe!=null&&oe.signal){const se={once:!0,[g]:this,[N]:!0};oe.signal.addEventListener("abort",()=>L.abort(),se)}let F=!1;try{for await(const se of this){var ne;if(F=!0,oe!=null&&(ne=oe.signal)!==null&&ne!==void 0&&ne.aborted)throw new s;fe?V=await G(V,se,{signal:D}):(V=se,fe=!0)}if(!F&&!fe)throw new j}finally{L.abort()}return V}async function W(G){G!=null&&d(G,"options"),G?.signal!=null&&o(G.signal,"options.signal");const V=[];for await(const ce of this){var oe;if(G!=null&&(oe=G.signal)!==null&&oe!==void 0&&oe.aborted)throw new s(void 0,{cause:G.signal.reason});R(V,ce)}return V}function ee(G,V){const oe=C.call(this,G,V);return(async function*(){for await(const fe of oe)yield*fe}).call(this)}function Q(G){if(G=$(G),H(G))return 0;if(G<0)throw new i("number",">= 0",G);return G}function le(G,V=void 0){return V!=null&&d(V,"options"),V?.signal!=null&&o(V.signal,"options.signal"),G=Q(G),(async function*(){var ce;if(V!=null&&(ce=V.signal)!==null&&ce!==void 0&&ce.aborted)throw new s;for await(const L of this){var fe;if(V!=null&&(fe=V.signal)!==null&&fe!==void 0&&fe.aborted)throw new s;G--<=0&&(yield L)}}).call(this)}function ue(G,V=void 0){return V!=null&&d(V,"options"),V?.signal!=null&&o(V.signal,"options.signal"),G=Q(G),(async function*(){var ce;if(V!=null&&(ce=V.signal)!==null&&ce!==void 0&&ce.aborted)throw new s;for await(const L of this){var fe;if(V!=null&&(fe=V.signal)!==null&&fe!==void 0&&fe.aborted)throw new s;if(G-- >0&&(yield L),G<=0)return}}).call(this)}return mr.streamReturningOperators={asIndexedPairs:y(h,"readable.asIndexedPairs will be removed in a future version."),drop:le,filter:m,flatMap:ee,map:C,take:ue,compose:f},mr.promiseReturningOperators={every:P,forEach:M,reduce:K,toArray:W,some:v,find:_},mr}var xn,Zi;function Jo(){if(Zi)return xn;Zi=1;const{ArrayPrototypePop:r,Promise:e}=Ie(),{isIterable:t,isNodeStream:n,isWebStream:i}=ht(),{pipelineImpl:s}=ii(),{finished:o}=mt();Zo();function l(...d){return new e((g,N)=>{let x,E;const k=d[d.length-1];if(k&&typeof k=="object"&&!n(k)&&!t(k)&&!i(k)){const U=r(d);x=U.signal,E=U.end}s(d,(U,A)=>{U?N(U):g(A)},{signal:x,end:E})})}return xn={finished:o,pipeline:l},xn}var Xi;function Zo(){if(Xi)return an.exports;Xi=1;const{Buffer:r}=Pt(),{ObjectDefineProperty:e,ObjectKeys:t,ReflectApply:n}=Ie(),{promisify:{custom:i}}=We(),{streamReturningOperators:s,promiseReturningOperators:o}=sa(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:l}}=Be(),d=Yo(),{setDefaultHighWaterMark:g,getDefaultHighWaterMark:N}=kr(),{pipeline:x}=ii(),{destroyer:E}=qt(),k=mt(),U=Jo(),A=ht(),y=an.exports=ri().Stream;y.isDestroyed=A.isDestroyed,y.isDisturbed=A.isDisturbed,y.isErrored=A.isErrored,y.isReadable=A.isReadable,y.isWritable=A.isWritable,y.Readable=Ur();for(const p of t(s)){let $=function(...H){if(new.target)throw l();return y.Readable.from(n(T,this,H))};const T=s[p];e($,"name",{__proto__:null,value:T.name}),e($,"length",{__proto__:null,value:T.length}),e(y.Readable.prototype,p,{__proto__:null,value:$,enumerable:!1,configurable:!0,writable:!0})}for(const p of t(o)){let $=function(...H){if(new.target)throw l();return n(T,this,H)};const T=o[p];e($,"name",{__proto__:null,value:T.name}),e($,"length",{__proto__:null,value:T.length}),e(y.Readable.prototype,p,{__proto__:null,value:$,enumerable:!1,configurable:!0,writable:!0})}y.Writable=ni(),y.Duplex=dt(),y.Transform=Vo(),y.PassThrough=Ko(),y.pipeline=x;const{addAbortSignal:R}=Br();return y.addAbortSignal=R,y.finished=k,y.destroy=E,y.compose=d,y.setDefaultHighWaterMark=g,y.getDefaultHighWaterMark=N,e(y,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return U}}),e(x,i,{__proto__:null,enumerable:!0,get(){return U.pipeline}}),e(k,i,{__proto__:null,enumerable:!0,get(){return U.finished}}),y.Stream=y,y._isUint8Array=function(T){return T instanceof Uint8Array},y._uint8ArrayToBuffer=function(T){return r.from(T.buffer,T.byteOffset,T.byteLength)},an.exports}var Qi;function aa(){return Qi||(Qi=1,(function(r){const e=Zo(),t=Jo(),n=e.Readable.destroy;r.exports=e.Readable,r.exports._uint8ArrayToBuffer=e._uint8ArrayToBuffer,r.exports._isUint8Array=e._isUint8Array,r.exports.isDisturbed=e.isDisturbed,r.exports.isErrored=e.isErrored,r.exports.isReadable=e.isReadable,r.exports.Readable=e.Readable,r.exports.Writable=e.Writable,r.exports.Duplex=e.Duplex,r.exports.Transform=e.Transform,r.exports.PassThrough=e.PassThrough,r.exports.addAbortSignal=e.addAbortSignal,r.exports.finished=e.finished,r.exports.destroy=e.destroy,r.exports.destroy=n,r.exports.pipeline=e.pipeline,r.exports.compose=e.compose,Object.defineProperty(e,"promises",{configurable:!0,enumerable:!0,get(){return t}}),r.exports.Stream=e.Stream,r.exports.default=r.exports})(sn)),sn.exports}var qr=aa(),Nn,eo;function Xo(){if(eo)return Nn;eo=1,Nn=s,s.default=s,s.stable=g,s.stableStringify=g;var r="[...]",e="[Circular]",t=[],n=[];function i(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function s(E,k,U,A){typeof A>"u"&&(A=i()),l(E,"",0,[],void 0,0,A);var y;try{n.length===0?y=JSON.stringify(E,k,U):y=JSON.stringify(E,x(k),U)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;t.length!==0;){var R=t.pop();R.length===4?Object.defineProperty(R[0],R[1],R[3]):R[0][R[1]]=R[2]}}return y}function o(E,k,U,A){var y=Object.getOwnPropertyDescriptor(A,U);y.get!==void 0?y.configurable?(Object.defineProperty(A,U,{value:E}),t.push([A,U,k,y])):n.push([k,U,E]):(A[U]=E,t.push([A,U,k]))}function l(E,k,U,A,y,R,p){R+=1;var T;if(typeof E=="object"&&E!==null){for(T=0;T<A.length;T++)if(A[T]===E){o(e,E,k,y);return}if(typeof p.depthLimit<"u"&&R>p.depthLimit){o(r,E,k,y);return}if(typeof p.edgesLimit<"u"&&U+1>p.edgesLimit){o(r,E,k,y);return}if(A.push(E),Array.isArray(E))for(T=0;T<E.length;T++)l(E[T],T,T,A,E,R,p);else{var $=Object.keys(E);for(T=0;T<$.length;T++){var H=$[T];l(E[H],H,T,A,E,R,p)}}A.pop()}}function d(E,k){return E<k?-1:E>k?1:0}function g(E,k,U,A){typeof A>"u"&&(A=i());var y=N(E,"",0,[],void 0,0,A)||E,R;try{n.length===0?R=JSON.stringify(y,k,U):R=JSON.stringify(y,x(k),U)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;t.length!==0;){var p=t.pop();p.length===4?Object.defineProperty(p[0],p[1],p[3]):p[0][p[1]]=p[2]}}return R}function N(E,k,U,A,y,R,p){R+=1;var T;if(typeof E=="object"&&E!==null){for(T=0;T<A.length;T++)if(A[T]===E){o(e,E,k,y);return}try{if(typeof E.toJSON=="function")return}catch{return}if(typeof p.depthLimit<"u"&&R>p.depthLimit){o(r,E,k,y);return}if(typeof p.edgesLimit<"u"&&U+1>p.edgesLimit){o(r,E,k,y);return}if(A.push(E),Array.isArray(E))for(T=0;T<E.length;T++)N(E[T],T,T,A,E,R,p);else{var $={},H=Object.keys(E).sort(d);for(T=0;T<H.length;T++){var Y=H[T];N(E[Y],Y,T,A,E,R,p),$[Y]=E[Y]}if(typeof y<"u")t.push([y,k,E]),y[k]=$;else return $}A.pop()}}function x(E){return E=typeof E<"u"?E:function(k,U){return U},function(k,U){if(n.length>0)for(var A=0;A<n.length;A++){var y=n[A];if(y[1]===k&&y[0]===U){U=y[2],n.splice(A,1);break}}return E.call(this,k,U)}}return Nn}var la=Xo();const ua=Ut(la);var vr={exports:{}},Cn,to;function fa(){if(to)return Cn;to=1,Cn=r;function r(e,t){if(e&&t)return r(e)(t);if(typeof e!="function")throw new TypeError("need wrapper function");return Object.keys(e).forEach(function(i){n[i]=e[i]}),n;function n(){for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];var o=e.apply(this,i),l=i[i.length-1];return typeof o=="function"&&o!==l&&Object.keys(l).forEach(function(d){o[d]=l[d]}),o}}return Cn}var ro;function oi(){if(ro)return vr.exports;ro=1;var r=fa();vr.exports=r(e),vr.exports.strict=r(t),e.proto=e(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return e(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return t(this)},configurable:!0})});function e(n){var i=function(){return i.called?i.value:(i.called=!0,i.value=n.apply(this,arguments))};return i.called=!1,i}function t(n){var i=function(){if(i.called)throw new Error(i.onceError);return i.called=!0,i.value=n.apply(this,arguments)},s=n.name||"Function wrapped with `once`";return i.onceError=s+" shouldn't be called more than once",i.called=!1,i}return vr.exports}var Pn,no;function Qo(){if(no)return Pn;no=1;var r=oi(),e=function(){},t=globalThis.Bare?queueMicrotask:Pr.nextTick.bind(Pr),n=function(o){return o.setHeader&&typeof o.abort=="function"},i=function(o){return o.stdio&&Array.isArray(o.stdio)&&o.stdio.length===3},s=function(o,l,d){if(typeof l=="function")return s(o,null,l);l||(l={}),d=r(d||e);var g=o._writableState,N=o._readableState,x=l.readable||l.readable!==!1&&o.readable,E=l.writable||l.writable!==!1&&o.writable,k=!1,U=function(){o.writable||A()},A=function(){E=!1,x||d.call(o)},y=function(){x=!1,E||d.call(o)},R=function(Y){d.call(o,Y?new Error("exited with error code: "+Y):null)},p=function(Y){d.call(o,Y)},T=function(){t($)},$=function(){if(!k){if(x&&!(N&&N.ended&&!N.destroyed))return d.call(o,new Error("premature close"));if(E&&!(g&&g.ended&&!g.destroyed))return d.call(o,new Error("premature close"))}},H=function(){o.req.on("finish",A)};return n(o)?(o.on("complete",A),o.on("abort",T),o.req?H():o.on("request",H)):E&&!g&&(o.on("end",U),o.on("close",U)),i(o)&&o.on("exit",R),o.on("end",y),o.on("finish",A),l.error!==!1&&o.on("error",p),o.on("close",T),function(){k=!0,o.removeListener("complete",A),o.removeListener("abort",T),o.removeListener("request",H),o.req&&o.req.removeListener("finish",A),o.removeListener("end",U),o.removeListener("close",U),o.removeListener("finish",A),o.removeListener("exit",R),o.removeListener("end",y),o.removeListener("error",p),o.removeListener("close",T)}};return Pn=s,Pn}var ca=Qo();const io=Ut(ca);var da=oi();const ha=Ut(da);var Ln,oo;function ga(){if(oo)return Ln;oo=1;var r=oi(),e=Qo(),t;try{t=ea}catch{}var n=function(){},i=typeof Pr>"u"?!1:/^v?\.0/.test(Pr.version),s=function(E){return typeof E=="function"},o=function(E){return!i||!t?!1:(E instanceof(t.ReadStream||n)||E instanceof(t.WriteStream||n))&&s(E.close)},l=function(E){return E.setHeader&&s(E.abort)},d=function(E,k,U,A){A=r(A);var y=!1;E.on("close",function(){y=!0}),e(E,{readable:k,writable:U},function(p){if(p)return A(p);y=!0,A()});var R=!1;return function(p){if(!y&&!R){if(R=!0,o(E))return E.close(n);if(l(E))return E.abort();if(s(E.destroy))return E.destroy();A(p||new Error("stream was destroyed"))}}},g=function(E){E()},N=function(E,k){return E.pipe(k)},x=function(){var E=Array.prototype.slice.call(arguments),k=s(E[E.length-1]||n)&&E.pop()||n;if(Array.isArray(E[0])&&(E=E[0]),E.length<2)throw new Error("pump requires two streams per minimum");var U,A=E.map(function(y,R){var p=R<E.length-1,T=R>0;return d(y,p,T,function($){U||(U=$),$&&A.forEach(g),!p&&(A.forEach(g),k(U))})});return E.reduce(N)};return Ln=x,Ln}var pa=ga();const so=Ut(pa);function Sr(){}const ao="SYN",Mn="ACK",lo="BRK";class uo extends qr.Duplex{constructor(e){let{name:t,target:n,targetWindow:i=window,targetOrigin:s="*"}=e;if(super({objectMode:!0}),ge(this,"_init",void 0),ge(this,"_haveSyn",void 0),ge(this,"_name",void 0),ge(this,"_target",void 0),ge(this,"_targetWindow",void 0),ge(this,"_targetOrigin",void 0),ge(this,"_onMessage",void 0),ge(this,"_synIntervalId",void 0),!t||!n)throw new Error("Invalid input.");this._init=!1,this._haveSyn=!1,this._name=t,this._target=n,this._targetWindow=i,this._targetOrigin=s,this._onMessage=this.onMessage.bind(this),this._synIntervalId=null,window.addEventListener("message",this._onMessage,!1),this._handShake()}_break(){this.cork(),this._write(lo,null,Sr),this._haveSyn=!1,this._init=!1}_handShake(){this._write(ao,null,Sr),this.cork()}_onData(e){if(!this._init)e===ao?(this._haveSyn=!0,this._write(Mn,null,Sr)):e===Mn&&(this._init=!0,this._haveSyn||this._write(Mn,null,Sr),this.uncork());else if(e===lo)this._break();else try{this.push(e)}catch(t){this.emit("error",t)}}_postMessage(e){const t=this._targetOrigin;this._targetWindow.postMessage({target:this._target,data:e},t)}onMessage(e){const t=e.data;this._targetOrigin!=="*"&&e.origin!==this._targetOrigin||e.source!==this._targetWindow||typeof t!="object"||t.target!==this._name||!t.data||this._onData(t.data)}_read(){}_write(e,t,n){this._postMessage(e),n()}_destroy(){window.removeEventListener("message",this._onMessage,!1)}}const wa={rpc:{internal:-32603}},fo={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}},co=wa.rpc.internal,ba="Unspecified error message. This is a bug, please report it.";function es(r){return Number.isInteger(r)}function ho(r){return typeof r=="string"&&r.length>0}function go(r){return!!r&&typeof r=="object"&&!Array.isArray(r)}function ts(r){const e=r;return!(!e||!es(e.code)||!ho(e.message)||e.stack&&!ho(e.stack))}function ya(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ba;if(es(r)){const t=r.toString();if(Object.hasOwn(fo,t))return fo[t].message}return e}const _a={code:co,message:ya(co)};function Kn(r){try{JSON.parse(JSON.stringify(r,(e,t)=>{if(e==="__proto__"||e==="constructor")throw new Error("Not valid json");if(typeof t=="function"||typeof t=="symbol")throw new Error("Not valid json");return t}),(e,t)=>{if(!(e==="__proto__"||e==="constructor"))return t})}catch{return!1}return!0}function po(r){return Object.getOwnPropertyNames(r).reduce((e,t)=>{const n=r[t];return Kn(n)&&(e[t]=n),e},{})}function ma(r){return Array.isArray(r)?r.map(e=>Kn(e)?e:go(e)?po(e):null):go(r)?po(r):Kn(r)?r:null}function Ea(r,e){if(r&&typeof r=="object"&&"serialize"in r&&typeof r.serialize=="function")return r.serialize();if(ts(r))return r;const t=ma(r);return Ke(Ke({},e),{},{data:{cause:t}})}function wo(r){let{fallbackError:e=_a,shouldIncludeStack:t=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!ts(e))throw new Error("Must provide fallback error with integer number code and string message.");const n=Ea(r,e);return t||delete n.stack,n}function bo(r,e,t){try{Reflect.apply(r,e,t)}catch(n){setTimeout(()=>{throw n})}}function va(r){const e=r.length,t=new Array(e);for(let n=0;n<e;n+=1)t[n]=r[n];return t}class jr extends ta.EventEmitter{emit(e){let t=e==="error";const n=this._events;if(n!==void 0)t=t&&n.error===void 0;else if(!t)return!1;for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if(t){let d;if(s.length>0&&([d]=s),d instanceof Error)throw d;const g=new Error(`Unhandled error.${d?` (${d.message})`:""}`);throw g.context=d,g}const l=n[e];if(l===void 0)return!1;if(typeof l=="function")bo(l,this,s);else{const d=l.length,g=va(l);for(let N=0;N<d;N+=1)bo(g[N],this,s)}return!0}}class Kt extends Error{constructor(e){let{code:t,message:n,data:i}=e;if(!Number.isInteger(t))throw new Error("code must be an integer");if(!n||typeof n!="string")throw new Error("message must be string");super(n),ge(this,"code",void 0),ge(this,"data",void 0),this.code=t,i!==void 0&&(this.data=i)}toString(){return ua({code:this.code,message:this.message,data:this.data,stack:this.stack})}}const Yn=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return(n,i)=>{n||i.error?e(n||i.error):!t||Array.isArray(i)?r(i):r(i.result)}};function Sa(){const r={};function e(){return!1}const t=new jr;function n(d){const g=r[d.id];if(!g)throw new Error(`StreamMiddleware - Unknown response id "${d.id}"`);delete r[d.id],Object.assign(g.res,d),setTimeout(g.end)}function i(d){t.emit("notification",d)}function s(d,g,N){let x;try{!d.id?i(d):n(d)}catch(E){x=E}N(x)}const o=new qr.Duplex({objectMode:!0,read:e,write:s});return{events:t,middleware:(d,g,N,x)=>{o.push(d),r[d.id]={req:d,res:g,next:N,end:x}},stream:o}}function Aa(){return(r,e,t,n)=>{const i=r.id,s=Math.random().toString(36).slice(2);r.id=s,e.id=s,t(o=>{r.id=i,e.id=i,o()})}}class ut extends jr{constructor(){super(),ge(this,"_middleware",void 0),this._middleware=[]}static async _runAllMiddleware(e,t,n){const i=[];let s=null,o=!1;for(const l of n)if([s,o]=await ut._runMiddleware(e,t,l,i),o)break;return[s,o,i.reverse()]}static _runMiddleware(e,t,n,i){return new Promise(s=>{const o=d=>{const g=d||t.error;g&&(typeof g=="object"&&Object.keys(g).includes("stack")===!1&&(g.stack="Stack trace is not available."),t.error=wo(g,{shouldIncludeStack:!0,fallbackError:{message:g?.message||g?.toString(),code:g?.code||-32603,stack:g?.stack||"Stack trace is not available.",data:g?.data||g?.message||g?.toString()}})),s([g,!0])},l=d=>{t.error?o(t.error):(d&&(typeof d!="function"&&o(new Kt({code:-32603,message:"JRPCEngine: 'next' return handlers must be functions"})),i.push(d)),s([null,!1]))};try{n(e,t,l,o)}catch(d){o(d)}})}static async _runReturnHandlers(e){for(const t of e)await new Promise((n,i)=>{t(s=>s?i(s):n())})}static _checkForCompletion(e,t,n){if(!("result"in t)&&!("error"in t))throw new Kt({code:-32603,message:"Response has no error or result for request"});if(!n)throw new Kt({code:-32603,message:"Nothing ended request"})}push(e){this._middleware.push(e)}handle(e,t){if(t&&typeof t!="function")throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?t?this._handleBatch(e,t):this._handleBatch(e):t?this._handle(e,t):this._promiseHandle(e)}asMiddleware(){return async(e,t,n,i)=>{try{const[s,o,l]=await ut._runAllMiddleware(e,t,this._middleware);return o?(await ut._runReturnHandlers(l),i(s)):n(async d=>{try{await ut._runReturnHandlers(l)}catch(g){return d(g)}return d()})}catch(s){return i(s)}}}async _handleBatch(e,t){try{const n=await Promise.all(e.map(this._promiseHandle.bind(this)));return t?t(null,n):n}catch(n){if(t)return t(n);throw n}}_promiseHandle(e){return new Promise((t,n)=>{this._handle(e,(i,s)=>{i&&s===void 0?n(i):t(s)}).catch(n)})}async _handle(e,t){if(!e||Array.isArray(e)||typeof e!="object"){const k=new Kt({code:-32603,message:"request must be plain object"});return t(k,{id:void 0,jsonrpc:"2.0",error:k})}if(typeof e.method!="string"){const k=new Kt({code:-32603,message:"method must be string"});return t(k,{id:e.id,jsonrpc:"2.0",error:k})}const n=Ke({},e),i={id:n.id,jsonrpc:n.jsonrpc};let s=null;try{await this._processRequest(n,i)}catch(k){s=k}if(s&&(delete i.result,!i.error)){var o,l,d,g,N,x,E;typeof s=="object"&&Object.keys(s).includes("stack")===!1&&(s.stack="Stack trace is not available."),i.error=wo(s,{shouldIncludeStack:!0,fallbackError:{message:((o=s)===null||o===void 0?void 0:o.message)||((l=s)===null||l===void 0?void 0:l.toString()),code:((d=s)===null||d===void 0?void 0:d.code)||-32603,stack:((g=s)===null||g===void 0?void 0:g.stack)||"Stack trace is not available.",data:((N=s)===null||N===void 0?void 0:N.data)||((x=s)===null||x===void 0?void 0:x.message)||((E=s)===null||E===void 0?void 0:E.toString())}})}return t(s,i)}async _processRequest(e,t){const[n,i,s]=await ut._runAllMiddleware(e,t,this._middleware);if(ut._checkForCompletion(e,t,i),await ut._runReturnHandlers(s),n)throw n}}class Ra extends qr.Duplex{constructor(e){let{parent:t,name:n}=e;super({objectMode:!0}),ge(this,"_parent",void 0),ge(this,"_name",void 0),this._parent=t,this._name=n}_read(){}_write(e,t,n){this._parent.push({name:this._name,data:e}),n()}}const yo=Symbol("IGNORE_SUBSTREAM");class Ia extends qr.Duplex{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(Ke(Ke({},e),{},{objectMode:!0})),ge(this,"_substreams",void 0),ge(this,"getStream",void 0),this._substreams={}}createStream(e){if(!e)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw new Error(`ObjectMultiplex - Substream for name "${e}" already exists`);const t=new Ra({parent:this,name:e});return this._substreams[e]=t,Ta(this,n=>t.destroy(n||void 0)),t}ignoreStream(e){if(!e)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw new Error(`ObjectMultiplex - Substream for name "${e}" already exists`);this._substreams[e]=yo}_read(){}_write(e,t,n){const{name:i,data:s}=e;if(!i)return window.console.warn(`ObjectMultiplex - malformed chunk without name "${e}"`),n();const o=this._substreams[i];return o?(o!==yo&&o.push(s),n()):(window.console.warn(`ObjectMultiplex - orphaned data for stream "${i}"`),n())}}function Ta(r,e){const t=ha(e);io(r,{readable:!1},t),io(r,{writable:!1},t)}var Jt={exports:{}};Jt.exports;var _o;function Oa(){return _o||(_o=1,(function(r,e){var t=200,n="__lodash_hash_undefined__",i=800,s=16,o=9007199254740991,l="[object Arguments]",d="[object Array]",g="[object AsyncFunction]",N="[object Boolean]",x="[object Date]",E="[object Error]",k="[object Function]",U="[object GeneratorFunction]",A="[object Map]",y="[object Number]",R="[object Null]",p="[object Object]",T="[object Proxy]",$="[object RegExp]",H="[object Set]",Y="[object String]",X="[object Undefined]",a="[object WeakMap]",b="[object ArrayBuffer]",u="[object DataView]",c="[object Float32Array]",w="[object Float64Array]",f="[object Int8Array]",C="[object Int16Array]",h="[object Int32Array]",v="[object Uint8Array]",P="[object Uint8ClampedArray]",_="[object Uint16Array]",M="[object Uint32Array]",m=/[\\^$.*+?()[\]{}|]/g,j=/^\[object .+?Constructor\]$/,K=/^(?:0|[1-9]\d*)$/,W={};W[c]=W[w]=W[f]=W[C]=W[h]=W[v]=W[P]=W[_]=W[M]=!0,W[l]=W[d]=W[b]=W[N]=W[u]=W[x]=W[E]=W[k]=W[A]=W[y]=W[p]=W[$]=W[H]=W[Y]=W[a]=!1;var ee=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,Q=typeof self=="object"&&self&&self.Object===Object&&self,le=ee||Q||Function("return this")(),ue=e&&!e.nodeType&&e,G=ue&&!0&&r&&!r.nodeType&&r,V=G&&G.exports===ue,oe=V&&ee.process,ce=(function(){try{var I=G&&G.require&&G.require("util").types;return I||oe&&oe.binding&&oe.binding("util")}catch{}})(),fe=ce&&ce.isTypedArray;function L(I,q,z){switch(z.length){case 0:return I.call(q);case 1:return I.call(q,z[0]);case 2:return I.call(q,z[0],z[1]);case 3:return I.call(q,z[0],z[1],z[2])}return I.apply(q,z)}function D(I,q){for(var z=-1,he=Array(I);++z<I;)he[z]=q(z);return he}function F(I){return function(q){return I(q)}}function ne(I,q){return I?.[q]}function se(I,q){return function(z){return I(q(z))}}var ie=Array.prototype,B=Function.prototype,Z=Object.prototype,re=le["__core-js_shared__"],J=B.toString,we=Z.hasOwnProperty,Pe=(function(){var I=/[^.]+$/.exec(re&&re.keys&&re.keys.IE_PROTO||"");return I?"Symbol(src)_1."+I:""})(),ye=Z.toString,De=J.call(Object),Oe=RegExp("^"+J.call(we).replace(m,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Le=V?le.Buffer:void 0,Ye=le.Symbol,Et=le.Uint8Array;Le&&Le.allocUnsafe;var Me=se(Object.getPrototypeOf,Object),ar=Object.create,zr=Z.propertyIsEnumerable,lr=ie.splice,it=Ye?Ye.toStringTag:void 0,Mt=(function(){try{var I=Zr(Object,"defineProperty");return I({},"",{}),I}catch{}})(),Gr=Le?Le.isBuffer:void 0,jt=Math.max,ur=Date.now,fr=Zr(le,"Map"),gt=Zr(Object,"create"),Wt=(function(){function I(){}return function(q){if(!St(q))return{};if(ar)return ar(q);I.prototype=q;var z=new I;return I.prototype=void 0,z}})();function ot(I){var q=-1,z=I==null?0:I.length;for(this.clear();++q<z;){var he=I[q];this.set(he[0],he[1])}}function Vr(){this.__data__=gt?gt(null):{},this.size=0}function Ft(I){var q=this.has(I)&&delete this.__data__[I];return this.size-=q?1:0,q}function cr(I){var q=this.__data__;if(gt){var z=q[I];return z===n?void 0:z}return we.call(q,I)?q[I]:void 0}function S(I){var q=this.__data__;return gt?q[I]!==void 0:we.call(q,I)}function O(I,q){var z=this.__data__;return this.size+=this.has(I)?0:1,z[I]=gt&&q===void 0?n:q,this}ot.prototype.clear=Vr,ot.prototype.delete=Ft,ot.prototype.get=cr,ot.prototype.has=S,ot.prototype.set=O;function te(I){var q=-1,z=I==null?0:I.length;for(this.clear();++q<z;){var he=I[q];this.set(he[0],he[1])}}function ae(){this.__data__=[],this.size=0}function de(I){var q=this.__data__,z=wr(q,I);if(z<0)return!1;var he=q.length-1;return z==he?q.pop():lr.call(q,z,1),--this.size,!0}function xe(I){var q=this.__data__,z=wr(q,I);return z<0?void 0:q[z][1]}function ke(I){return wr(this.__data__,I)>-1}function dr(I,q){var z=this.__data__,he=wr(z,I);return he<0?(++this.size,z.push([I,q])):z[he][1]=q,this}te.prototype.clear=ae,te.prototype.delete=de,te.prototype.get=xe,te.prototype.has=ke,te.prototype.set=dr;function Ue(I){var q=-1,z=I==null?0:I.length;for(this.clear();++q<z;){var he=I[q];this.set(he[0],he[1])}}function hr(){this.size=0,this.__data__={hash:new ot,map:new(fr||te),string:new ot}}function Kr(I){var q=yr(this,I).delete(I);return this.size-=q?1:0,q}function gr(I){return yr(this,I).get(I)}function pr(I){return yr(this,I).has(I)}function $t(I,q){var z=yr(this,I),he=z.size;return z.set(I,q),this.size+=z.size==he?0:1,this}Ue.prototype.clear=hr,Ue.prototype.delete=Kr,Ue.prototype.get=gr,Ue.prototype.has=pr,Ue.prototype.set=$t;function tt(I){var q=this.__data__=new te(I);this.size=q.size}function Ht(){this.__data__=new te,this.size=0}function vt(I){var q=this.__data__,z=q.delete(I);return this.size=q.size,z}function st(I){return this.__data__.get(I)}function Je(I){return this.__data__.has(I)}function _s(I,q){var z=this.__data__;if(z instanceof te){var he=z.__data__;if(!fr||he.length<t-1)return he.push([I,q]),this.size=++z.size,this;z=this.__data__=new Ue(he)}return z.set(I,q),this.size=z.size,this}tt.prototype.clear=Ht,tt.prototype.delete=vt,tt.prototype.get=st,tt.prototype.has=Je,tt.prototype.set=_s;function ms(I,q){var z=en(I),he=!z&&Qr(I),be=!z&&!he&&_i(I),me=!z&&!he&&!be&&Ei(I),Se=z||he||be||me,_e=Se?D(I.length,String):[],Ae=_e.length;for(var Ze in I)Se&&(Ze=="length"||be&&(Ze=="offset"||Ze=="parent")||me&&(Ze=="buffer"||Ze=="byteLength"||Ze=="byteOffset")||bi(Ze,Ae))||_e.push(Ze);return _e}function Yr(I,q,z){(z!==void 0&&!_r(I[q],z)||z===void 0&&!(q in I))&&Jr(I,q,z)}function Es(I,q,z){var he=I[q];(!(we.call(I,q)&&_r(he,z))||z===void 0&&!(q in I))&&Jr(I,q,z)}function wr(I,q){for(var z=I.length;z--;)if(_r(I[z][0],q))return z;return-1}function Jr(I,q,z){q=="__proto__"&&Mt?Mt(I,q,{configurable:!0,enumerable:!0,value:z,writable:!0}):I[q]=z}var vs=Ds();function br(I){return I==null?I===void 0?X:R:it&&it in Object(I)?Bs(I):Fs(I)}function pi(I){return zt(I)&&br(I)==l}function Ss(I){if(!St(I)||js(I))return!1;var q=rn(I)?Oe:j;return q.test(Gs(I))}function As(I){return zt(I)&&mi(I.length)&&!!W[br(I)]}function Rs(I){if(!St(I))return Ws(I);var q=yi(I),z=[];for(var he in I)he=="constructor"&&(q||!we.call(I,he))||z.push(he);return z}function wi(I,q,z,he,be){I!==q&&vs(q,function(me,Se){if(be||(be=new tt),St(me))Is(I,q,Se,z,wi,he,be);else{var _e=he?he(Xr(I,Se),me,Se+"",I,q,be):void 0;_e===void 0&&(_e=me),Yr(I,Se,_e)}},vi)}function Is(I,q,z,he,be,me,Se){var _e=Xr(I,z),Ae=Xr(q,z),Ze=Se.get(Ae);if(Ze){Yr(I,z,Ze);return}var Fe=me?me(_e,Ae,z+"",I,q,Se):void 0,Gt=Fe===void 0;if(Gt){var nn=en(Ae),on=!nn&&_i(Ae),Ai=!nn&&!on&&Ei(Ae);Fe=Ae,nn||on||Ai?en(_e)?Fe=_e:Vs(_e)?Fe=Ps(_e):on?(Gt=!1,Fe=xs(Ae)):Ai?(Gt=!1,Fe=Cs(Ae)):Fe=[]:Ks(Ae)||Qr(Ae)?(Fe=_e,Qr(_e)?Fe=Ys(_e):(!St(_e)||rn(_e))&&(Fe=ks(Ae))):Gt=!1}Gt&&(Se.set(Ae,Fe),be(Fe,Ae,he,me,Se),Se.delete(Ae)),Yr(I,z,Fe)}function Ts(I,q){return Hs($s(I,q,Si),I+"")}var Os=Mt?function(I,q){return Mt(I,"toString",{configurable:!0,enumerable:!1,value:Zs(q),writable:!0})}:Si;function xs(I,q){return I.slice()}function Ns(I){var q=new I.constructor(I.byteLength);return new Et(q).set(new Et(I)),q}function Cs(I,q){var z=Ns(I.buffer);return new I.constructor(z,I.byteOffset,I.length)}function Ps(I,q){var z=-1,he=I.length;for(q||(q=Array(he));++z<he;)q[z]=I[z];return q}function Ls(I,q,z,he){var be=!z;z||(z={});for(var me=-1,Se=q.length;++me<Se;){var _e=q[me],Ae=void 0;Ae===void 0&&(Ae=I[_e]),be?Jr(z,_e,Ae):Es(z,_e,Ae)}return z}function Ms(I){return Ts(function(q,z){var he=-1,be=z.length,me=be>1?z[be-1]:void 0,Se=be>2?z[2]:void 0;for(me=I.length>3&&typeof me=="function"?(be--,me):void 0,Se&&Us(z[0],z[1],Se)&&(me=be<3?void 0:me,be=1),q=Object(q);++he<be;){var _e=z[he];_e&&I(q,_e,he,me)}return q})}function Ds(I){return function(q,z,he){for(var be=-1,me=Object(q),Se=he(q),_e=Se.length;_e--;){var Ae=Se[++be];if(z(me[Ae],Ae,me)===!1)break}return q}}function yr(I,q){var z=I.__data__;return qs(q)?z[typeof q=="string"?"string":"hash"]:z.map}function Zr(I,q){var z=ne(I,q);return Ss(z)?z:void 0}function Bs(I){var q=we.call(I,it),z=I[it];try{I[it]=void 0;var he=!0}catch{}var be=ye.call(I);return he&&(q?I[it]=z:delete I[it]),be}function ks(I){return typeof I.constructor=="function"&&!yi(I)?Wt(Me(I)):{}}function bi(I,q){var z=typeof I;return q=q??o,!!q&&(z=="number"||z!="symbol"&&K.test(I))&&I>-1&&I%1==0&&I<q}function Us(I,q,z){if(!St(z))return!1;var he=typeof q;return(he=="number"?tn(z)&&bi(q,z.length):he=="string"&&q in z)?_r(z[q],I):!1}function qs(I){var q=typeof I;return q=="string"||q=="number"||q=="symbol"||q=="boolean"?I!=="__proto__":I===null}function js(I){return!!Pe&&Pe in I}function yi(I){var q=I&&I.constructor,z=typeof q=="function"&&q.prototype||Z;return I===z}function Ws(I){var q=[];if(I!=null)for(var z in Object(I))q.push(z);return q}function Fs(I){return ye.call(I)}function $s(I,q,z){return q=jt(q===void 0?I.length-1:q,0),function(){for(var he=arguments,be=-1,me=jt(he.length-q,0),Se=Array(me);++be<me;)Se[be]=he[q+be];be=-1;for(var _e=Array(q+1);++be<q;)_e[be]=he[be];return _e[q]=z(Se),L(I,this,_e)}}function Xr(I,q){if(!(q==="constructor"&&typeof I[q]=="function")&&q!="__proto__")return I[q]}var Hs=zs(Os);function zs(I){var q=0,z=0;return function(){var he=ur(),be=s-(he-z);if(z=he,be>0){if(++q>=i)return arguments[0]}else q=0;return I.apply(void 0,arguments)}}function Gs(I){if(I!=null){try{return J.call(I)}catch{}try{return I+""}catch{}}return""}function _r(I,q){return I===q||I!==I&&q!==q}var Qr=pi((function(){return arguments})())?pi:function(I){return zt(I)&&we.call(I,"callee")&&!zr.call(I,"callee")},en=Array.isArray;function tn(I){return I!=null&&mi(I.length)&&!rn(I)}function Vs(I){return zt(I)&&tn(I)}var _i=Gr||Xs;function rn(I){if(!St(I))return!1;var q=br(I);return q==k||q==U||q==g||q==T}function mi(I){return typeof I=="number"&&I>-1&&I%1==0&&I<=o}function St(I){var q=typeof I;return I!=null&&(q=="object"||q=="function")}function zt(I){return I!=null&&typeof I=="object"}function Ks(I){if(!zt(I)||br(I)!=p)return!1;var q=Me(I);if(q===null)return!0;var z=we.call(q,"constructor")&&q.constructor;return typeof z=="function"&&z instanceof z&&J.call(z)==De}var Ei=fe?F(fe):As;function Ys(I){return Ls(I,vi(I))}function vi(I){return tn(I)?ms(I):Rs(I)}var Js=Ms(function(I,q,z){wi(I,q,z)});function Zs(I){return function(){return I}}function Si(I){return I}function Xs(){return!1}r.exports=Js})(Jt,Jt.exports)),Jt.exports}Oa();var Cr={exports:{}},xa=Cr.exports,mo;function Na(){return mo||(mo=1,(function(r){(function(e,t){r.exports?r.exports=t():e.log=t()})(xa,function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],s={},o=null;function l(A,y){var R=A[y];if(typeof R.bind=="function")return R.bind(A);try{return Function.prototype.bind.call(R,A)}catch{return function(){return Function.prototype.apply.apply(R,[A,arguments])}}}function d(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function g(A){return A==="debug"&&(A="log"),typeof console===t?!1:A==="trace"&&n?d:console[A]!==void 0?l(console,A):console.log!==void 0?l(console,"log"):e}function N(){for(var A=this.getLevel(),y=0;y<i.length;y++){var R=i[y];this[R]=y<A?e:this.methodFactory(R,A,this.name)}if(this.log=this.debug,typeof console===t&&A<this.levels.SILENT)return"No console available for logging"}function x(A){return function(){typeof console!==t&&(N.call(this),this[A].apply(this,arguments))}}function E(A,y,R){return g(A)||x.apply(this,arguments)}function k(A,y){var R=this,p,T,$,H="loglevel";typeof A=="string"?H+=":"+A:typeof A=="symbol"&&(H=void 0);function Y(c){var w=(i[c]||"silent").toUpperCase();if(!(typeof window===t||!H)){try{window.localStorage[H]=w;return}catch{}try{window.document.cookie=encodeURIComponent(H)+"="+w+";"}catch{}}}function X(){var c;if(!(typeof window===t||!H)){try{c=window.localStorage[H]}catch{}if(typeof c===t)try{var w=window.document.cookie,f=encodeURIComponent(H),C=w.indexOf(f+"=");C!==-1&&(c=/^([^;]+)/.exec(w.slice(C+f.length+1))[1])}catch{}return R.levels[c]===void 0&&(c=void 0),c}}function a(){if(!(typeof window===t||!H)){try{window.localStorage.removeItem(H)}catch{}try{window.document.cookie=encodeURIComponent(H)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function b(c){var w=c;if(typeof w=="string"&&R.levels[w.toUpperCase()]!==void 0&&(w=R.levels[w.toUpperCase()]),typeof w=="number"&&w>=0&&w<=R.levels.SILENT)return w;throw new TypeError("log.setLevel() called with invalid level: "+c)}R.name=A,R.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},R.methodFactory=y||E,R.getLevel=function(){return $??T??p},R.setLevel=function(c,w){return $=b(c),w!==!1&&Y($),N.call(R)},R.setDefaultLevel=function(c){T=b(c),X()||R.setLevel(c,!1)},R.resetLevel=function(){$=null,a(),N.call(R)},R.enableAll=function(c){R.setLevel(R.levels.TRACE,c)},R.disableAll=function(c){R.setLevel(R.levels.SILENT,c)},R.rebuild=function(){if(o!==R&&(p=b(o.getLevel())),N.call(R),o===R)for(var c in s)s[c].rebuild()},p=b(o?o.getLevel():"WARN");var u=X();u!=null&&($=b(u)),N.call(R)}o=new k,o.getLogger=function(y){if(typeof y!="symbol"&&typeof y!="string"||y==="")throw new TypeError("You must supply a name when creating a logger.");var R=s[y];return R||(R=s[y]=new k(y,o.methodFactory)),R};var U=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=U),o},o.getLoggers=function(){return s},o.default=o,o})})(Cr)),Cr.exports}var rs=Na();const Lr=Ut(rs),Ca=Lr.getLogger("http-helpers");Ca.setLevel(rs.levels.INFO);function Eo(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`positive integer expected, not ${r}`)}function Pa(r){return r instanceof Uint8Array||r!=null&&typeof r=="object"&&r.constructor.name==="Uint8Array"}function Wr(r,...e){if(!Pa(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${r.length}`)}function La(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Eo(r.outputLen),Eo(r.blockLen)}function Mr(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function Ma(r,e){Wr(r);const t=e.outputLen;if(r.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const Dn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const Bn=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),rt=(r,e)=>r<<32-e|r>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Da(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function si(r){return typeof r=="string"&&(r=Da(r)),Wr(r),r}function Ba(...r){let e=0;for(let n=0;n<r.length;n++){const i=r[n];Wr(i),e+=i.length}const t=new Uint8Array(e);for(let n=0,i=0;n<r.length;n++){const s=r[n];t.set(s,i),i+=s.length}return t}class ns{clone(){return this._cloneInto()}}function ka(r){const e=n=>r().update(si(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Ua(r=32){if(Dn&&typeof Dn.getRandomValues=="function")return Dn.getRandomValues(new Uint8Array(r));throw new Error("crypto.getRandomValues must be defined")}function qa(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(t>>i&s),l=Number(t&s),d=n?4:0,g=n?0:4;r.setUint32(e+d,o,n),r.setUint32(e+g,l,n)}const ja=(r,e,t)=>r&e^~r&t,Wa=(r,e,t)=>r&e^r&t^e&t;class Fa extends ns{constructor(e,t,n,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Bn(this.buffer)}update(e){Mr(this);const{view:t,buffer:n,blockLen:i}=this;e=si(e);const s=e.length;for(let o=0;o<s;){const l=Math.min(i-this.pos,s-o);if(l===i){const d=Bn(e);for(;i<=s-o;o+=i)this.process(d,o);continue}n.set(e.subarray(o,o+l),this.pos),this.pos+=l,o+=l,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Mr(this),Ma(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let x=o;x<i;x++)t[x]=0;qa(n,i-8,BigInt(this.length*8),s),this.process(n,0);const l=Bn(e),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const g=d/4,N=this.get();if(g>N.length)throw new Error("_sha2: outputLen bigger than state");for(let x=0;x<g;x++)l.setUint32(4*x,N[x],s)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:i,finished:s,destroyed:o,pos:l}=this;return e.length=i,e.pos=l,e.finished=s,e.destroyed=o,i%t&&e.buffer.set(n),e}}const $a=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),pt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),wt=new Uint32Array(64);class Ha extends Fa{constructor(){super(64,32,8,!1),this.A=pt[0]|0,this.B=pt[1]|0,this.C=pt[2]|0,this.D=pt[3]|0,this.E=pt[4]|0,this.F=pt[5]|0,this.G=pt[6]|0,this.H=pt[7]|0}get(){const{A:e,B:t,C:n,D:i,E:s,F:o,G:l,H:d}=this;return[e,t,n,i,s,o,l,d]}set(e,t,n,i,s,o,l,d){this.A=e|0,this.B=t|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=l|0,this.H=d|0}process(e,t){for(let x=0;x<16;x++,t+=4)wt[x]=e.getUint32(t,!1);for(let x=16;x<64;x++){const E=wt[x-15],k=wt[x-2],U=rt(E,7)^rt(E,18)^E>>>3,A=rt(k,17)^rt(k,19)^k>>>10;wt[x]=A+wt[x-7]+U+wt[x-16]|0}let{A:n,B:i,C:s,D:o,E:l,F:d,G:g,H:N}=this;for(let x=0;x<64;x++){const E=rt(l,6)^rt(l,11)^rt(l,25),k=N+E+ja(l,d,g)+$a[x]+wt[x]|0,A=(rt(n,2)^rt(n,13)^rt(n,22))+Wa(n,i,s)|0;N=g,g=d,d=l,l=o+k|0,o=s,s=i,i=n,n=k+A|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,l=l+this.E|0,d=d+this.F|0,g=g+this.G|0,N=N+this.H|0,this.set(n,i,s,o,l,d,g,N)}roundClean(){wt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const za=ka(()=>new Ha);class is extends ns{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,La(e);const n=si(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return Mr(this),this.iHash.update(e),this}digestInto(e){Mr(this),Wr(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:l}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=l,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const os=(r,e,t)=>new is(r,e).update(t).digest();os.create=(r,e)=>new is(r,e);const Ga=BigInt(1),Va=BigInt(2);function Nt(r){return r instanceof Uint8Array||r!=null&&typeof r=="object"&&r.constructor.name==="Uint8Array"}function ir(r){if(!Nt(r))throw new Error("Uint8Array expected")}const Ka=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Bt(r){ir(r);let e="";for(let t=0;t<r.length;t++)e+=Ka[r[t]];return e}function ai(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return BigInt(r===""?"0":`0x${r}`)}const at={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function vo(r){if(r>=at._0&&r<=at._9)return r-at._0;if(r>=at._A&&r<=at._F)return r-(at._A-10);if(r>=at._a&&r<=at._f)return r-(at._a-10)}function tr(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let i=0,s=0;i<t;i++,s+=2){const o=vo(r.charCodeAt(s)),l=vo(r.charCodeAt(s+1));if(o===void 0||l===void 0){const d=r[s]+r[s+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+s)}n[i]=o*16+l}return n}function xt(r){return ai(Bt(r))}function li(r){return ir(r),ai(Bt(Uint8Array.from(r).reverse()))}function kt(r,e){return tr(r.toString(16).padStart(e*2,"0"))}function ui(r,e){return kt(r,e).reverse()}function Qe(r,e,t){let n;if(typeof e=="string")try{n=tr(e)}catch(s){throw new Error(`${r} must be valid hex string, got "${e}". Cause: ${s}`)}else if(Nt(e))n=Uint8Array.from(e);else throw new Error(`${r} must be hex string or Uint8Array`);const i=n.length;if(typeof t=="number"&&i!==t)throw new Error(`${r} expected ${t} bytes, got ${i}`);return n}function rr(...r){let e=0;for(let n=0;n<r.length;n++){const i=r[n];ir(i),e+=i.length}const t=new Uint8Array(e);for(let n=0,i=0;n<r.length;n++){const s=r[n];t.set(s,i),i+=s.length}return t}const fi=r=>(Va<<BigInt(r-1))-Ga,kn=r=>new Uint8Array(r),So=r=>Uint8Array.from(r);function ss(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=kn(r),i=kn(r),s=0;const o=()=>{n.fill(1),i.fill(0),s=0},l=(...x)=>t(i,n,...x),d=(x=kn())=>{i=l(So([0]),x),n=l(),x.length!==0&&(i=l(So([1]),x),n=l())},g=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let x=0;const E=[];for(;x<e;){n=l();const k=n.slice();E.push(k),x+=n.length}return rr(...E)};return(x,E)=>{o(),d(x);let k;for(;!(k=E(g()));)d();return o(),k}}const Ya={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Nt(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function or(r,e,t={}){const n=(i,s,o)=>{const l=Ya[s];if(typeof l!="function")throw new Error(`Invalid validator "${s}", expected function`);const d=r[i];if(!(o&&d===void 0)&&!l(d,r))throw new Error(`Invalid param ${String(i)}=${d} (${typeof d}), expected ${s}`)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(t))n(i,s,!0);return r}const Ja=Object.freeze(Object.defineProperty({__proto__:null,abytes:ir,bitMask:fi,bytesToHex:Bt,bytesToNumberBE:xt,bytesToNumberLE:li,concatBytes:rr,createHmacDrbg:ss,ensureBytes:Qe,hexToBytes:tr,hexToNumber:ai,isBytes:Nt,numberToBytesBE:kt,numberToBytesLE:ui,validateObject:or},Symbol.toStringTag,{value:"Module"}));const Ce=BigInt(0),Te=BigInt(1),Tt=BigInt(2),Za=BigInt(3),Jn=BigInt(4),Ao=BigInt(5),Ro=BigInt(8);BigInt(9);BigInt(16);function je(r,e){const t=r%e;return t>=Ce?t:e+t}function Xa(r,e,t){if(t<=Ce||e<Ce)throw new Error("Expected power/modulo > 0");if(t===Te)return Ce;let n=Te;for(;e>Ce;)e&Te&&(n=n*r%t),r=r*r%t,e>>=Te;return n}function $e(r,e,t){let n=r;for(;e-- >Ce;)n*=n,n%=t;return n}function Zn(r,e){if(r===Ce||e<=Ce)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=je(r,e),n=e,i=Ce,s=Te;for(;t!==Ce;){const l=n/t,d=n%t,g=i-s*l;n=t,t=d,i=s,s=g}if(n!==Te)throw new Error("invert: does not exist");return je(i,e)}function Qa(r){const e=(r-Te)/Tt;let t,n,i;for(t=r-Te,n=0;t%Tt===Ce;t/=Tt,n++);for(i=Tt;i<r&&Xa(i,e,r)!==r-Te;i++);if(n===1){const o=(r+Te)/Jn;return function(d,g){const N=d.pow(g,o);if(!d.eql(d.sqr(N),g))throw new Error("Cannot find square root");return N}}const s=(t+Te)/Tt;return function(l,d){if(l.pow(d,e)===l.neg(l.ONE))throw new Error("Cannot find square root");let g=n,N=l.pow(l.mul(l.ONE,i),t),x=l.pow(d,s),E=l.pow(d,t);for(;!l.eql(E,l.ONE);){if(l.eql(E,l.ZERO))return l.ZERO;let k=1;for(let A=l.sqr(E);k<g&&!l.eql(A,l.ONE);k++)A=l.sqr(A);const U=l.pow(N,Te<<BigInt(g-k-1));N=l.sqr(U),x=l.mul(x,U),E=l.mul(E,N),g=k}return x}}function el(r){if(r%Jn===Za){const e=(r+Te)/Jn;return function(n,i){const s=n.pow(i,e);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(r%Ro===Ao){const e=(r-Ao)/Ro;return function(n,i){const s=n.mul(i,Tt),o=n.pow(s,e),l=n.mul(i,o),d=n.mul(n.mul(l,Tt),o),g=n.mul(l,n.sub(d,n.ONE));if(!n.eql(n.sqr(g),i))throw new Error("Cannot find square root");return g}}return Qa(r)}const tl=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function rl(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=tl.reduce((n,i)=>(n[i]="function",n),e);return or(r,t)}function nl(r,e,t){if(t<Ce)throw new Error("Expected power > 0");if(t===Ce)return r.ONE;if(t===Te)return e;let n=r.ONE,i=e;for(;t>Ce;)t&Te&&(n=r.mul(n,i)),i=r.sqr(i),t>>=Te;return n}function il(r,e){const t=new Array(e.length),n=e.reduce((s,o,l)=>r.is0(o)?s:(t[l]=s,r.mul(s,o)),r.ONE),i=r.inv(n);return e.reduceRight((s,o,l)=>r.is0(o)?s:(t[l]=r.mul(s,t[l]),r.mul(s,o)),i),t}function as(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function ol(r,e,t=!1,n={}){if(r<=Ce)throw new Error(`Expected Field ORDER > 0, got ${r}`);const{nBitLength:i,nByteLength:s}=as(r,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=el(r),l=Object.freeze({ORDER:r,BITS:i,BYTES:s,MASK:fi(i),ZERO:Ce,ONE:Te,create:d=>je(d,r),isValid:d=>{if(typeof d!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof d}`);return Ce<=d&&d<r},is0:d=>d===Ce,isOdd:d=>(d&Te)===Te,neg:d=>je(-d,r),eql:(d,g)=>d===g,sqr:d=>je(d*d,r),add:(d,g)=>je(d+g,r),sub:(d,g)=>je(d-g,r),mul:(d,g)=>je(d*g,r),pow:(d,g)=>nl(l,d,g),div:(d,g)=>je(d*Zn(g,r),r),sqrN:d=>d*d,addN:(d,g)=>d+g,subN:(d,g)=>d-g,mulN:(d,g)=>d*g,inv:d=>Zn(d,r),sqrt:n.sqrt||(d=>o(l,d)),invertBatch:d=>il(l,d),cmov:(d,g,N)=>N?g:d,toBytes:d=>t?ui(d,s):kt(d,s),fromBytes:d=>{if(d.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${d.length}`);return t?li(d):xt(d)}});return Object.freeze(l)}function ls(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function us(r){const e=ls(r);return e+Math.ceil(e/2)}function sl(r,e,t=!1){const n=r.length,i=ls(e),s=us(e);if(n<16||n<s||n>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${n}`);const o=t?xt(r):li(r),l=je(o,e-Te)+Te;return t?ui(l,i):kt(l,i)}const al=BigInt(0),Un=BigInt(1);function ll(r,e){const t=(i,s)=>{const o=s.negate();return i?o:s},n=i=>{const s=Math.ceil(e/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:t,unsafeLadder(i,s){let o=r.ZERO,l=i;for(;s>al;)s&Un&&(o=o.add(l)),l=l.double(),s>>=Un;return o},precomputeWindow(i,s){const{windows:o,windowSize:l}=n(s),d=[];let g=i,N=g;for(let x=0;x<o;x++){N=g,d.push(N);for(let E=1;E<l;E++)N=N.add(g),d.push(N);g=N.double()}return d},wNAF(i,s,o){const{windows:l,windowSize:d}=n(i);let g=r.ZERO,N=r.BASE;const x=BigInt(2**i-1),E=2**i,k=BigInt(i);for(let U=0;U<l;U++){const A=U*d;let y=Number(o&x);o>>=k,y>d&&(y-=E,o+=Un);const R=A,p=A+Math.abs(y)-1,T=U%2!==0,$=y<0;y===0?N=N.add(t(T,s[R])):g=g.add(t($,s[p]))}return{p:g,f:N}},wNAFCached(i,s,o,l){const d=i._WINDOW_SIZE||1;let g=s.get(i);return g||(g=this.precomputeWindow(i,d),d!==1&&s.set(i,l(g))),this.wNAF(d,g,o)}}}function fs(r){return rl(r.Fp),or(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...as(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}function ul(r){const e=fs(r);or(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:i}=e;if(t){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:fl,hexToBytes:cl}=Ja,Ot={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(r){const{Err:e}=Ot;if(r.length<2||r[0]!==2)throw new e("Invalid signature integer tag");const t=r[1],n=r.subarray(2,t+2);if(!t||n.length!==t)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:fl(n),l:r.subarray(t+2)}},toSig(r){const{Err:e}=Ot,t=typeof r=="string"?cl(r):r;ir(t);let n=t.length;if(n<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:i,l:s}=Ot._parseInt(t.subarray(2)),{d:o,l}=Ot._parseInt(s);if(l.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(r){const e=g=>Number.parseInt(g[0],16)&8?"00"+g:g,t=g=>{const N=g.toString(16);return N.length&1?`0${N}`:N},n=e(t(r.s)),i=e(t(r.r)),s=n.length/2,o=i.length/2,l=t(s),d=t(o);return`30${t(o+s+4)}02${d}${i}02${l}${n}`}},ft=BigInt(0),Ve=BigInt(1);BigInt(2);const Io=BigInt(3);BigInt(4);function dl(r){const e=ul(r),{Fp:t}=e,n=e.toBytes||((U,A,y)=>{const R=A.toAffine();return rr(Uint8Array.from([4]),t.toBytes(R.x),t.toBytes(R.y))}),i=e.fromBytes||(U=>{const A=U.subarray(1),y=t.fromBytes(A.subarray(0,t.BYTES)),R=t.fromBytes(A.subarray(t.BYTES,2*t.BYTES));return{x:y,y:R}});function s(U){const{a:A,b:y}=e,R=t.sqr(U),p=t.mul(R,U);return t.add(t.add(p,t.mul(U,A)),y)}if(!t.eql(t.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function o(U){return typeof U=="bigint"&&ft<U&&U<e.n}function l(U){if(!o(U))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function d(U){const{allowedPrivateKeyLengths:A,nByteLength:y,wrapPrivateKey:R,n:p}=e;if(A&&typeof U!="bigint"){if(Nt(U)&&(U=Bt(U)),typeof U!="string"||!A.includes(U.length))throw new Error("Invalid key");U=U.padStart(y*2,"0")}let T;try{T=typeof U=="bigint"?U:xt(Qe("private key",U,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof U}`)}return R&&(T=je(T,p)),l(T),T}const g=new Map;function N(U){if(!(U instanceof x))throw new Error("ProjectivePoint expected")}class x{constructor(A,y,R){if(this.px=A,this.py=y,this.pz=R,A==null||!t.isValid(A))throw new Error("x required");if(y==null||!t.isValid(y))throw new Error("y required");if(R==null||!t.isValid(R))throw new Error("z required")}static fromAffine(A){const{x:y,y:R}=A||{};if(!A||!t.isValid(y)||!t.isValid(R))throw new Error("invalid affine point");if(A instanceof x)throw new Error("projective point not allowed");const p=T=>t.eql(T,t.ZERO);return p(y)&&p(R)?x.ZERO:new x(y,R,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(A){const y=t.invertBatch(A.map(R=>R.pz));return A.map((R,p)=>R.toAffine(y[p])).map(x.fromAffine)}static fromHex(A){const y=x.fromAffine(i(Qe("pointHex",A)));return y.assertValidity(),y}static fromPrivateKey(A){return x.BASE.multiply(d(A))}_setWindowSize(A){this._WINDOW_SIZE=A,g.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:A,y}=this.toAffine();if(!t.isValid(A)||!t.isValid(y))throw new Error("bad point: x or y not FE");const R=t.sqr(y),p=s(A);if(!t.eql(R,p))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:A}=this.toAffine();if(t.isOdd)return!t.isOdd(A);throw new Error("Field doesn't support isOdd")}equals(A){N(A);const{px:y,py:R,pz:p}=this,{px:T,py:$,pz:H}=A,Y=t.eql(t.mul(y,H),t.mul(T,p)),X=t.eql(t.mul(R,H),t.mul($,p));return Y&&X}negate(){return new x(this.px,t.neg(this.py),this.pz)}double(){const{a:A,b:y}=e,R=t.mul(y,Io),{px:p,py:T,pz:$}=this;let H=t.ZERO,Y=t.ZERO,X=t.ZERO,a=t.mul(p,p),b=t.mul(T,T),u=t.mul($,$),c=t.mul(p,T);return c=t.add(c,c),X=t.mul(p,$),X=t.add(X,X),H=t.mul(A,X),Y=t.mul(R,u),Y=t.add(H,Y),H=t.sub(b,Y),Y=t.add(b,Y),Y=t.mul(H,Y),H=t.mul(c,H),X=t.mul(R,X),u=t.mul(A,u),c=t.sub(a,u),c=t.mul(A,c),c=t.add(c,X),X=t.add(a,a),a=t.add(X,a),a=t.add(a,u),a=t.mul(a,c),Y=t.add(Y,a),u=t.mul(T,$),u=t.add(u,u),a=t.mul(u,c),H=t.sub(H,a),X=t.mul(u,b),X=t.add(X,X),X=t.add(X,X),new x(H,Y,X)}add(A){N(A);const{px:y,py:R,pz:p}=this,{px:T,py:$,pz:H}=A;let Y=t.ZERO,X=t.ZERO,a=t.ZERO;const b=e.a,u=t.mul(e.b,Io);let c=t.mul(y,T),w=t.mul(R,$),f=t.mul(p,H),C=t.add(y,R),h=t.add(T,$);C=t.mul(C,h),h=t.add(c,w),C=t.sub(C,h),h=t.add(y,p);let v=t.add(T,H);return h=t.mul(h,v),v=t.add(c,f),h=t.sub(h,v),v=t.add(R,p),Y=t.add($,H),v=t.mul(v,Y),Y=t.add(w,f),v=t.sub(v,Y),a=t.mul(b,h),Y=t.mul(u,f),a=t.add(Y,a),Y=t.sub(w,a),a=t.add(w,a),X=t.mul(Y,a),w=t.add(c,c),w=t.add(w,c),f=t.mul(b,f),h=t.mul(u,h),w=t.add(w,f),f=t.sub(c,f),f=t.mul(b,f),h=t.add(h,f),c=t.mul(w,h),X=t.add(X,c),c=t.mul(v,h),Y=t.mul(C,Y),Y=t.sub(Y,c),c=t.mul(C,w),a=t.mul(v,a),a=t.add(a,c),new x(Y,X,a)}subtract(A){return this.add(A.negate())}is0(){return this.equals(x.ZERO)}wNAF(A){return k.wNAFCached(this,g,A,y=>{const R=t.invertBatch(y.map(p=>p.pz));return y.map((p,T)=>p.toAffine(R[T])).map(x.fromAffine)})}multiplyUnsafe(A){const y=x.ZERO;if(A===ft)return y;if(l(A),A===Ve)return this;const{endo:R}=e;if(!R)return k.unsafeLadder(this,A);let{k1neg:p,k1:T,k2neg:$,k2:H}=R.splitScalar(A),Y=y,X=y,a=this;for(;T>ft||H>ft;)T&Ve&&(Y=Y.add(a)),H&Ve&&(X=X.add(a)),a=a.double(),T>>=Ve,H>>=Ve;return p&&(Y=Y.negate()),$&&(X=X.negate()),X=new x(t.mul(X.px,R.beta),X.py,X.pz),Y.add(X)}multiply(A){l(A);let y=A,R,p;const{endo:T}=e;if(T){const{k1neg:$,k1:H,k2neg:Y,k2:X}=T.splitScalar(y);let{p:a,f:b}=this.wNAF(H),{p:u,f:c}=this.wNAF(X);a=k.constTimeNegate($,a),u=k.constTimeNegate(Y,u),u=new x(t.mul(u.px,T.beta),u.py,u.pz),R=a.add(u),p=b.add(c)}else{const{p:$,f:H}=this.wNAF(y);R=$,p=H}return x.normalizeZ([R,p])[0]}multiplyAndAddUnsafe(A,y,R){const p=x.BASE,T=(H,Y)=>Y===ft||Y===Ve||!H.equals(p)?H.multiplyUnsafe(Y):H.multiply(Y),$=T(this,y).add(T(A,R));return $.is0()?void 0:$}toAffine(A){const{px:y,py:R,pz:p}=this,T=this.is0();A==null&&(A=T?t.ONE:t.inv(p));const $=t.mul(y,A),H=t.mul(R,A),Y=t.mul(p,A);if(T)return{x:t.ZERO,y:t.ZERO};if(!t.eql(Y,t.ONE))throw new Error("invZ was invalid");return{x:$,y:H}}isTorsionFree(){const{h:A,isTorsionFree:y}=e;if(A===Ve)return!0;if(y)return y(x,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:A,clearCofactor:y}=e;return A===Ve?this:y?y(x,this):this.multiplyUnsafe(e.h)}toRawBytes(A=!0){return this.assertValidity(),n(x,this,A)}toHex(A=!0){return Bt(this.toRawBytes(A))}}x.BASE=new x(e.Gx,e.Gy,t.ONE),x.ZERO=new x(t.ZERO,t.ONE,t.ZERO);const E=e.nBitLength,k=ll(x,e.endo?Math.ceil(E/2):E);return{CURVE:e,ProjectivePoint:x,normPrivateKeyToScalar:d,weierstrassEquation:s,isWithinCurveOrder:o}}function hl(r){const e=fs(r);return or(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function gl(r){const e=hl(r),{Fp:t,n}=e,i=t.BYTES+1,s=2*t.BYTES+1;function o(h){return ft<h&&h<t.ORDER}function l(h){return je(h,n)}function d(h){return Zn(h,n)}const{ProjectivePoint:g,normPrivateKeyToScalar:N,weierstrassEquation:x,isWithinCurveOrder:E}=dl({...e,toBytes(h,v,P){const _=v.toAffine(),M=t.toBytes(_.x),m=rr;return P?m(Uint8Array.from([v.hasEvenY()?2:3]),M):m(Uint8Array.from([4]),M,t.toBytes(_.y))},fromBytes(h){const v=h.length,P=h[0],_=h.subarray(1);if(v===i&&(P===2||P===3)){const M=xt(_);if(!o(M))throw new Error("Point is not on curve");const m=x(M);let j;try{j=t.sqrt(m)}catch(ee){const Q=ee instanceof Error?": "+ee.message:"";throw new Error("Point is not on curve"+Q)}const K=(j&Ve)===Ve;return(P&1)===1!==K&&(j=t.neg(j)),{x:M,y:j}}else if(v===s&&P===4){const M=t.fromBytes(_.subarray(0,t.BYTES)),m=t.fromBytes(_.subarray(t.BYTES,2*t.BYTES));return{x:M,y:m}}else throw new Error(`Point of length ${v} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),k=h=>Bt(kt(h,e.nByteLength));function U(h){const v=n>>Ve;return h>v}function A(h){return U(h)?l(-h):h}const y=(h,v,P)=>xt(h.slice(v,P));class R{constructor(v,P,_){this.r=v,this.s=P,this.recovery=_,this.assertValidity()}static fromCompact(v){const P=e.nByteLength;return v=Qe("compactSignature",v,P*2),new R(y(v,0,P),y(v,P,2*P))}static fromDER(v){const{r:P,s:_}=Ot.toSig(Qe("DER",v));return new R(P,_)}assertValidity(){if(!E(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!E(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(v){return new R(this.r,this.s,v)}recoverPublicKey(v){const{r:P,s:_,recovery:M}=this,m=X(Qe("msgHash",v));if(M==null||![0,1,2,3].includes(M))throw new Error("recovery id invalid");const j=M===2||M===3?P+e.n:P;if(j>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const K=(M&1)===0?"02":"03",W=g.fromHex(K+k(j)),ee=d(j),Q=l(-m*ee),le=l(_*ee),ue=g.BASE.multiplyAndAddUnsafe(W,Q,le);if(!ue)throw new Error("point at infinify");return ue.assertValidity(),ue}hasHighS(){return U(this.s)}normalizeS(){return this.hasHighS()?new R(this.r,l(-this.s),this.recovery):this}toDERRawBytes(){return tr(this.toDERHex())}toDERHex(){return Ot.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return tr(this.toCompactHex())}toCompactHex(){return k(this.r)+k(this.s)}}const p={isValidPrivateKey(h){try{return N(h),!0}catch{return!1}},normPrivateKeyToScalar:N,randomPrivateKey:()=>{const h=us(e.n);return sl(e.randomBytes(h),e.n)},precompute(h=8,v=g.BASE){return v._setWindowSize(h),v.multiply(BigInt(3)),v}};function T(h,v=!0){return g.fromPrivateKey(h).toRawBytes(v)}function $(h){const v=Nt(h),P=typeof h=="string",_=(v||P)&&h.length;return v?_===i||_===s:P?_===2*i||_===2*s:h instanceof g}function H(h,v,P=!0){if($(h))throw new Error("first arg must be private key");if(!$(v))throw new Error("second arg must be public key");return g.fromHex(v).multiply(N(h)).toRawBytes(P)}const Y=e.bits2int||function(h){const v=xt(h),P=h.length*8-e.nBitLength;return P>0?v>>BigInt(P):v},X=e.bits2int_modN||function(h){return l(Y(h))},a=fi(e.nBitLength);function b(h){if(typeof h!="bigint")throw new Error("bigint expected");if(!(ft<=h&&h<a))throw new Error(`bigint expected < 2^${e.nBitLength}`);return kt(h,e.nByteLength)}function u(h,v,P=c){if(["recovered","canonical"].some(V=>V in P))throw new Error("sign() legacy options not supported");const{hash:_,randomBytes:M}=e;let{lowS:m,prehash:j,extraEntropy:K}=P;m==null&&(m=!0),h=Qe("msgHash",h),j&&(h=Qe("prehashed msgHash",_(h)));const W=X(h),ee=N(v),Q=[b(ee),b(W)];if(K!=null&&K!==!1){const V=K===!0?M(t.BYTES):K;Q.push(Qe("extraEntropy",V))}const le=rr(...Q),ue=W;function G(V){const oe=Y(V);if(!E(oe))return;const ce=d(oe),fe=g.BASE.multiply(oe).toAffine(),L=l(fe.x);if(L===ft)return;const D=l(ce*l(ue+L*ee));if(D===ft)return;let F=(fe.x===L?0:2)|Number(fe.y&Ve),ne=D;return m&&U(D)&&(ne=A(D),F^=1),new R(L,ne,F)}return{seed:le,k2sig:G}}const c={lowS:e.lowS,prehash:!1},w={lowS:e.lowS,prehash:!1};function f(h,v,P=c){const{seed:_,k2sig:M}=u(h,v,P),m=e;return ss(m.hash.outputLen,m.nByteLength,m.hmac)(_,M)}g.BASE._setWindowSize(8);function C(h,v,P,_=w){const M=h;if(v=Qe("msgHash",v),P=Qe("publicKey",P),"strict"in _)throw new Error("options.strict was renamed to lowS");const{lowS:m,prehash:j}=_;let K,W;try{if(typeof M=="string"||Nt(M))try{K=R.fromDER(M)}catch(fe){if(!(fe instanceof Ot.Err))throw fe;K=R.fromCompact(M)}else if(typeof M=="object"&&typeof M.r=="bigint"&&typeof M.s=="bigint"){const{r:fe,s:L}=M;K=new R(fe,L)}else throw new Error("PARSE");W=g.fromHex(P)}catch(fe){if(fe.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(m&&K.hasHighS())return!1;j&&(v=e.hash(v));const{r:ee,s:Q}=K,le=X(v),ue=d(Q),G=l(le*ue),V=l(ee*ue),oe=g.BASE.multiplyAndAddUnsafe(W,G,V)?.toAffine();return oe?l(oe.x)===ee:!1}return{CURVE:e,getPublicKey:T,getSharedSecret:H,sign:f,verify:C,ProjectivePoint:g,Signature:R,utils:p}}function pl(r){return{hash:r,hmac:(e,...t)=>os(r,e,Ba(...t)),randomBytes:Ua}}function wl(r,e){const t=n=>gl({...r,...pl(n)});return Object.freeze({...t(e),create:t})}const cs=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),To=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),bl=BigInt(1),Xn=BigInt(2),Oo=(r,e)=>(r+e/Xn)/e;function yl(r){const e=cs,t=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),l=BigInt(44),d=BigInt(88),g=r*r*r%e,N=g*g*r%e,x=$e(N,t,e)*N%e,E=$e(x,t,e)*N%e,k=$e(E,Xn,e)*g%e,U=$e(k,i,e)*k%e,A=$e(U,s,e)*U%e,y=$e(A,l,e)*A%e,R=$e(y,d,e)*y%e,p=$e(R,l,e)*A%e,T=$e(p,t,e)*N%e,$=$e(T,o,e)*U%e,H=$e($,n,e)*g%e,Y=$e(H,Xn,e);if(!Qn.eql(Qn.sqr(Y),r))throw new Error("Cannot find square root");return Y}const Qn=ol(cs,void 0,void 0,{sqrt:yl}),ci=wl({a:BigInt(0),b:BigInt(7),Fp:Qn,n:To,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{const e=To,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-bl*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=t,o=BigInt("0x100000000000000000000000000000000"),l=Oo(s*r,e),d=Oo(-n*r,e);let g=je(r-l*t-d*i,e),N=je(-l*n-d*s,e);const x=g>o,E=N>o;if(x&&(g=e-g),E&&(N=e-N),g>o||N>o)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:x,k1:g,k2neg:E,k2:N}}}},za);BigInt(0);ci.ProjectivePoint;function _l(r){let e=r;if(typeof e!="string")throw new Error(`[padToEven] value must be type 'string', received ${typeof e}`);return e.length%2&&(e=`0${e}`),e}BigInt(0);const ei={},ti={};for(let r=0;r<16;r++){const e=r,t=r*16,n=r.toString(16).toLowerCase();ti[n]=e,ti[n.toUpperCase()]=e,ei[n]=t,ei[n.toUpperCase()]=t}function ml(r){const e=r.length,t=new Uint8Array(e/2);for(let n=0;n<e;n+=2)t[n/2]=ei[r[n]]+ti[r[n+1]];return t}Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));for(let r=0;r<=256*256-1;r++)BigInt(r);const Fr=r=>{if(typeof r!="string")throw new Error(`hex argument type ${typeof r} must be of type string`);if(!/^0x[0-9a-fA-F]*$/.test(r))throw new Error(`Input must be a 0x-prefixed hexadecimal string, got ${r}`);const e=r.slice(2);return ml(e.length%2===0?e:_l(e))},El=r=>{if(!Number.isSafeInteger(r)||r<0)throw new Error(`Received an invalid integer type: ${r}`);return`0x${r.toString(16)}`},sr=r=>{const e=El(r);return Fr(e)};BigInt("0xffffffffffffffff");BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");BigInt("115792089237316195423570985008687907853269984665640564039457584007913129639935");ci.CURVE.n;ci.CURVE.n/BigInt(2);BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");const vl="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";Fr(vl);const Sl="0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347";Fr(Sl);const Al="0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421";Fr(Al);Uint8Array.from([128]);BigInt(-1);BigInt(0);BigInt(1);BigInt(2);BigInt(3);BigInt(7);BigInt(8);BigInt(27);BigInt(28);BigInt(31);BigInt(32);BigInt(64);BigInt(128);BigInt(255);BigInt(256);BigInt(96);BigInt(100);BigInt(160);BigInt(224);BigInt(7922816251426434e13);BigInt(1461501637330903e33);BigInt(2695994666715064e52);BigInt(1e9);Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));var xo;(function(r){r.String="string",r.Bytes="view",r.Number="number"})(xo||(xo={}));var No;(function(r){r.String="string",r.Bytes="view",r.JSON="json"})(No||(No={}));var Co;(function(r){r[r.Number=0]="Number",r[r.BigInt=1]="BigInt",r[r.Uint8Array=2]="Uint8Array",r[r.PrefixedHexString=3]="PrefixedHexString"})(Co||(Co={}));var Po;(function(r){r[r.Deposit=0]="Deposit",r[r.Withdrawal=1]="Withdrawal",r[r.Consolidation=2]="Consolidation"})(Po||(Po={}));var Ct;(function(r){r[r.Version=0]="Version",r[r.Balance=1]="Balance",r[r.Nonce=2]="Nonce",r[r.CodeHash=3]="CodeHash",r[r.CodeSize=4]="CodeSize"})(Ct||(Ct={}));sr(Ct.Version);sr(Ct.Balance);sr(Ct.Nonce);sr(Ct.CodeHash);sr(Ct.CodeSize);BigInt(256)**BigInt(31);var qn={exports:{}},Ar={},Rr={},Lo;function Rl(){if(Lo)return Rr;Lo=1,Object.defineProperty(Rr,"__esModule",{value:!0});function r(e){var t=4,n=e.length,i=n%t;if(!i)return e;var s=n,o=t-i,l=n+o,d=et.alloc(l);for(d.write(e);o--;)d.write("=",s++);return d.toString()}return Rr.default=r,Rr}var Mo;function Il(){if(Mo)return Ar;Mo=1,Object.defineProperty(Ar,"__esModule",{value:!0});var r=Rl();function e(l,d){return d===void 0&&(d="utf8"),et.isBuffer(l)?i(l.toString("base64")):i(et.from(l,d).toString("base64"))}function t(l,d){return d===void 0&&(d="utf8"),et.from(n(l),"base64").toString(d)}function n(l){return l=l.toString(),r.default(l).replace(/\-/g,"+").replace(/_/g,"/")}function i(l){return l.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function s(l){return et.from(n(l),"base64")}var o=e;return o.encode=e,o.decode=t,o.toBase64=n,o.fromBase64=i,o.toBuffer=s,Ar.default=o,Ar}var Do;function Tl(){return Do||(Do=1,(function(r){r.exports=Il().default,r.exports.default=r.exports})(qn)),qn.exports}Tl();const ve={MAINNET:"mainnet",TESTNET:"testnet",CYAN:"cyan",AQUA:"aqua",CELESTE:"celeste"},yt={SAPPHIRE_DEVNET:"sapphire_devnet",SAPPHIRE_MAINNET:"sapphire_mainnet"};ve.MAINNET+"",ve.TESTNET+"",ve.CYAN+"",ve.AQUA+"",ve.CELESTE+"";ve.AQUA+"",yt.SAPPHIRE_MAINNET,ve.CELESTE+"",yt.SAPPHIRE_MAINNET,ve.CYAN+"",yt.SAPPHIRE_MAINNET,ve.MAINNET+"",yt.SAPPHIRE_MAINNET,ve.TESTNET+"",yt.SAPPHIRE_DEVNET;ve.MAINNET+"",ve.TESTNET+"",ve.CYAN+"",ve.AQUA+"",ve.CELESTE+"";yt.SAPPHIRE_MAINNET+"",yt.SAPPHIRE_DEVNET+"",ve.MAINNET+"",ve.TESTNET+"",ve.CYAN+"",ve.AQUA+"",ve.CELESTE+"";ve.MAINNET+"",ve.TESTNET+"",ve.CYAN+"",ve.AQUA+"",ve.CELESTE+"";function Bo(r){let e=!1,t=0,n;try{n=window[r],e=!0,t=n.length;const i="__storage_test__";return n.setItem(i,i),n.removeItem(i),!0}catch(i){const s=i;return s&&(s.code===22||s.code===1014||s.name==="QuotaExceededError"||s.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&t!==0}}class Ol{constructor(){ge(this,"store",new Map)}getItem(e){return this.store.get(e)||null}setItem(e,t){this.store.set(e,t)}removeItem(e){this.store.delete(e)}}class xl{constructor(e,t){ge(this,"storage",void 0),ge(this,"_storeKey",void 0),this.storage=t,this._storeKey=e;try{t.getItem(e)||this.resetStore()}catch{}}static getInstance(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"local";if(!this.instanceMap.has(e)){let n;t==="local"&&Bo("localStorage")?n=window.localStorage:t==="session"&&Bo("sessionStorage")?n=window.sessionStorage:n=new Ol,this.instanceMap.set(e,new this(e,n))}return this.instanceMap.get(e)}toJSON(){return this.storage.getItem(this._storeKey)}resetStore(){const e=this.getStore();return this.storage.removeItem(this._storeKey),e}getStore(){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")}get(e){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")[e]}set(e,t){const n=JSON.parse(this.storage.getItem(this._storeKey)||"{}");n[e]=t,this.storage.setItem(this._storeKey,JSON.stringify(n))}}ge(xl,"instanceMap",new Map);Ke(Ke({},yt),ve);var Nl=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,jn=Math.ceil,ze=Math.floor,qe="[BigNumber Error] ",ko=qe+"Number primitive has more than 15 significant digits: ",Xe=1e14,pe=14,Wn=9007199254740991,Fn=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],bt=1e7,Ne=1e9;function ds(r){var e,t,n,i=p.prototype={constructor:p,toString:null,valueOf:null},s=new p(1),o=20,l=4,d=-7,g=21,N=-1e7,x=1e7,E=!1,k=1,U=0,A={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},y="0123456789abcdefghijklmnopqrstuvwxyz",R=!0;function p(a,b){var u,c,w,f,C,h,v,P,_=this;if(!(_ instanceof p))return new p(a,b);if(b==null){if(a&&a._isBigNumber===!0){_.s=a.s,!a.c||a.e>x?_.c=_.e=null:a.e<N?_.c=[_.e=0]:(_.e=a.e,_.c=a.c.slice());return}if((h=typeof a=="number")&&a*0==0){if(_.s=1/a<0?(a=-a,-1):1,a===~~a){for(f=0,C=a;C>=10;C/=10,f++);f>x?_.c=_.e=null:(_.e=f,_.c=[a]);return}P=String(a)}else{if(!Nl.test(P=String(a)))return n(_,P,h);_.s=P.charCodeAt(0)==45?(P=P.slice(1),-1):1}(f=P.indexOf("."))>-1&&(P=P.replace(".","")),(C=P.search(/e/i))>0?(f<0&&(f=C),f+=+P.slice(C+1),P=P.substring(0,C)):f<0&&(f=P.length)}else{if(Re(b,2,y.length,"Base"),b==10&&R)return _=new p(a),Y(_,o+_.e+1,l);if(P=String(a),h=typeof a=="number"){if(a*0!=0)return n(_,P,h,b);if(_.s=1/a<0?(P=P.slice(1),-1):1,p.DEBUG&&P.replace(/^0\.0*|\./,"").length>15)throw Error(ko+a)}else _.s=P.charCodeAt(0)===45?(P=P.slice(1),-1):1;for(u=y.slice(0,b),f=C=0,v=P.length;C<v;C++)if(u.indexOf(c=P.charAt(C))<0){if(c=="."){if(C>f){f=v;continue}}else if(!w&&(P==P.toUpperCase()&&(P=P.toLowerCase())||P==P.toLowerCase()&&(P=P.toUpperCase()))){w=!0,C=-1,f=0;continue}return n(_,String(a),h,b)}h=!1,P=t(P,b,10,_.s),(f=P.indexOf("."))>-1?P=P.replace(".",""):f=P.length}for(C=0;P.charCodeAt(C)===48;C++);for(v=P.length;P.charCodeAt(--v)===48;);if(P=P.slice(C,++v)){if(v-=C,h&&p.DEBUG&&v>15&&(a>Wn||a!==ze(a)))throw Error(ko+_.s*a);if((f=f-C-1)>x)_.c=_.e=null;else if(f<N)_.c=[_.e=0];else{if(_.e=f,_.c=[],C=(f+1)%pe,f<0&&(C+=pe),C<v){for(C&&_.c.push(+P.slice(0,C)),v-=pe;C<v;)_.c.push(+P.slice(C,C+=pe));C=pe-(P=P.slice(C)).length}else C-=v;for(;C--;P+="0");_.c.push(+P)}}else _.c=[_.e=0]}p.clone=ds,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(a){var b,u;if(a!=null)if(typeof a=="object"){if(a.hasOwnProperty(b="DECIMAL_PLACES")&&(u=a[b],Re(u,0,Ne,b),o=u),a.hasOwnProperty(b="ROUNDING_MODE")&&(u=a[b],Re(u,0,8,b),l=u),a.hasOwnProperty(b="EXPONENTIAL_AT")&&(u=a[b],u&&u.pop?(Re(u[0],-Ne,0,b),Re(u[1],0,Ne,b),d=u[0],g=u[1]):(Re(u,-Ne,Ne,b),d=-(g=u<0?-u:u))),a.hasOwnProperty(b="RANGE"))if(u=a[b],u&&u.pop)Re(u[0],-Ne,-1,b),Re(u[1],1,Ne,b),N=u[0],x=u[1];else if(Re(u,-Ne,Ne,b),u)N=-(x=u<0?-u:u);else throw Error(qe+b+" cannot be zero: "+u);if(a.hasOwnProperty(b="CRYPTO"))if(u=a[b],u===!!u)if(u)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))E=u;else throw E=!u,Error(qe+"crypto unavailable");else E=u;else throw Error(qe+b+" not true or false: "+u);if(a.hasOwnProperty(b="MODULO_MODE")&&(u=a[b],Re(u,0,9,b),k=u),a.hasOwnProperty(b="POW_PRECISION")&&(u=a[b],Re(u,0,Ne,b),U=u),a.hasOwnProperty(b="FORMAT"))if(u=a[b],typeof u=="object")A=u;else throw Error(qe+b+" not an object: "+u);if(a.hasOwnProperty(b="ALPHABET"))if(u=a[b],typeof u=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(u))R=u.slice(0,10)=="0123456789",y=u;else throw Error(qe+b+" invalid: "+u)}else throw Error(qe+"Object expected: "+a);return{DECIMAL_PLACES:o,ROUNDING_MODE:l,EXPONENTIAL_AT:[d,g],RANGE:[N,x],CRYPTO:E,MODULO_MODE:k,POW_PRECISION:U,FORMAT:A,ALPHABET:y}},p.isBigNumber=function(a){if(!a||a._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var b,u,c=a.c,w=a.e,f=a.s;e:if({}.toString.call(c)=="[object Array]"){if((f===1||f===-1)&&w>=-Ne&&w<=Ne&&w===ze(w)){if(c[0]===0){if(w===0&&c.length===1)return!0;break e}if(b=(w+1)%pe,b<1&&(b+=pe),String(c[0]).length==b){for(b=0;b<c.length;b++)if(u=c[b],u<0||u>=Xe||u!==ze(u))break e;if(u!==0)return!0}}}else if(c===null&&w===null&&(f===null||f===1||f===-1))return!0;throw Error(qe+"Invalid BigNumber: "+a)},p.maximum=p.max=function(){return $(arguments,-1)},p.minimum=p.min=function(){return $(arguments,1)},p.random=(function(){var a=9007199254740992,b=Math.random()*a&2097151?function(){return ze(Math.random()*a)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(u){var c,w,f,C,h,v=0,P=[],_=new p(s);if(u==null?u=o:Re(u,0,Ne),C=jn(u/pe),E)if(crypto.getRandomValues){for(c=crypto.getRandomValues(new Uint32Array(C*=2));v<C;)h=c[v]*131072+(c[v+1]>>>11),h>=9e15?(w=crypto.getRandomValues(new Uint32Array(2)),c[v]=w[0],c[v+1]=w[1]):(P.push(h%1e14),v+=2);v=C/2}else if(crypto.randomBytes){for(c=crypto.randomBytes(C*=7);v<C;)h=(c[v]&31)*281474976710656+c[v+1]*1099511627776+c[v+2]*4294967296+c[v+3]*16777216+(c[v+4]<<16)+(c[v+5]<<8)+c[v+6],h>=9e15?crypto.randomBytes(7).copy(c,v):(P.push(h%1e14),v+=7);v=C/7}else throw E=!1,Error(qe+"crypto unavailable");if(!E)for(;v<C;)h=b(),h<9e15&&(P[v++]=h%1e14);for(C=P[--v],u%=pe,C&&u&&(h=Fn[pe-u],P[v]=ze(C/h)*h);P[v]===0;P.pop(),v--);if(v<0)P=[f=0];else{for(f=-1;P[0]===0;P.splice(0,1),f-=pe);for(v=1,h=P[0];h>=10;h/=10,v++);v<pe&&(f-=pe-v)}return _.e=f,_.c=P,_}})(),p.sum=function(){for(var a=1,b=arguments,u=new p(b[0]);a<b.length;)u=u.plus(b[a++]);return u},t=(function(){var a="0123456789";function b(u,c,w,f){for(var C,h=[0],v,P=0,_=u.length;P<_;){for(v=h.length;v--;h[v]*=c);for(h[0]+=f.indexOf(u.charAt(P++)),C=0;C<h.length;C++)h[C]>w-1&&(h[C+1]==null&&(h[C+1]=0),h[C+1]+=h[C]/w|0,h[C]%=w)}return h.reverse()}return function(u,c,w,f,C){var h,v,P,_,M,m,j,K,W=u.indexOf("."),ee=o,Q=l;for(W>=0&&(_=U,U=0,u=u.replace(".",""),K=new p(c),m=K.pow(u.length-W),U=_,K.c=b(lt(He(m.c),m.e,"0"),10,w,a),K.e=K.c.length),j=b(u,c,w,C?(h=y,a):(h=a,y)),P=_=j.length;j[--_]==0;j.pop());if(!j[0])return h.charAt(0);if(W<0?--P:(m.c=j,m.e=P,m.s=f,m=e(m,K,ee,Q,w),j=m.c,M=m.r,P=m.e),v=P+ee+1,W=j[v],_=w/2,M=M||v<0||j[v+1]!=null,M=Q<4?(W!=null||M)&&(Q==0||Q==(m.s<0?3:2)):W>_||W==_&&(Q==4||M||Q==6&&j[v-1]&1||Q==(m.s<0?8:7)),v<1||!j[0])u=M?lt(h.charAt(1),-ee,h.charAt(0)):h.charAt(0);else{if(j.length=v,M)for(--w;++j[--v]>w;)j[v]=0,v||(++P,j=[1].concat(j));for(_=j.length;!j[--_];);for(W=0,u="";W<=_;u+=h.charAt(j[W++]));u=lt(u,P,h.charAt(0))}return u}})(),e=(function(){function a(c,w,f){var C,h,v,P,_=0,M=c.length,m=w%bt,j=w/bt|0;for(c=c.slice();M--;)v=c[M]%bt,P=c[M]/bt|0,C=j*v+P*m,h=m*v+C%bt*bt+_,_=(h/f|0)+(C/bt|0)+j*P,c[M]=h%f;return _&&(c=[_].concat(c)),c}function b(c,w,f,C){var h,v;if(f!=C)v=f>C?1:-1;else for(h=v=0;h<f;h++)if(c[h]!=w[h]){v=c[h]>w[h]?1:-1;break}return v}function u(c,w,f,C){for(var h=0;f--;)c[f]-=h,h=c[f]<w[f]?1:0,c[f]=h*C+c[f]-w[f];for(;!c[0]&&c.length>1;c.splice(0,1));}return function(c,w,f,C,h){var v,P,_,M,m,j,K,W,ee,Q,le,ue,G,V,oe,ce,fe,L=c.s==w.s?1:-1,D=c.c,F=w.c;if(!D||!D[0]||!F||!F[0])return new p(!c.s||!w.s||(D?F&&D[0]==F[0]:!F)?NaN:D&&D[0]==0||!F?L*0:L/0);for(W=new p(L),ee=W.c=[],P=c.e-w.e,L=f+P+1,h||(h=Xe,P=Ge(c.e/pe)-Ge(w.e/pe),L=L/pe|0),_=0;F[_]==(D[_]||0);_++);if(F[_]>(D[_]||0)&&P--,L<0)ee.push(1),M=!0;else{for(V=D.length,ce=F.length,_=0,L+=2,m=ze(h/(F[0]+1)),m>1&&(F=a(F,m,h),D=a(D,m,h),ce=F.length,V=D.length),G=ce,Q=D.slice(0,ce),le=Q.length;le<ce;Q[le++]=0);fe=F.slice(),fe=[0].concat(fe),oe=F[0],F[1]>=h/2&&oe++;do{if(m=0,v=b(F,Q,ce,le),v<0){if(ue=Q[0],ce!=le&&(ue=ue*h+(Q[1]||0)),m=ze(ue/oe),m>1)for(m>=h&&(m=h-1),j=a(F,m,h),K=j.length,le=Q.length;b(j,Q,K,le)==1;)m--,u(j,ce<K?fe:F,K,h),K=j.length,v=1;else m==0&&(v=m=1),j=F.slice(),K=j.length;if(K<le&&(j=[0].concat(j)),u(Q,j,le,h),le=Q.length,v==-1)for(;b(F,Q,ce,le)<1;)m++,u(Q,ce<le?fe:F,le,h),le=Q.length}else v===0&&(m++,Q=[0]);ee[_++]=m,Q[0]?Q[le++]=D[G]||0:(Q=[D[G]],le=1)}while((G++<V||Q[0]!=null)&&L--);M=Q[0]!=null,ee[0]||ee.splice(0,1)}if(h==Xe){for(_=1,L=ee[0];L>=10;L/=10,_++);Y(W,f+(W.e=_+P*pe-1)+1,C,M)}else W.e=P,W.r=+M;return W}})();function T(a,b,u,c){var w,f,C,h,v;if(u==null?u=l:Re(u,0,8),!a.c)return a.toString();if(w=a.c[0],C=a.e,b==null)v=He(a.c),v=c==1||c==2&&(C<=d||C>=g)?Tr(v,C):lt(v,C,"0");else if(a=Y(new p(a),b,u),f=a.e,v=He(a.c),h=v.length,c==1||c==2&&(b<=f||f<=d)){for(;h<b;v+="0",h++);v=Tr(v,f)}else if(b-=C+(c===2&&f>C),v=lt(v,f,"0"),f+1>h){if(--b>0)for(v+=".";b--;v+="0");}else if(b+=f-h,b>0)for(f+1==h&&(v+=".");b--;v+="0");return a.s<0&&w?"-"+v:v}function $(a,b){for(var u,c,w=1,f=new p(a[0]);w<a.length;w++)c=new p(a[w]),(!c.s||(u=At(f,c))===b||u===0&&f.s===b)&&(f=c);return f}function H(a,b,u){for(var c=1,w=b.length;!b[--w];b.pop());for(w=b[0];w>=10;w/=10,c++);return(u=c+u*pe-1)>x?a.c=a.e=null:u<N?a.c=[a.e=0]:(a.e=u,a.c=b),a}n=(function(){var a=/^(-?)0([xbo])(?=\w[\w.]*$)/i,b=/^([^.]+)\.$/,u=/^\.([^.]+)$/,c=/^-?(Infinity|NaN)$/,w=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(f,C,h,v){var P,_=h?C:C.replace(w,"");if(c.test(_))f.s=isNaN(_)?null:_<0?-1:1;else{if(!h&&(_=_.replace(a,function(M,m,j){return P=(j=j.toLowerCase())=="x"?16:j=="b"?2:8,!v||v==P?m:M}),v&&(P=v,_=_.replace(b,"$1").replace(u,"0.$1")),C!=_))return new p(_,P);if(p.DEBUG)throw Error(qe+"Not a"+(v?" base "+v:"")+" number: "+C);f.s=null}f.c=f.e=null}})();function Y(a,b,u,c){var w,f,C,h,v,P,_,M=a.c,m=Fn;if(M){e:{for(w=1,h=M[0];h>=10;h/=10,w++);if(f=b-w,f<0)f+=pe,C=b,v=M[P=0],_=ze(v/m[w-C-1]%10);else if(P=jn((f+1)/pe),P>=M.length)if(c){for(;M.length<=P;M.push(0));v=_=0,w=1,f%=pe,C=f-pe+1}else break e;else{for(v=h=M[P],w=1;h>=10;h/=10,w++);f%=pe,C=f-pe+w,_=C<0?0:ze(v/m[w-C-1]%10)}if(c=c||b<0||M[P+1]!=null||(C<0?v:v%m[w-C-1]),c=u<4?(_||c)&&(u==0||u==(a.s<0?3:2)):_>5||_==5&&(u==4||c||u==6&&(f>0?C>0?v/m[w-C]:0:M[P-1])%10&1||u==(a.s<0?8:7)),b<1||!M[0])return M.length=0,c?(b-=a.e+1,M[0]=m[(pe-b%pe)%pe],a.e=-b||0):M[0]=a.e=0,a;if(f==0?(M.length=P,h=1,P--):(M.length=P+1,h=m[pe-f],M[P]=C>0?ze(v/m[w-C]%m[C])*h:0),c)for(;;)if(P==0){for(f=1,C=M[0];C>=10;C/=10,f++);for(C=M[0]+=h,h=1;C>=10;C/=10,h++);f!=h&&(a.e++,M[0]==Xe&&(M[0]=1));break}else{if(M[P]+=h,M[P]!=Xe)break;M[P--]=0,h=1}for(f=M.length;M[--f]===0;M.pop());}a.e>x?a.c=a.e=null:a.e<N&&(a.c=[a.e=0])}return a}function X(a){var b,u=a.e;return u===null?a.toString():(b=He(a.c),b=u<=d||u>=g?Tr(b,u):lt(b,u,"0"),a.s<0?"-"+b:b)}return i.absoluteValue=i.abs=function(){var a=new p(this);return a.s<0&&(a.s=1),a},i.comparedTo=function(a,b){return At(this,new p(a,b))},i.decimalPlaces=i.dp=function(a,b){var u,c,w,f=this;if(a!=null)return Re(a,0,Ne),b==null?b=l:Re(b,0,8),Y(new p(f),a+f.e+1,b);if(!(u=f.c))return null;if(c=((w=u.length-1)-Ge(this.e/pe))*pe,w=u[w])for(;w%10==0;w/=10,c--);return c<0&&(c=0),c},i.dividedBy=i.div=function(a,b){return e(this,new p(a,b),o,l)},i.dividedToIntegerBy=i.idiv=function(a,b){return e(this,new p(a,b),0,1)},i.exponentiatedBy=i.pow=function(a,b){var u,c,w,f,C,h,v,P,_,M=this;if(a=new p(a),a.c&&!a.isInteger())throw Error(qe+"Exponent not an integer: "+X(a));if(b!=null&&(b=new p(b)),h=a.e>14,!M.c||!M.c[0]||M.c[0]==1&&!M.e&&M.c.length==1||!a.c||!a.c[0])return _=new p(Math.pow(+X(M),h?a.s*(2-Ir(a)):+X(a))),b?_.mod(b):_;if(v=a.s<0,b){if(b.c?!b.c[0]:!b.s)return new p(NaN);c=!v&&M.isInteger()&&b.isInteger(),c&&(M=M.mod(b))}else{if(a.e>9&&(M.e>0||M.e<-1||(M.e==0?M.c[0]>1||h&&M.c[1]>=24e7:M.c[0]<8e13||h&&M.c[0]<=9999975e7)))return f=M.s<0&&Ir(a)?-0:0,M.e>-1&&(f=1/f),new p(v?1/f:f);U&&(f=jn(U/pe+2))}for(h?(u=new p(.5),v&&(a.s=1),P=Ir(a)):(w=Math.abs(+X(a)),P=w%2),_=new p(s);;){if(P){if(_=_.times(M),!_.c)break;f?_.c.length>f&&(_.c.length=f):c&&(_=_.mod(b))}if(w){if(w=ze(w/2),w===0)break;P=w%2}else if(a=a.times(u),Y(a,a.e+1,1),a.e>14)P=Ir(a);else{if(w=+X(a),w===0)break;P=w%2}M=M.times(M),f?M.c&&M.c.length>f&&(M.c.length=f):c&&(M=M.mod(b))}return c?_:(v&&(_=s.div(_)),b?_.mod(b):f?Y(_,U,l,C):_)},i.integerValue=function(a){var b=new p(this);return a==null?a=l:Re(a,0,8),Y(b,b.e+1,a)},i.isEqualTo=i.eq=function(a,b){return At(this,new p(a,b))===0},i.isFinite=function(){return!!this.c},i.isGreaterThan=i.gt=function(a,b){return At(this,new p(a,b))>0},i.isGreaterThanOrEqualTo=i.gte=function(a,b){return(b=At(this,new p(a,b)))===1||b===0},i.isInteger=function(){return!!this.c&&Ge(this.e/pe)>this.c.length-2},i.isLessThan=i.lt=function(a,b){return At(this,new p(a,b))<0},i.isLessThanOrEqualTo=i.lte=function(a,b){return(b=At(this,new p(a,b)))===-1||b===0},i.isNaN=function(){return!this.s},i.isNegative=function(){return this.s<0},i.isPositive=function(){return this.s>0},i.isZero=function(){return!!this.c&&this.c[0]==0},i.minus=function(a,b){var u,c,w,f,C=this,h=C.s;if(a=new p(a,b),b=a.s,!h||!b)return new p(NaN);if(h!=b)return a.s=-b,C.plus(a);var v=C.e/pe,P=a.e/pe,_=C.c,M=a.c;if(!v||!P){if(!_||!M)return _?(a.s=-b,a):new p(M?C:NaN);if(!_[0]||!M[0])return M[0]?(a.s=-b,a):new p(_[0]?C:l==3?-0:0)}if(v=Ge(v),P=Ge(P),_=_.slice(),h=v-P){for((f=h<0)?(h=-h,w=_):(P=v,w=M),w.reverse(),b=h;b--;w.push(0));w.reverse()}else for(c=(f=(h=_.length)<(b=M.length))?h:b,h=b=0;b<c;b++)if(_[b]!=M[b]){f=_[b]<M[b];break}if(f&&(w=_,_=M,M=w,a.s=-a.s),b=(c=M.length)-(u=_.length),b>0)for(;b--;_[u++]=0);for(b=Xe-1;c>h;){if(_[--c]<M[c]){for(u=c;u&&!_[--u];_[u]=b);--_[u],_[c]+=Xe}_[c]-=M[c]}for(;_[0]==0;_.splice(0,1),--P);return _[0]?H(a,_,P):(a.s=l==3?-1:1,a.c=[a.e=0],a)},i.modulo=i.mod=function(a,b){var u,c,w=this;return a=new p(a,b),!w.c||!a.s||a.c&&!a.c[0]?new p(NaN):!a.c||w.c&&!w.c[0]?new p(w):(k==9?(c=a.s,a.s=1,u=e(w,a,0,3),a.s=c,u.s*=c):u=e(w,a,0,k),a=w.minus(u.times(a)),!a.c[0]&&k==1&&(a.s=w.s),a)},i.multipliedBy=i.times=function(a,b){var u,c,w,f,C,h,v,P,_,M,m,j,K,W,ee,Q=this,le=Q.c,ue=(a=new p(a,b)).c;if(!le||!ue||!le[0]||!ue[0])return!Q.s||!a.s||le&&!le[0]&&!ue||ue&&!ue[0]&&!le?a.c=a.e=a.s=null:(a.s*=Q.s,!le||!ue?a.c=a.e=null:(a.c=[0],a.e=0)),a;for(c=Ge(Q.e/pe)+Ge(a.e/pe),a.s*=Q.s,v=le.length,M=ue.length,v<M&&(K=le,le=ue,ue=K,w=v,v=M,M=w),w=v+M,K=[];w--;K.push(0));for(W=Xe,ee=bt,w=M;--w>=0;){for(u=0,m=ue[w]%ee,j=ue[w]/ee|0,C=v,f=w+C;f>w;)P=le[--C]%ee,_=le[C]/ee|0,h=j*P+_*m,P=m*P+h%ee*ee+K[f]+u,u=(P/W|0)+(h/ee|0)+j*_,K[f--]=P%W;K[f]=u}return u?++c:K.splice(0,1),H(a,K,c)},i.negated=function(){var a=new p(this);return a.s=-a.s||null,a},i.plus=function(a,b){var u,c=this,w=c.s;if(a=new p(a,b),b=a.s,!w||!b)return new p(NaN);if(w!=b)return a.s=-b,c.minus(a);var f=c.e/pe,C=a.e/pe,h=c.c,v=a.c;if(!f||!C){if(!h||!v)return new p(w/0);if(!h[0]||!v[0])return v[0]?a:new p(h[0]?c:w*0)}if(f=Ge(f),C=Ge(C),h=h.slice(),w=f-C){for(w>0?(C=f,u=v):(w=-w,u=h),u.reverse();w--;u.push(0));u.reverse()}for(w=h.length,b=v.length,w-b<0&&(u=v,v=h,h=u,b=w),w=0;b;)w=(h[--b]=h[b]+v[b]+w)/Xe|0,h[b]=Xe===h[b]?0:h[b]%Xe;return w&&(h=[w].concat(h),++C),H(a,h,C)},i.precision=i.sd=function(a,b){var u,c,w,f=this;if(a!=null&&a!==!!a)return Re(a,1,Ne),b==null?b=l:Re(b,0,8),Y(new p(f),a,b);if(!(u=f.c))return null;if(w=u.length-1,c=w*pe+1,w=u[w]){for(;w%10==0;w/=10,c--);for(w=u[0];w>=10;w/=10,c++);}return a&&f.e+1>c&&(c=f.e+1),c},i.shiftedBy=function(a){return Re(a,-Wn,Wn),this.times("1e"+a)},i.squareRoot=i.sqrt=function(){var a,b,u,c,w,f=this,C=f.c,h=f.s,v=f.e,P=o+4,_=new p("0.5");if(h!==1||!C||!C[0])return new p(!h||h<0&&(!C||C[0])?NaN:C?f:1/0);if(h=Math.sqrt(+X(f)),h==0||h==1/0?(b=He(C),(b.length+v)%2==0&&(b+="0"),h=Math.sqrt(+b),v=Ge((v+1)/2)-(v<0||v%2),h==1/0?b="5e"+v:(b=h.toExponential(),b=b.slice(0,b.indexOf("e")+1)+v),u=new p(b)):u=new p(h+""),u.c[0]){for(v=u.e,h=v+P,h<3&&(h=0);;)if(w=u,u=_.times(w.plus(e(f,w,P,1))),He(w.c).slice(0,h)===(b=He(u.c)).slice(0,h))if(u.e<v&&--h,b=b.slice(h-3,h+1),b=="9999"||!c&&b=="4999"){if(!c&&(Y(w,w.e+o+2,0),w.times(w).eq(f))){u=w;break}P+=4,h+=4,c=1}else{(!+b||!+b.slice(1)&&b.charAt(0)=="5")&&(Y(u,u.e+o+2,1),a=!u.times(u).eq(f));break}}return Y(u,u.e+o+1,l,a)},i.toExponential=function(a,b){return a!=null&&(Re(a,0,Ne),a++),T(this,a,b,1)},i.toFixed=function(a,b){return a!=null&&(Re(a,0,Ne),a=a+this.e+1),T(this,a,b)},i.toFormat=function(a,b,u){var c,w=this;if(u==null)a!=null&&b&&typeof b=="object"?(u=b,b=null):a&&typeof a=="object"?(u=a,a=b=null):u=A;else if(typeof u!="object")throw Error(qe+"Argument not an object: "+u);if(c=w.toFixed(a,b),w.c){var f,C=c.split("."),h=+u.groupSize,v=+u.secondaryGroupSize,P=u.groupSeparator||"",_=C[0],M=C[1],m=w.s<0,j=m?_.slice(1):_,K=j.length;if(v&&(f=h,h=v,v=f,K-=f),h>0&&K>0){for(f=K%h||h,_=j.substr(0,f);f<K;f+=h)_+=P+j.substr(f,h);v>0&&(_+=P+j.slice(f)),m&&(_="-"+_)}c=M?_+(u.decimalSeparator||"")+((v=+u.fractionGroupSize)?M.replace(new RegExp("\\d{"+v+"}\\B","g"),"$&"+(u.fractionGroupSeparator||"")):M):_}return(u.prefix||"")+c+(u.suffix||"")},i.toFraction=function(a){var b,u,c,w,f,C,h,v,P,_,M,m,j=this,K=j.c;if(a!=null&&(h=new p(a),!h.isInteger()&&(h.c||h.s!==1)||h.lt(s)))throw Error(qe+"Argument "+(h.isInteger()?"out of range: ":"not an integer: ")+X(h));if(!K)return new p(j);for(b=new p(s),P=u=new p(s),c=v=new p(s),m=He(K),f=b.e=m.length-j.e-1,b.c[0]=Fn[(C=f%pe)<0?pe+C:C],a=!a||h.comparedTo(b)>0?f>0?b:P:h,C=x,x=1/0,h=new p(m),v.c[0]=0;_=e(h,b,0,1),w=u.plus(_.times(c)),w.comparedTo(a)!=1;)u=c,c=w,P=v.plus(_.times(w=P)),v=w,b=h.minus(_.times(w=b)),h=w;return w=e(a.minus(u),c,0,1),v=v.plus(w.times(P)),u=u.plus(w.times(c)),v.s=P.s=j.s,f=f*2,M=e(P,c,f,l).minus(j).abs().comparedTo(e(v,u,f,l).minus(j).abs())<1?[P,c]:[v,u],x=C,M},i.toNumber=function(){return+X(this)},i.toPrecision=function(a,b){return a!=null&&Re(a,1,Ne),T(this,a,b,2)},i.toString=function(a){var b,u=this,c=u.s,w=u.e;return w===null?c?(b="Infinity",c<0&&(b="-"+b)):b="NaN":(a==null?b=w<=d||w>=g?Tr(He(u.c),w):lt(He(u.c),w,"0"):a===10&&R?(u=Y(new p(u),o+w+1,l),b=lt(He(u.c),u.e,"0")):(Re(a,2,y.length,"Base"),b=t(lt(He(u.c),w,"0"),10,a,c,!0)),c<0&&u.c[0]&&(b="-"+b)),b},i.valueOf=i.toJSON=function(){return X(this)},i._isBigNumber=!0,i[Symbol.toStringTag]="BigNumber",i[Symbol.for("nodejs.util.inspect.custom")]=i.valueOf,r!=null&&p.set(r),p}function Ge(r){var e=r|0;return r>0||r===e?e:e-1}function He(r){for(var e,t,n=1,i=r.length,s=r[0]+"";n<i;){for(e=r[n++]+"",t=pe-e.length;t--;e="0"+e);s+=e}for(i=s.length;s.charCodeAt(--i)===48;);return s.slice(0,i+1||1)}function At(r,e){var t,n,i=r.c,s=e.c,o=r.s,l=e.s,d=r.e,g=e.e;if(!o||!l)return null;if(t=i&&!i[0],n=s&&!s[0],t||n)return t?n?0:-l:o;if(o!=l)return o;if(t=o<0,n=d==g,!i||!s)return n?0:!i^t?1:-1;if(!n)return d>g^t?1:-1;for(l=(d=i.length)<(g=s.length)?d:g,o=0;o<l;o++)if(i[o]!=s[o])return i[o]>s[o]^t?1:-1;return d==g?0:d>g^t?1:-1}function Re(r,e,t,n){if(r<e||r>t||r!==ze(r))throw Error(qe+(n||"Argument")+(typeof r=="number"?r<e||r>t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(r))}function Ir(r){var e=r.c.length-1;return Ge(r.e/pe)==e&&r.c[e]%2!=0}function Tr(r,e){return(r.length>1?r.charAt(0)+"."+r.slice(1):r)+(e<0?"e":"e+")+e}function lt(r,e,t){var n,i;if(e<0){for(i=t+".";++e;i+=t);r=i+r}else if(n=r.length,++e>n){for(i=t,e-=n;--e;i+=t);r+=i}else e<n&&(r=r.slice(0,e)+"."+r.slice(e));return r}ds();class Cl extends Error{}Cl.prototype.name="InvalidTokenError";const Or={IFRAME_STATUS:"iframe_status",CLOSE_WINDOW:"close_window",USER_LOGGED_IN:"user_logged_in",USER_LOGGED_OUT:"user_logged_out"},ct={LOGOUT:"logout",WALLET_INSTANCE_ID:"wallet_instance_id",USER_INFO:"user_info",SET_PROVIDER:"set_provider",TOPUP:"topup",IFRAME_STATUS:"iframe_status",CLOSED_WINDOW:"closed_window",WINDOW_BLOCKED:"window_blocked",GET_PROVIDER_STATE:"get_provider_state",LOGIN_WITH_PRIVATE_KEY:"login_with_private_key",SHOW_WALLET_CONNECT:"show_wallet_connect",SHOW_CHECKOUT:"show_checkout",SHOW_WALLET_UI:"show_wallet_ui",LOGIN_WITH_SESSION_ID:"login_with_session_id"},Pl={GET_PROVIDER_STATE:"wallet_get_provider_state"},$n={ACCOUNTS_CHANGED:"wallet_accounts_changed",CHAIN_CHANGED:"wallet_chain_changed",UNLOCK_STATE_CHANGED:"wallet_unlock_state_changed"};function Ll(r){return function(t,n,i){i(s=>{n.error&&Lr.warn(`Error in RPC response:
`,n),!t.isTorusInternal&&(Lr.info(`RPC (${r.origin}):`,t,"->",n),s())})}}var Hn={},Rt={},Uo;function di(){if(Uo)return Rt;Uo=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.EthereumProviderError=Rt.EthereumRpcError=void 0;const r=Xo();class e extends Error{constructor(o,l,d){if(!Number.isInteger(o))throw new Error('"code" must be an integer.');if(!l||typeof l!="string")throw new Error('"message" must be a nonempty string.');super(l),this.code=o,d!==void 0&&(this.data=d)}serialize(){const o={code:this.code,message:this.message};return this.data!==void 0&&(o.data=this.data),this.stack&&(o.stack=this.stack),o}toString(){return r.default(this.serialize(),i,2)}}Rt.EthereumRpcError=e;class t extends e{constructor(o,l,d){if(!n(o))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(o,l,d)}}Rt.EthereumProviderError=t;function n(s){return Number.isInteger(s)&&s>=1e3&&s<=4999}function i(s,o){if(o!=="[Circular]")return o}return Rt}var zn={},It={},qo;function hi(){return qo||(qo=1,Object.defineProperty(It,"__esModule",{value:!0}),It.errorValues=It.errorCodes=void 0,It.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}},It.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}}),It}var jo;function hs(){return jo||(jo=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.serializeError=r.isValidCode=r.getMessageFromCode=r.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const e=hi(),t=di(),n=e.errorCodes.rpc.internal,i="Unspecified error message. This is a bug, please report it.",s={code:n,message:o(n)};r.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.";function o(E,k=i){if(Number.isInteger(E)){const U=E.toString();if(x(e.errorValues,U))return e.errorValues[U].message;if(g(E))return r.JSON_RPC_SERVER_ERROR_MESSAGE}return k}r.getMessageFromCode=o;function l(E){if(!Number.isInteger(E))return!1;const k=E.toString();return!!(e.errorValues[k]||g(E))}r.isValidCode=l;function d(E,{fallbackError:k=s,shouldIncludeStack:U=!1}={}){var A,y;if(!k||!Number.isInteger(k.code)||typeof k.message!="string")throw new Error("Must provide fallback error with integer number code and string message.");if(E instanceof t.EthereumRpcError)return E.serialize();const R={};if(E&&typeof E=="object"&&!Array.isArray(E)&&x(E,"code")&&l(E.code)){const T=E;R.code=T.code,T.message&&typeof T.message=="string"?(R.message=T.message,x(T,"data")&&(R.data=T.data)):(R.message=o(R.code),R.data={originalError:N(E)})}else{R.code=k.code;const T=(A=E)===null||A===void 0?void 0:A.message;R.message=T&&typeof T=="string"?T:k.message,R.data={originalError:N(E)}}const p=(y=E)===null||y===void 0?void 0:y.stack;return U&&E&&p&&typeof p=="string"&&(R.stack=p),R}r.serializeError=d;function g(E){return E>=-32099&&E<=-32e3}function N(E){return E&&typeof E=="object"&&!Array.isArray(E)?Object.assign({},E):E}function x(E,k){return Object.prototype.hasOwnProperty.call(E,k)}})(zn)),zn}var Yt={},Wo;function Ml(){if(Wo)return Yt;Wo=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.ethErrors=void 0;const r=di(),e=hs(),t=hi();Yt.ethErrors={rpc:{parse:o=>n(t.errorCodes.rpc.parse,o),invalidRequest:o=>n(t.errorCodes.rpc.invalidRequest,o),invalidParams:o=>n(t.errorCodes.rpc.invalidParams,o),methodNotFound:o=>n(t.errorCodes.rpc.methodNotFound,o),internal:o=>n(t.errorCodes.rpc.internal,o),server:o=>{if(!o||typeof o!="object"||Array.isArray(o))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:l}=o;if(!Number.isInteger(l)||l>-32005||l<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return n(l,o)},invalidInput:o=>n(t.errorCodes.rpc.invalidInput,o),resourceNotFound:o=>n(t.errorCodes.rpc.resourceNotFound,o),resourceUnavailable:o=>n(t.errorCodes.rpc.resourceUnavailable,o),transactionRejected:o=>n(t.errorCodes.rpc.transactionRejected,o),methodNotSupported:o=>n(t.errorCodes.rpc.methodNotSupported,o),limitExceeded:o=>n(t.errorCodes.rpc.limitExceeded,o)},provider:{userRejectedRequest:o=>i(t.errorCodes.provider.userRejectedRequest,o),unauthorized:o=>i(t.errorCodes.provider.unauthorized,o),unsupportedMethod:o=>i(t.errorCodes.provider.unsupportedMethod,o),disconnected:o=>i(t.errorCodes.provider.disconnected,o),chainDisconnected:o=>i(t.errorCodes.provider.chainDisconnected,o),custom:o=>{if(!o||typeof o!="object"||Array.isArray(o))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:l,message:d,data:g}=o;if(!d||typeof d!="string")throw new Error('"message" must be a nonempty string');return new r.EthereumProviderError(l,d,g)}}};function n(o,l){const[d,g]=s(l);return new r.EthereumRpcError(o,d||e.getMessageFromCode(o),g)}function i(o,l){const[d,g]=s(l);return new r.EthereumProviderError(o,d||e.getMessageFromCode(o),g)}function s(o){if(o){if(typeof o=="string")return[o];if(typeof o=="object"&&!Array.isArray(o)){const{message:l,data:d}=o;if(l&&typeof l!="string")throw new Error("Must specify string message.");return[l||void 0,d]}}return[]}return Yt}var Fo;function Dl(){return Fo||(Fo=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getMessageFromCode=r.serializeError=r.EthereumProviderError=r.EthereumRpcError=r.ethErrors=r.errorCodes=void 0;const e=di();Object.defineProperty(r,"EthereumRpcError",{enumerable:!0,get:function(){return e.EthereumRpcError}}),Object.defineProperty(r,"EthereumProviderError",{enumerable:!0,get:function(){return e.EthereumProviderError}});const t=hs();Object.defineProperty(r,"serializeError",{enumerable:!0,get:function(){return t.serializeError}}),Object.defineProperty(r,"getMessageFromCode",{enumerable:!0,get:function(){return t.getMessageFromCode}});const n=Ml();Object.defineProperty(r,"ethErrors",{enumerable:!0,get:function(){return n.ethErrors}});const i=hi();Object.defineProperty(r,"errorCodes",{enumerable:!0,get:function(){return i.errorCodes}})})(Hn)),Hn}var _t=Dl(),Gn,$o;function Bl(){return $o||($o=1,Gn=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,i,s;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(!r(e[i],t[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[i]))return!1;for(i=n;i--!==0;){var o=s[i];if(!r(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}),Gn}var kl=Bl();const Ul=Ut(kl);var ql="2.1.0";function gs(r){return r!==null&&typeof r=="object"&&typeof r.pipe=="function"}function jl(r){return gs(r)&&r.writable!==!1&&typeof r._write=="function"&&typeof r._writableState=="object"}function Wl(r){return gs(r)&&r.readable!==!1&&typeof r._read=="function"&&typeof r._readableState=="object"}function Fl(r){return jl(r)&&Wl(r)}var nt={errors:{disconnected:()=>"Torus: Lost connection to Torus.",permanentlyDisconnected:()=>"Torus: Disconnected from iframe. Page reload required.",unsupportedSync:r=>`Torus: The Torus Ethereum provider does not support synchronous methods like ${r} without a callback parameter.`,invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:r=>`Invalid options. Received: { maxEventListeners: ${r}}`,invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:r=>`'args.logger' must include required method '${r}'.`},info:{connected:r=>`Torus: Connected to chain with ID "${r}".`}};const du={MOONPAY:"moonpay",WYRE:"wyre",RAMPNETWORK:"rampnetwork",XANPOOL:"xanpool",MERCURYO:"mercuryo",TRANSAK:"transak"},$l={PRODUCTION:"production",DEVELOPMENT:"development",TESTING:"testing"},Zt={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"},Vn={GOOGLE:"google",FACEBOOK:"facebook",REDDIT:"reddit",DISCORD:"discord",TWITCH:"twitch",APPLE:"apple",LINE:"line",GITHUB:"github",KAKAO:"kakao",LINKEDIN:"linkedin",TWITTER:"twitter",WEIBO:"weibo",WECHAT:"wechat",EMAIL_PASSWORDLESS:"email_passwordless"},Hl={en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies bentigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"",actionRequired:"",pendingAction:"",cookiesRequired:"",enableCookies:"TorusCookie",clickHere:""}},ko:{embed:{continue:"",actionRequired:" ",pendingAction:"    .",cookiesRequired:" ",enableCookies:"     Torus .",clickHere:"  "}},zh:{embed:{continue:"",actionRequired:"",pendingAction:"",cookiesRequired:"Cookie",enableCookies:"cookieTorus",clickHere:""}}};var gi={supportedVerifierList:[Vn.GOOGLE,Vn.REDDIT,Vn.DISCORD],translations:Hl,localStorageKeyPrefix:"torus-"},Ee=Lr.getLogger("solana-embed");function zl(){return(r,e,t)=>{(typeof r.method!="string"||!r.method)&&(e.error=_t.ethErrors.rpc.invalidRequest({message:"The request 'method' must be a non-empty string.",data:r})),t(n=>{const{error:i}=e;return i&&Ee.error(`Torus - RPC Error: ${i.message}`,i),n()})}}function Gl(r,e,t){let n=`Torus: Lost connection to "${r}".`;e?.stack&&(n+=`
${e.stack}`),Ee.warn(n),t&&t.listenerCount("error")>0&&t.emit("error",n)}const xr=()=>Math.random().toString(36).slice(2),ps=async r=>{let e,t;switch(r){case"testing":e="https://solana-testing.tor.us",t="debug";break;case"development":e="http://localhost:8080",t="debug";break;default:e="https://solana.tor.us",t="error";break}return{torusUrl:e,logLevel:t}},Vl=()=>{let r=window.navigator.language||"en-US";const e=r.split("-");return r=Object.prototype.hasOwnProperty.call(gi.translations,e[0])?e[0]:"en",r},Kl={height:660,width:375},Yl={height:740,width:1315},Jl={height:700,width:1200},ws={height:600,width:400};function Zl(r){let e;try{e=window[r];const t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){const n=t;return n&&(n.code===22||n.code===1014||n.name==="QuotaExceededError"||n.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&e.length!==0}}function Xt(r){let{width:e,height:t}=r;const n=window.screenLeft!==void 0?window.screenLeft:window.screenX,i=window.screenTop!==void 0?window.screenTop:window.screenY,s=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,l=1,d=Math.abs((s-e)/2/l+n),g=Math.abs((o-t)/2/l+i);return`titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${t/l},width=${e/l},top=${g},left=${d}`}class bs extends jr{constructor(e,t){let{maxEventListeners:n=100,jsonRpcStreamName:i="provider"}=t;if(super(),ge(this,"isTorus",void 0),ge(this,"_rpcEngine",void 0),ge(this,"jsonRpcConnectionEvents",void 0),ge(this,"_state",void 0),!Fl(e))throw new Error(nt.errors.invalidDuplexStream());this.isTorus=!0,this.setMaxListeners(n),this._handleConnect=this._handleConnect.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this._initializeState=this._initializeState.bind(this),this.request=this.request.bind(this),this.sendAsync=this.sendAsync.bind(this);const s=new Ia;so(e,s,e,this._handleStreamDisconnect.bind(this,"Torus")),s.ignoreStream("phishing");const o=Sa();so(o.stream,s.createStream(i),o.stream,this._handleStreamDisconnect.bind(this,"Torus RpcProvider"));const l=new ut;l.push(Aa()),l.push(zl()),l.push(Ll({origin:location.origin})),l.push(o.middleware),this._rpcEngine=l,this.jsonRpcConnectionEvents=o.events}async request(e){if(!e||typeof e!="object"||Array.isArray(e))throw _t.ethErrors.rpc.invalidRequest({message:nt.errors.invalidRequestArgs(),data:e});const{method:t,params:n}=e;if(typeof t!="string"||t.length===0)throw _t.ethErrors.rpc.invalidRequest({message:nt.errors.invalidRequestMethod(),data:e});if(n!==void 0&&!Array.isArray(n)&&(typeof n!="object"||n===null))throw _t.ethErrors.rpc.invalidRequest({message:nt.errors.invalidRequestParams(),data:e});return new Promise((i,s)=>{this._rpcRequest({method:t,params:n},Yn(i,s))})}send(e,t){this._rpcRequest(e,t)}sendAsync(e){return new Promise((t,n)=>{this._rpcRequest(e,Yn(t,n))})}_handleStreamDisconnect(e,t){Gl(e,t,this),this._handleDisconnect(!1,t?t.message:void 0)}}const Dt=r=>{const e=window.document.createElement("template"),t=r.trim();return e.innerHTML=t,e.content.firstChild};function Nr(r){return r.version===void 0}class ys extends jr{constructor(e){let{url:t,target:n,features:i,timeout:s=3e4}=e;super(),ge(this,"url",void 0),ge(this,"target",void 0),ge(this,"features",void 0),ge(this,"window",void 0),ge(this,"windowTimer",void 0),ge(this,"iClosedWindow",void 0),ge(this,"timeout",void 0),this.url=t,this.target=n||"_blank",this.features=i||Xt(Jl),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this.timeout=s,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),setTimeout(()=>{this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0},this.timeout)),this.window===void 0&&clearInterval(this.windowTimer)},500))}open(){return this.window=window.open(this.url.href,this.target,this.features),this.window?.focus&&this.window.focus(),Promise.resolve()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(e){e?window.location.replace(this.url.href):window.location.href=this.url.href}}class $r extends bs{constructor(e,t){let{maxEventListeners:n=100,jsonRpcStreamName:i="provider"}=t;super(e,{maxEventListeners:n,jsonRpcStreamName:i}),ge(this,"embedTranslations",void 0),ge(this,"torusUrl",void 0),ge(this,"dappStorageKey",void 0),ge(this,"windowRefs",void 0),ge(this,"tryWindowHandle",void 0),ge(this,"torusAlertContainer",void 0),ge(this,"torusIframe",void 0),this._state=Ke({},$r._defaultState),this.torusUrl="",this.dappStorageKey="";const s=gi.translations[Vl()];this.embedTranslations=s.embed,this.windowRefs={},this.on("connect",()=>{this._state.isConnected=!0});const o=l=>{const{method:d,params:g}=l;if(d===Or.IFRAME_STATUS){const{isFullScreen:N,rid:x}=g;this._displayIframe({isFull:N,rid:x})}else if(d==="create_window"){const{windowId:N,url:x}=g;this._createPopupBlockAlert(N,x)}else if(d===Or.CLOSE_WINDOW)this._handleCloseWindow(g);else if(d===Or.USER_LOGGED_IN){const{currentLoginProvider:N}=g;this._state.isLoggedIn=!0,this._state.currentLoginProvider=N}else d===Or.USER_LOGGED_OUT&&(this._state.isLoggedIn=!1,this._state.currentLoginProvider=null,this._displayIframe())};this.jsonRpcConnectionEvents.on("notification",o)}get isLoggedIn(){return this._state.isLoggedIn}get isIFrameFullScreen(){return this._state.isIFrameFullScreen}isConnected(){return this._state.isConnected}async _initializeState(e){try{const{torusUrl:t,dappStorageKey:n,torusAlertContainer:i,torusIframe:s}=e;this.torusUrl=t,this.dappStorageKey=n,this.torusAlertContainer=i,this.torusIframe=s,this.torusIframe.addEventListener("load",()=>{this._state.isIFrameFullScreen||this._displayIframe()});const{currentLoginProvider:o,isLoggedIn:l}=await this.request({method:ct.GET_PROVIDER_STATE,params:[]});this._handleConnect(o,l)}catch(t){Ee.error("Torus: Failed to get initial state. Please report this bug.",t)}finally{Ee.info("initialized communication state"),this._state.initialized=!0,this.emit("_initialized")}}_handleWindow(e){let{url:t,target:n,features:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=new URL(t||`${this.torusUrl}/redirect?windowId=${e}`);this.dappStorageKey&&(s.hash?s.hash+=`&dappStorageKey=${this.dappStorageKey}`:s.hash=`#dappStorageKey=${this.dappStorageKey}`);const o=new ys({url:s,target:n,features:i});if(o.open(),!o.window){this._createPopupBlockAlert(e,s.href);return}this.windowRefs[e]=o,this.request({method:"opened_window",params:{windowId:e}}),o.once("close",()=>{delete this.windowRefs[e],this.request({method:ct.CLOSED_WINDOW,params:{windowId:e}})})}_displayIframe(){let{isFull:e=!1,rid:t=""}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={};if(e)n.display="block",n.width="100%",n.height="100%",n.top="0px",n.right="0px",n.left="0px",n.bottom="0px";else switch(n.display=this._state.torusWidgetVisibility?"block":"none",n.height="70px",n.width="70px",this._state.buttonPosition){case Zt.TOP_LEFT:n.top="0px",n.left="0px",n.right="auto",n.bottom="auto";break;case Zt.TOP_RIGHT:n.top="0px",n.right="0px",n.left="auto",n.bottom="auto";break;case Zt.BOTTOM_RIGHT:n.bottom="0px",n.right="0px",n.top="auto",n.left="auto";break;case Zt.BOTTOM_LEFT:default:n.bottom="0px",n.left="0px",n.top="auto",n.right="auto";break}Object.assign(this.torusIframe.style,n),this._state.isIFrameFullScreen=e,this.request({method:ct.IFRAME_STATUS,params:{isIFrameFullScreen:e,rid:t}})}hideTorusButton(){this._state.torusWidgetVisibility=!1,this._displayIframe()}showTorusButton(){this._state.torusWidgetVisibility=!0,this._displayIframe()}_rpcRequest(e,t){const n=t,i=e;Array.isArray(i)||i.jsonrpc||(i.jsonrpc="2.0"),this.tryWindowHandle(i,n)}_handleConnect(e,t){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{currentLoginProvider:e,isLoggedIn:t}),Ee.debug(nt.info.connected(e)))}_handleDisconnect(e,t){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e){this._state.isConnected=!1;let n;e?(n=new _t.EthereumRpcError(1013,t||nt.errors.disconnected()),Ee.debug(n)):(n=new _t.EthereumRpcError(1011,t||nt.errors.permanentlyDisconnected()),Ee.error(n),this._state.currentLoginProvider=null,this._state.isLoggedIn=!1,this._state.torusWidgetVisibility=!1,this._state.isIFrameFullScreen=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",n)}}_handleCloseWindow(e){const{windowId:t}=e;this.windowRefs[t]&&(this.windowRefs[t].close(),delete this.windowRefs[t])}async _createPopupBlockAlert(e,t){const n=this.getLogoUrl(),i=Dt(`<div id="torusAlert" class="torus-alert--v2"><div id="torusAlert__logo"><img src="${n}" /></div><div><h1 id="torusAlert__title">${this.embedTranslations.actionRequired}</h1><p id="torusAlert__desc">${this.embedTranslations.pendingAction}</p></div></div>`),s=Dt(`<div><a id="torusAlert__btn">${this.embedTranslations.continue}</a></div>`),o=Dt('<div id="torusAlert__btn-container"></div>');o.appendChild(s),i.appendChild(o);const l=()=>{s.addEventListener("click",()=>{this._handleWindow(e,{url:t,target:"_blank",features:Xt(ws)}),i.remove(),this.torusAlertContainer.children.length===0&&(this.torusAlertContainer.style.display="none")})};this.torusAlertContainer.appendChild(i),l(),this.torusAlertContainer.style.display="block"}getLogoUrl(){return`${this.torusUrl}/images/torus_icon-blue.svg`}}ge($r,"_defaultState",{buttonPosition:"bottom-left",currentLoginProvider:null,isIFrameFullScreen:!1,hasEmittedConnection:!1,torusWidgetVisibility:!1,initialized:!1,isLoggedIn:!1,isPermanentlyDisconnected:!1,isConnected:!1});class Hr extends bs{constructor(e,t){let{maxEventListeners:n=100,jsonRpcStreamName:i="provider"}=t;super(e,{maxEventListeners:n,jsonRpcStreamName:i}),ge(this,"chainId",void 0),ge(this,"selectedAddress",void 0),ge(this,"tryWindowHandle",void 0),this._state=Ke({},Hr._defaultState),this.selectedAddress=null,this.chainId=null,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this.on("connect",()=>{this._state.isConnected=!0});const s=o=>{const{method:l,params:d}=o;l===$n.ACCOUNTS_CHANGED?this._handleAccountsChanged(d):l===$n.UNLOCK_STATE_CHANGED?this._handleUnlockStateChanged(d):l===$n.CHAIN_CHANGED&&this._handleChainChanged(d)};this.jsonRpcConnectionEvents.on("notification",s)}isConnected(){return this._state.isConnected}async _initializeState(){try{const{accounts:e,chainId:t,isUnlocked:n}=await this.request({method:Pl.GET_PROVIDER_STATE,params:[]});this.emit("connect",{chainId:t}),this._handleChainChanged({chainId:t}),this._handleUnlockStateChanged({accounts:e,isUnlocked:n}),this._handleAccountsChanged(e)}catch(e){Ee.error("Torus: Failed to get initial state. Please report this bug.",e)}finally{Ee.info("initialized provider state"),this._state.initialized=!0,this.emit("_initialized")}}_rpcRequest(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=t;const s=e;if(!Array.isArray(s)){if(s.jsonrpc||(s.jsonrpc="2.0"),s.method==="solana_accounts"||s.method==="solana_requestAccounts")i=(o,l)=>{this._handleAccountsChanged(l.result||[],s.method==="solana_accounts",n),t(o,l)};else if(s.method==="wallet_getProviderState"){this._rpcEngine.handle(e,i);return}}this.tryWindowHandle(s,i)}_handleConnect(e){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:e}),Ee.debug(nt.info.connected(e)))}_handleDisconnect(e,t){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e){this._state.isConnected=!1;let n;e?(n=new _t.EthereumRpcError(1013,t||nt.errors.disconnected()),Ee.debug(n)):(n=new _t.EthereumRpcError(1011,t||nt.errors.permanentlyDisconnected()),Ee.error(n),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",n)}}_handleAccountsChanged(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=e;Array.isArray(i)||(Ee.error("Torus: Received non-array accounts parameter. Please report this bug.",i),i=[]);for(const s of e)if(typeof s!="string"){Ee.error("Torus: Received non-string account. Please report this bug.",e),i=[];break}Ul(this._state.accounts,i)||(t&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!n&&Ee.error('Torus: "solana_accounts" unexpectedly updated accounts. Please report this bug.',i),this._state.accounts=i,this.emit("accountsChanged",i)),this.selectedAddress!==i[0]&&(this.selectedAddress=i[0]||null)}_handleChainChanged(){let{chainId:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!e){Ee.error("Torus: Received invalid network parameters. Please report this bug.",{chainId:e});return}e==="loading"?this._handleDisconnect(!0):(this._handleConnect(e),e!==this.chainId&&(this.chainId=e,this._state.initialized&&this.emit("chainChanged",this.chainId)))}_handleUnlockStateChanged(){let{accounts:e,isUnlocked:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof t!="boolean"){Ee.error("Torus: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:t});return}t!==this._state.isUnlocked&&(this._state.isUnlocked=t,this._handleAccountsChanged(e||[]))}}ge(Hr,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});function Ho(r){return new Promise((e,t)=>{try{const n=document.createElement("img");n.onload=()=>e(!0),n.onerror=()=>e(!1),n.src=r}catch(n){t(n)}})}const Xl=r=>{const{document:e}=r,t=e.querySelector('head > meta[property="og:site_name"]');if(t)return t.content;const n=e.querySelector('head > meta[name="title"]');return n?n.content:e.title&&e.title.length>0?e.title:r.location.hostname};async function Ql(r){try{const{document:e}=r;let t=e.querySelector('head > link[rel="shortcut icon"]');return t&&await Ho(t.href)||(t=Array.from(e.querySelectorAll('head > link[rel="icon"]')).find(n=>!!n.href),t&&await Ho(t.href))?t.href:""}catch{return""}}const eu=async()=>({name:Xl(window),icon:await Ql(window)}),tu=["send_transaction","sign_transaction","sign_all_transactions","sign_message","connect"],ru=[ct.SET_PROVIDER],nu=Zl("localStorage");(async function(){try{if(typeof document>"u")return;const e=document.createElement("link"),{torusUrl:t}=await ps("production");e.href=`${t}/frame`,e.crossOrigin="anonymous",e.type="text/html",e.rel="prefetch",e.relList&&e.relList.supports&&e.relList.supports("prefetch")&&document.head.appendChild(e)}catch(e){Ee.warn(e)}})();class hu{constructor(){let{modalZIndex:e=99999}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ge(this,"isInitialized",void 0),ge(this,"torusAlert",void 0),ge(this,"modalZIndex",void 0),ge(this,"alertZIndex",void 0),ge(this,"requestedLoginProvider",void 0),ge(this,"provider",void 0),ge(this,"communicationProvider",void 0),ge(this,"dappStorageKey",void 0),ge(this,"isTopupHidden",!1),ge(this,"torusAlertContainer",void 0),ge(this,"torusUrl",void 0),ge(this,"torusIframe",void 0),ge(this,"styleLink",void 0),this.torusUrl="",this.isInitialized=!1,this.requestedLoginProvider=null,this.modalZIndex=e,this.alertZIndex=e+1e3,this.dappStorageKey=""}get isLoggedIn(){return this.communicationProvider?this.communicationProvider.isLoggedIn:!1}async init(){let{buildEnv:e=$l.PRODUCTION,enableLogging:t=!1,network:n,showTorusButton:i=!1,useLocalStorage:s=!1,buttonPosition:o=Zt.BOTTOM_LEFT,apiKey:l="torus-default",extraParams:d={},whiteLabel:g}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.isInitialized)throw new Error("Already initialized");const{torusUrl:N,logLevel:x}=await ps(e);Ee.enableAll(),Ee.info(N,"url loaded"),Ee.info(`Solana Embed Version :${ql}`),this.torusUrl=N,Ee.setDefaultLevel(x),t?Ee.enableAll():Ee.disableAll();const E=this.handleDappStorageKey(s),k=new URL(N);k.pathname.endsWith("/")?k.pathname+="frame":k.pathname+="/frame";const U=new URLSearchParams;return E&&U.append("dappStorageKey",E),U.append("origin",window.location.origin),k.hash=U.toString(),this.torusIframe=Dt(`<iframe
        id="torusIframe"
        class="torusIframe"
        src="${k.href}"
        style="display: none; position: fixed; top: 0; right: 0; width: 100%;
        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex.toString()}"
      ></iframe>`),this.torusAlertContainer=Dt(`<div id="torusAlertContainer" style="display:none; z-index: ${this.alertZIndex.toString()}"></div>`),this.styleLink=Dt(`<link href="${N}/css/widget.css" rel="stylesheet" type="text/css">`),new Promise((A,y)=>{try{this.torusIframe.addEventListener("load",async()=>{const R=await eu();this.torusIframe.contentWindow.postMessage({buttonPosition:o,apiKey:l,network:n,dappMetadata:R,extraParams:d,whiteLabel:g},k.origin),await this._setupWeb3({torusUrl:N}),i&&this.showTorusButton(),g?.topupHide?this.isTopupHidden=g.topupHide:this.hideTorusButton(),this.isInitialized=!0,window.torus=this,A()}),window.document.head.appendChild(this.styleLink),window.document.body.appendChild(this.torusIframe),window.document.body.appendChild(this.torusAlertContainer)}catch(R){y(R)}})}async login(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isInitialized)throw new Error("Call init() first");try{this.requestedLoginProvider=e.loginProvider||null,this.requestedLoginProvider||this.communicationProvider._displayIframe({isFull:!0});const t=await new Promise((n,i)=>{this.provider._rpcRequest({method:"solana_requestAccounts",params:[this.requestedLoginProvider,e.login_hint]},Yn(n,i))});if(Array.isArray(t)&&t.length>0)return t;throw new Error("Login failed")}catch(t){throw Ee.error("login failed",t),t}finally{this.communicationProvider.isIFrameFullScreen&&this.communicationProvider._displayIframe()}}async loginWithPrivateKey(e){if(!this.isInitialized)throw new Error("Call init() first");const{privateKey:t,userInfo:n}=e,{success:i}=await this.communicationProvider.request({method:"login_with_private_key",params:{privateKey:t,userInfo:n}});if(!i)throw new Error("Login Failed")}async logout(){if(!this.communicationProvider.isLoggedIn)throw new Error("Not logged in");await this.communicationProvider.request({method:ct.LOGOUT,params:[]}),this.requestedLoginProvider=null}async cleanUp(){this.communicationProvider.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function e(t){return t instanceof Element||t instanceof Document}e(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),e(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),e(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}hideTorusButton(){this.communicationProvider.hideTorusButton()}showTorusButton(){this.communicationProvider.showTorusButton()}async setProvider(e){await this.communicationProvider.request({method:ct.SET_PROVIDER,params:Ke({},e)})}async showWallet(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=await this.communicationProvider.request({method:ct.WALLET_INSTANCE_ID,params:[]}),i=e?`/${e}`:"",s=new URL(`${this.torusUrl}/wallet${i}`);s.searchParams.append("instanceId",n),Object.keys(t).forEach(l=>{s.searchParams.append(l,t[l])}),this.dappStorageKey&&(s.hash=`#dappStorageKey=${this.dappStorageKey}`),new ys({url:s,features:Xt(Yl)}).open()}async getUserInfo(){return await this.communicationProvider.request({method:ct.USER_INFO,params:[]})}async initiateTopup(e,t){if(!this.isInitialized)throw new Error("Torus is not initialized");const n=xr();return this.communicationProvider._handleWindow(n),await this.communicationProvider.request({method:ct.TOPUP,params:{provider:e,params:t,windowId:n}})}async getAccounts(){return await this.provider.request({method:"getAccounts",params:[]})}async sendTransaction(e){const t=Nr(e),n=t?e.serialize({requireAllSignatures:!1}).toString("hex"):et.from(e.serialize()).toString("hex");return await this.provider.request({method:"send_transaction",params:{message:n,isLegacyTransaction:t}})}async signAndSendTransaction(e,t){const n=Nr(e),i=n?e.serialize({requireAllSignatures:!1}).toString("hex"):et.from(e.serialize()).toString("hex");return{signature:await this.provider.request({method:"send_transaction",params:{message:i,options:t,isLegacyTransaction:n}})}}async signTransaction(e){const t=Nr(e),n=t?e.serializeMessage().toString("hex"):et.from(e.message.serialize()).toString("hex"),i=await this.provider.request({method:"sign_transaction",params:{message:n,messageOnly:!0,isLegacyTransaction:t}}),s=JSON.parse(i),o={publicKey:new Ri(s.publicKey),signature:et.from(s.signature,"hex")};return e.addSignature(o.publicKey,o.signature),e}async signAllTransactions(e){let t;const n=e.map(o=>(t=Nr(o),t?o.serializeMessage().toString("hex"):et.from(o.message.serialize()).toString("hex"))),s=(await this.provider.request({method:"sign_all_transactions",params:{message:n,messageOnly:!0,isLegacyTransaction:t}})).map(o=>{const l=JSON.parse(o);return{publicKey:new Ri(l.publicKey),signature:et.from(l.signature,"hex")}});return e.forEach((o,l)=>(o.addSignature(s[l].publicKey,s[l].signature),o)),e}async signMessage(e){return await this.provider.request({method:"sign_message",params:{data:e}})}async getGaslessPublicKey(){return await this.provider.request({method:"get_gasless_public_key",params:[]})}handleDappStorageKey(e){const t=`${gi.localStorageKeyPrefix}${window.location.hostname}`;let n="";if(nu&&e){const i=window.localStorage.getItem(t);if(i)n=i;else{const s=`torus-app-${xr()}`;window.localStorage.setItem(t,s),n=s}}return this.dappStorageKey=n,n}async _setupWeb3(e){Ee.info("setupWeb3 running");const t=new uo({name:"embed_torus",target:"iframe_torus",targetWindow:this.torusIframe.contentWindow}),n=new uo({name:"embed_communication",target:"iframe_communication",targetWindow:this.torusIframe.contentWindow}),i=new Hr(t,{}),s=new $r(n,{});i.tryWindowHandle=(g,N)=>{const x=g;if(!Array.isArray(x)&&tu.includes(x.method)){if(!this.communicationProvider.isLoggedIn)throw new Error("User Not Logged In");const E=xr();s._handleWindow(E,{target:"_blank",features:Xt(ws)}),x.windowId=E}i._rpcEngine.handle(x,N)},s.tryWindowHandle=(g,N)=>{const x=g;if(!Array.isArray(x)&&ru.includes(x.method)){const E=xr();s._handleWindow(E,{target:"_blank",features:Xt(Kl)}),x.params.windowId=E}s._rpcEngine.handle(x,N)};const o=g=>{const N=i[g],x=this;i[g]=function(k,U){const{method:A,params:y=[]}=k;if(A==="solana_requestAccounts"){if(!U)return x.login({loginProvider:y[0]});x.login({loginProvider:y[0]}).then(R=>U(null,R)).catch(R=>U(R))}return N.apply(this,[k,U])}};o("request"),o("sendAsync"),o("send");const l=new Proxy(i,{deleteProperty:()=>!0}),d=new Proxy(s,{deleteProperty:()=>!0});this.provider=l,this.communicationProvider=d,await Promise.all([i._initializeState(),s._initializeState(Ke(Ke({},e),{},{dappStorageKey:this.dappStorageKey,torusAlertContainer:this.torusAlertContainer,torusIframe:this.torusIframe}))]),Ee.debug("Torus - injected provider")}}export{Zt as BUTTON_POSITION,Vn as LOGIN_PROVIDER,du as PAYMENT_PROVIDER,$l as TORUS_BUILD_ENV,Hr as TorusInPageProvider,hu as default};
